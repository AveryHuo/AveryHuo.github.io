{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"themes/3-hexo/source/css/gitalk.css","path":"css/gitalk.css","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/mobile.styl","path":"css/mobile.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/style.styl","path":"css/style.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/img/alipay.jpg","path":"img/alipay.jpg","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/img/article-list-background.jpeg","path":"img/article-list-background.jpeg","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/img/avatar.jpg","path":"img/avatar.jpg","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/img/brown-papersq.png","path":"img/brown-papersq.png","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/img/school-book.png","path":"img/school-book.png","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/js/iconfont.js","path":"js/iconfont.js","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/js/jquery.autocomplete.min.js","path":"js/jquery.autocomplete.min.js","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/js/jquery.pjax.js","path":"js/jquery.pjax.js","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/js/script.js","path":"js/script.js","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/js/search.js","path":"js/search.js","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/img/weixin.jpg","path":"img/weixin.jpg","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/icomoon.eot","path":"css/fonts/icomoon.eot","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/icomoon.svg","path":"css/fonts/icomoon.svg","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/icomoon.ttf","path":"css/fonts/icomoon.ttf","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/icomoon.woff","path":"css/fonts/icomoon.woff","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/iconfont.eot","path":"css/fonts/iconfont.eot","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/iconfont.svg","path":"css/fonts/iconfont.svg","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/iconfont.ttf","path":"css/fonts/iconfont.ttf","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/iconfont.woff","path":"css/fonts/iconfont.woff","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/selection.json","path":"css/fonts/selection.json","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/atom-dark.styl","path":"css/hl_theme/atom-dark.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/atom-light.styl","path":"css/hl_theme/atom-light.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/brown-paper.styl","path":"css/hl_theme/brown-paper.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/darcula.styl","path":"css/hl_theme/darcula.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/github-gist.styl","path":"css/hl_theme/github-gist.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/github.styl","path":"css/hl_theme/github.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/gruvbox-dark.styl","path":"css/hl_theme/gruvbox-dark.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/gruvbox-light.styl","path":"css/hl_theme/gruvbox-light.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/kimbie-dark.styl","path":"css/hl_theme/kimbie-dark.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/kimbie-light.styl","path":"css/hl_theme/kimbie-light.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/railscasts.styl","path":"css/hl_theme/railscasts.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/rainbow.styl","path":"css/hl_theme/rainbow.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/school-book.styl","path":"css/hl_theme/school-book.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/sublime.styl","path":"css/hl_theme/sublime.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/sunburst.styl","path":"css/hl_theme/sunburst.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/zenbum.styl","path":"css/hl_theme/zenbum.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/js/gitment.js","path":"js/gitment.js","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/js/gitalk.js","path":"js/gitalk.js","modified":0,"renderable":1}],"Cache":[{"_id":"source/.DS_Store","hash":"4df03d7ea4128af9fa2a6fcf09400677314490b7","modified":1570810134133},{"_id":"themes/3-hexo/.DS_Store","hash":"87bbacdcde7e1a9c1332c66428fefec2d2ed90e8","modified":1570786095057},{"_id":"themes/3-hexo/.gitignore","hash":"5e85fe97e87211619c1db29fd3f3b0dbf16be4a7","modified":1570267561822},{"_id":"themes/3-hexo/README.md","hash":"d828af269e0c287e86e7754988466e6f323e3b92","modified":1570267561822},{"_id":"themes/3-hexo/_config.yml","hash":"29deda38121e8ac902b1a755c86c60ff0c6c2cc4","modified":1570788726466},{"_id":"source/_posts/.DS_Store","hash":"79a1e08dc2b8fee85b9f473276e0016e19703c67","modified":1570789827527},{"_id":"source/_posts/Python Core Programming Note 1.md","hash":"b4228aa577596d653c8eeb57fff4ee55f4ee66d4","modified":1570789557893},{"_id":"source/_posts/Python Core Programming Note 2.md","hash":"be53d73d3df8044cfc3dcf542a85b8f56da96dab","modified":1570788622421},{"_id":"source/_posts/Python_3.md","hash":"8138c22d8c00b890160862c7e4bc2121c1e26bc4","modified":1570789557893},{"_id":"source/_posts/Twisted  介绍.md","hash":"71151618c51d3db878417091872e154737d71963","modified":1570789844026},{"_id":"source/_posts/hello-world.md","hash":"8a02477044e2b77f1b262da2c48c01429e4a32e4","modified":1570266975524},{"_id":"source/_posts/python_1.md","hash":"12001a52de8859f3eab74a5c7179b3dd4c900eab","modified":1570789557894},{"_id":"source/_posts/python_2.md","hash":"6495070e4a046f60d757d49894b29362ce4a6e31","modified":1570789557894},{"_id":"source/_posts/python_4.md","hash":"16e848232984645b1cee4ebe49d6a8cd354a322d","modified":1570789557895},{"_id":"source/_posts/常用单词学习.md","hash":"844ef8226961ac68f418125d3ca6db17eb730a60","modified":1570810309976},{"_id":"source/_posts/第一个.md","hash":"5731930398ca6a1b47fe28692588b663830b7b73","modified":1570278042440},{"_id":"source/about/index.md","hash":"830f712dc85e3e35fd05dd07d191bb6888a98162","modified":1570326210039},{"_id":"themes/3-hexo/.git/HEAD","hash":"acbaef275e46a7f14c1ef456fff2c8bbe8c84724","modified":1570267561817},{"_id":"themes/3-hexo/.git/config","hash":"024eec43f4595faf3e671b7491a8685bbe82c293","modified":1570267561818},{"_id":"themes/3-hexo/.git/description","hash":"9635f1b7e12c045212819dd934d809ef07efa2f4","modified":1570267538363},{"_id":"themes/3-hexo/.git/index","hash":"9f3c4b12452cad40e9d5a9aabb65c3555ec8a593","modified":1570505430062},{"_id":"themes/3-hexo/.git/packed-refs","hash":"760ca6d48598aacddc362abc180c1e0135353b61","modified":1570267561815},{"_id":"themes/3-hexo/layout/index.ejs","hash":"56fc95610a240e8bfe3d5b611896a819c1eb5dee","modified":1570267561826},{"_id":"themes/3-hexo/layout/indexs.md","hash":"e98b27005c0fb0d7618ae3815654ac33f8c02313","modified":1570267561826},{"_id":"themes/3-hexo/layout/post.ejs","hash":"810f046277fc49f523a72d1552eab1e39d3c299c","modified":1570267561826},{"_id":"themes/3-hexo/source/.DS_Store","hash":"5dceca2f59b23268ea67ab03b32a2e863ba856a3","modified":1570323974618},{"_id":"themes/3-hexo/.git/hooks/applypatch-msg.sample","hash":"4de88eb95a5e93fd27e78b5fb3b5231a8d8917dd","modified":1570267538364},{"_id":"themes/3-hexo/.git/hooks/commit-msg.sample","hash":"ee1ed5aad98a435f2020b6de35c173b75d9affac","modified":1570267538364},{"_id":"themes/3-hexo/.git/hooks/fsmonitor-watchman.sample","hash":"f7c0aa40cb0d620ff0bca3efe3521ec79e5d7156","modified":1570267538364},{"_id":"themes/3-hexo/.git/hooks/post-update.sample","hash":"b614c2f63da7dca9f1db2e7ade61ef30448fc96c","modified":1570267538365},{"_id":"themes/3-hexo/.git/hooks/pre-applypatch.sample","hash":"f208287c1a92525de9f5462e905a9d31de1e2d75","modified":1570267538365},{"_id":"themes/3-hexo/.git/hooks/pre-commit.sample","hash":"33729ad4ce51acda35094e581e4088f3167a0af8","modified":1570267538364},{"_id":"themes/3-hexo/.git/hooks/pre-push.sample","hash":"5c8518bfd1d1d3d2c1a7194994c0a16d8a313a41","modified":1570267538365},{"_id":"themes/3-hexo/.git/hooks/pre-rebase.sample","hash":"288efdc0027db4cfd8b7c47c4aeddba09b6ded12","modified":1570267538364},{"_id":"themes/3-hexo/.git/hooks/pre-receive.sample","hash":"705a17d259e7896f0082fe2e9f2c0c3b127be5ac","modified":1570267538364},{"_id":"themes/3-hexo/.git/hooks/prepare-commit-msg.sample","hash":"2584806ba147152ae005cb675aa4f01d5d068456","modified":1570267538365},{"_id":"themes/3-hexo/.git/hooks/update.sample","hash":"e729cd61b27c128951d139de8e7c63d1a3758dde","modified":1570267538365},{"_id":"themes/3-hexo/.git/info/exclude","hash":"c879df015d97615050afa7b9641e3352a1e701ac","modified":1570267538363},{"_id":"themes/3-hexo/.git/logs/HEAD","hash":"d4e606c68306e3202d64f8eac9d708ef977a5523","modified":1570267561817},{"_id":"themes/3-hexo/layout/_partial/article.ejs","hash":"0a0f35d1023eb2de48e39c87c4a5b9d65362266d","modified":1570267561822},{"_id":"themes/3-hexo/layout/_partial/article_copyright.ejs","hash":"1ecfeca2c4e11e424e92cbc1d22430a96bbdfab4","modified":1570267561822},{"_id":"themes/3-hexo/layout/_partial/comment.ejs","hash":"5507b4dfab2032345e012a0c5356f63b01395157","modified":1570267561823},{"_id":"themes/3-hexo/layout/_partial/copyright.ejs","hash":"d209ddcfd0149760a30837076be345a09e1797c5","modified":1570267561823},{"_id":"themes/3-hexo/layout/_partial/dashang.ejs","hash":"266e4b638b71892fdca1f5870e8f2e5d695e0958","modified":1570267561824},{"_id":"themes/3-hexo/layout/_partial/footer.ejs","hash":"1615e7620dab1dd9602902c21c71f539ea8135de","modified":1570267561824},{"_id":"themes/3-hexo/layout/_partial/friends.ejs","hash":"7a31274da81c076021692ff7c80a1be3bbf6fa4c","modified":1570267561824},{"_id":"themes/3-hexo/layout/_partial/header.ejs","hash":"30c3ab5847a18db678ffbe3fc6309ec96cb010c0","modified":1570267561824},{"_id":"themes/3-hexo/layout/_partial/full-toc.ejs","hash":"7e6c50b6c24de864e0d6a106e6a8e423e312454a","modified":1570267561824},{"_id":"themes/3-hexo/layout/_partial/mathjax.ejs","hash":"c2e5cef2377884cd79e5f686fe4f74b082744306","modified":1570267561825},{"_id":"themes/3-hexo/layout/_partial/meta.ejs","hash":"4f7e00e37783208cb350842085f1987ee854452e","modified":1570267561825},{"_id":"themes/3-hexo/layout/_partial/nav-left.ejs","hash":"2d36b810293072ce9d7cea82c8a3a987e137b117","modified":1570267561825},{"_id":"themes/3-hexo/layout/_partial/tag.ejs","hash":"da40cb48b6b1f24cbd7107f7c97b04f063e9c299","modified":1570267561825},{"_id":"themes/3-hexo/layout/_partial/nav-right.ejs","hash":"301837aa3787004f069206440be25db32e3fb087","modified":1570267561825},{"_id":"themes/3-hexo/layout/_partial/toc-ref.ejs","hash":"6406251dabda66ef686d4c15edbc3061b6d828b8","modified":1570267561825},{"_id":"themes/3-hexo/source/css/gitalk.css","hash":"58177ce227c50ee359fbf99a4fdd26058887afc5","modified":1570267561832},{"_id":"themes/3-hexo/source/css/mobile.styl","hash":"3934bcba5095e7e6c6b3a801a6e4fa3a35096e10","modified":1570267561835},{"_id":"themes/3-hexo/source/css/style.styl","hash":"c7285882370f522c3bb17055cdf615cf92f48cd0","modified":1570267561835},{"_id":"themes/3-hexo/source/img/alipay.jpg","hash":"e457d1d3dfefbbd824d154cf756a2c6d10b812a2","modified":1570267561836},{"_id":"themes/3-hexo/source/img/article-list-background.jpeg","hash":"4fdf8b3e53dd02d6ee6360aebfadb0cba1fb5633","modified":1570267561836},{"_id":"themes/3-hexo/source/img/avatar.jpg","hash":"a42360089bfa892d803cf5747eab359d90f337f1","modified":1570267561837},{"_id":"themes/3-hexo/source/img/brown-papersq.png","hash":"3a1332ede3a75a3d24f60b6ed69035b72da5e182","modified":1570267561837},{"_id":"themes/3-hexo/source/img/school-book.png","hash":"711ec983c874e093bb89eb77afcbdf6741fa61ee","modified":1570267561837},{"_id":"themes/3-hexo/source/js/iconfont.js","hash":"3a0869ca1b09af07d82987e343a3bc4cb9558ecb","modified":1570267561841},{"_id":"themes/3-hexo/source/js/jquery.autocomplete.min.js","hash":"7b8ac4d06c9e763963832529f44a56ad42a81e5f","modified":1570267561841},{"_id":"themes/3-hexo/source/js/jquery.pjax.js","hash":"191c49fdb40dff115a49cfd2b30dffb888d86550","modified":1570267561841},{"_id":"themes/3-hexo/source/js/script.js","hash":"7502191e29366a11323dc72ae365b1aed254e6f2","modified":1570267561842},{"_id":"themes/3-hexo/source/js/search.js","hash":"c80c9a231ee040c7adc07a477793873fb85ce8bc","modified":1570267561842},{"_id":"source/_posts/images/1570783134086.png","hash":"ba31616e3183191bdc9280fd30acbaa419e69e2a","modified":1570784630097},{"_id":"themes/3-hexo/source/img/weixin.jpg","hash":"8dafb22561698d0758fba9ea2a45abf6ad3512a2","modified":1570267561838},{"_id":"source/_posts/images/1570674939333.png","hash":"a944ffb9ba0afeaad24cacc53f734a8e6c89eb01","modified":1570784630095},{"_id":"themes/3-hexo/.git/objects/pack/pack-819329865795421cd737401a06b08bfaf573f1cc.idx","hash":"ae418c381ab7b669ad22397f6fd0c3da03466ff8","modified":1570267561809},{"_id":"themes/3-hexo/.git/refs/heads/master","hash":"36e1610a86bddf4a3dd3b00a29a138d2168f7624","modified":1570267561817},{"_id":"themes/3-hexo/layout/_partial/comments/click2show.ejs","hash":"359f73329b9821f3ca3554d306a04d6766110a5a","modified":1570267561823},{"_id":"themes/3-hexo/layout/_partial/comments/disqus.ejs","hash":"cd0022ce7e6d6efb07a00e87477cdf791f7f6703","modified":1570267561823},{"_id":"themes/3-hexo/layout/_partial/comments/gentie.ejs","hash":"1d6eacdadeb247e3b349ca7168f797beae8ff4c5","modified":1570267561823},{"_id":"themes/3-hexo/layout/_partial/comments/gitalk.ejs","hash":"fbd3c7d72c8354d700918390c6cbfc0a11408277","modified":1570267561823},{"_id":"themes/3-hexo/layout/_partial/comments/gitment.ejs","hash":"f16442568b43d034faaa8e3507f5ae8da34c7b72","modified":1570267561823},{"_id":"themes/3-hexo/source/css/_partial/autocomplete.styl","hash":"f6847a2c6d35dbd6d06dc591bd34ed2019784048","modified":1570267561826},{"_id":"themes/3-hexo/source/css/_partial/comment.styl","hash":"cc0a862b31359a85d12579e49d2eca58d128275c","modified":1570267561826},{"_id":"themes/3-hexo/source/css/_partial/dashang.styl","hash":"f6447a2ac407228e1d53e3455db2919ac0e9f094","modified":1570267561827},{"_id":"themes/3-hexo/source/css/_partial/fade.styl","hash":"4f687cbc74caf8a0887f5e89250284a9bce8b5c1","modified":1570267561827},{"_id":"themes/3-hexo/source/css/_partial/font.styl","hash":"4d5ac149709447c5eee45f0e23dadeea94fd98ce","modified":1570267561827},{"_id":"themes/3-hexo/source/css/_partial/full-toc.styl","hash":"0ba318911afbbbffbd2473b472aedf2d3900e978","modified":1570267561827},{"_id":"themes/3-hexo/source/css/_partial/nav-left.styl","hash":"1bd865029ba8c11750fff83d87f69e5d7c137928","modified":1570267561827},{"_id":"themes/3-hexo/source/css/_partial/nav-right.styl","hash":"3da8fa04efccfd054a6a65f7153f197d4d68281d","modified":1570267561828},{"_id":"themes/3-hexo/source/css/_partial/nprogress.styl","hash":"65efbddd23a264e7d1e85f4073228526770e833c","modified":1570267561828},{"_id":"themes/3-hexo/source/css/_partial/num-load.styl","hash":"4b996440bba8ec755aa70bc6d074d7dbba55ec0c","modified":1570267561828},{"_id":"themes/3-hexo/source/css/_partial/post.styl","hash":"cdead1a127e9bdd4818117e4c7fe7ac4638b4c19","modified":1570267561828},{"_id":"themes/3-hexo/source/css/fonts/icomoon.eot","hash":"b6195bedc1cb2f9cfcb26cc27021f2e94be2ab0a","modified":1570267561829},{"_id":"themes/3-hexo/source/css/fonts/icomoon.svg","hash":"37ac1ef28b03f46bf3ad2606c86f0e1ec3e4405f","modified":1570267561829},{"_id":"themes/3-hexo/source/css/fonts/icomoon.ttf","hash":"eb976d8b8559fcddfc2658a03a4350cb566fc06b","modified":1570267561829},{"_id":"themes/3-hexo/source/css/fonts/icomoon.woff","hash":"3985d29416bb9b19f50a2f20f2bbbce47f10af8d","modified":1570267561829},{"_id":"themes/3-hexo/source/css/fonts/iconfont.eot","hash":"3dfe8e557d9dfaf39bca088a02b76deb82dbaa3d","modified":1570267561830},{"_id":"themes/3-hexo/source/css/fonts/iconfont.svg","hash":"c61a31e5310430312677fffe4286097d29d10151","modified":1570267561830},{"_id":"themes/3-hexo/source/css/fonts/iconfont.ttf","hash":"aa087561480fb9c2cfd541e33d1e99d5ac1a56bb","modified":1570267561831},{"_id":"themes/3-hexo/source/css/fonts/iconfont.woff","hash":"f8ed131ccf13f4bdd3ec11fc3e997339dd7b66ba","modified":1570267561831},{"_id":"themes/3-hexo/source/css/fonts/selection.json","hash":"57c7f100019d57b512aab509185cb0a6eb9aa4c8","modified":1570267561831},{"_id":"themes/3-hexo/source/css/hl_theme/atom-dark.styl","hash":"f3eb4e5feda9cbd6242ccf44ca064e2979b5d719","modified":1570267561832},{"_id":"themes/3-hexo/source/css/hl_theme/atom-light.styl","hash":"69d184a682bcaeba2b180b437dc4431bc3be38aa","modified":1570267561832},{"_id":"themes/3-hexo/source/css/hl_theme/brown-paper.styl","hash":"03af387edcc1cf8c18d12e9c440fd51b6cf425b6","modified":1570267561833},{"_id":"themes/3-hexo/source/css/hl_theme/darcula.styl","hash":"2bfc14f27ccca108b4b3755782de8366e8bd001e","modified":1570267561833},{"_id":"themes/3-hexo/source/css/hl_theme/github-gist.styl","hash":"5e05b19832c1099bd9d284bc3ed00dc8a3d7ee23","modified":1570267561833},{"_id":"themes/3-hexo/source/css/hl_theme/github.styl","hash":"53276ff1f224f691dfe811e82c0af7f4476abf5d","modified":1570267561833},{"_id":"themes/3-hexo/source/css/hl_theme/gruvbox-dark.styl","hash":"315ad610d303caba9eac80a7d51002193a15478a","modified":1570267561833},{"_id":"themes/3-hexo/source/css/hl_theme/gruvbox-light.styl","hash":"1bece084b1dbbbd4af064f05feffd8c332b96a48","modified":1570267561834},{"_id":"themes/3-hexo/source/css/hl_theme/kimbie-dark.styl","hash":"e9c190f9ffc37a13cac430512e4e0c760205be4a","modified":1570267561834},{"_id":"themes/3-hexo/source/css/hl_theme/kimbie-light.styl","hash":"0c3ccd0d64e7504c7061d246dc32737f502f64e4","modified":1570267561834},{"_id":"themes/3-hexo/source/css/hl_theme/railscasts.styl","hash":"a6e8cfd2202afd7893f5268f3437421e35066e7b","modified":1570267561834},{"_id":"themes/3-hexo/source/css/hl_theme/rainbow.styl","hash":"e5c37646a9d9c1094f9aab7a7c65a4b242e8db00","modified":1570267561834},{"_id":"themes/3-hexo/source/css/hl_theme/school-book.styl","hash":"51659351b391a2be5c68728bb51b7ad467c5e0db","modified":1570267561834},{"_id":"themes/3-hexo/source/css/hl_theme/sublime.styl","hash":"501d75ef0f4385bea24d9b9b4cc434ba68d4be27","modified":1570267561835},{"_id":"themes/3-hexo/source/css/hl_theme/sunburst.styl","hash":"2aa9817e68fb2ed216781ea04b733039ebe18214","modified":1570267561835},{"_id":"themes/3-hexo/source/css/hl_theme/zenbum.styl","hash":"933a3b196d01254dea5e6f48105ea15e210ae000","modified":1570267561835},{"_id":"source/_posts/images/1570674953248.png","hash":"bae9bd1b0dafbee6df631f87d77ad33e4c8fefba","modified":1570784630096},{"_id":"themes/3-hexo/source/js/gitment.js","hash":"59a1e03f2b0ce61dd9bd405d3c52d3e07cc10dec","modified":1570267561840},{"_id":"themes/3-hexo/.git/logs/refs/heads/master","hash":"d4e606c68306e3202d64f8eac9d708ef977a5523","modified":1570267561818},{"_id":"themes/3-hexo/.git/refs/remotes/origin/HEAD","hash":"d9427cda09aba1cdde5c69c2b13c905bddb0bc51","modified":1570267561817},{"_id":"themes/3-hexo/source/js/gitalk.js","hash":"d1eb82a3280981bd652d9a8e323060e4311c547b","modified":1570267561840},{"_id":"themes/3-hexo/.git/logs/refs/remotes/origin/HEAD","hash":"d4e606c68306e3202d64f8eac9d708ef977a5523","modified":1570267561817},{"_id":"source/_posts/images/1570613306377.png","hash":"cbd6c68dc495c55df5010e0af487eac3a7fcbb43","modified":1570784630094},{"_id":"themes/3-hexo/.git/objects/pack/pack-819329865795421cd737401a06b08bfaf573f1cc.pack","hash":"3c20a8fee31c802781f0040ba75ebd86f22efffd","modified":1570267561808},{"_id":"public/about/index.html","hash":"a6e93c5395485275ec8c7eb9c31ca36715bf0a41","modified":1570789567389},{"_id":"public/2019/10/11/常用单词学习/index.html","hash":"11835660bb04831e3a8b9b152015a031207f4c5e","modified":1570810315506},{"_id":"public/2019/10/11/python_4/index.html","hash":"ebc5777b9a76a2945c595148343f554792cb3536","modified":1570789567389},{"_id":"public/2019/10/11/python_1/index.html","hash":"dfcbd2e884929554b14e1b227407d527aaab21fb","modified":1570789567390},{"_id":"public/2019/10/11/python_2/index.html","hash":"0c22196dd1e0e4c1b354496505641219b32269f7","modified":1570789567390},{"_id":"public/2019/10/11/Python Core Programming Note 2/index.html","hash":"b087a714790166c1fbbdfbb6c9135463873b8b33","modified":1570789567390},{"_id":"public/2019/10/11/Python_3/index.html","hash":"ed72aaafc211514bf71250c8e3f6a58dbfdec092","modified":1570789567390},{"_id":"public/2019/10/11/Twisted  介绍/index.html","hash":"cf6440e71073dec912fa6bdf08fbff79e0249fb4","modified":1570810229003},{"_id":"public/2019/10/11/Python Core Programming Note 1/index.html","hash":"b160afdee9366472b1d65188d97fee0760fa5b58","modified":1570789567390},{"_id":"public/2019/10/05/第一个/index.html","hash":"2e5b9240884a214a285bf5fb8915362b87154f04","modified":1570788732260},{"_id":"public/2019/10/05/hello-world/index.html","hash":"7d25e736f44ad441a1b6b1f5dfed9ad530123d0f","modified":1570789567390},{"_id":"public/archives/index.html","hash":"6a80ffc2d1794ead29b1e2396ff4de336ea7cd28","modified":1570789567391},{"_id":"public/archives/2019/index.html","hash":"6a80ffc2d1794ead29b1e2396ff4de336ea7cd28","modified":1570789567391},{"_id":"public/archives/2019/10/index.html","hash":"6a80ffc2d1794ead29b1e2396ff4de336ea7cd28","modified":1570789567391},{"_id":"public/categories/Python笔记/index.html","hash":"6a80ffc2d1794ead29b1e2396ff4de336ea7cd28","modified":1570789567391},{"_id":"public/categories/英语学习/index.html","hash":"6a80ffc2d1794ead29b1e2396ff4de336ea7cd28","modified":1570789567391},{"_id":"public/tags/Python/index.html","hash":"6a80ffc2d1794ead29b1e2396ff4de336ea7cd28","modified":1570789567391},{"_id":"public/tags/Core-Programming/index.html","hash":"6a80ffc2d1794ead29b1e2396ff4de336ea7cd28","modified":1570789567391},{"_id":"public/tags/Note/index.html","hash":"6a80ffc2d1794ead29b1e2396ff4de336ea7cd28","modified":1570789567391},{"_id":"public/tags/English/index.html","hash":"6a80ffc2d1794ead29b1e2396ff4de336ea7cd28","modified":1570789567391},{"_id":"public/index.html","hash":"6a80ffc2d1794ead29b1e2396ff4de336ea7cd28","modified":1570789567391}],"Category":[{"name":"Python笔记","_id":"ck1lykto60003ep11hjqc2vva"},{"name":"英语学习","_id":"ck1lykton000kep11i6npcctg"}],"Data":[],"Page":[{"title":"about","date":"2019-10-06T01:42:53.000Z","_content":"# 这是关于我，有空再加吧\n","source":"about/index.md","raw":"---\ntitle: about\ndate: 2019-10-06 09:42:53\n---\n# 这是关于我，有空再加吧\n","updated":"2019-10-06T01:43:30.039Z","path":"about/index.html","comments":1,"layout":"page","_id":"ck1lykto40001ep11sik0eaoc","content":"<h1 id=\"这是关于我，有空再加吧\"><a href=\"#这是关于我，有空再加吧\" class=\"headerlink\" title=\"这是关于我，有空再加吧\"></a>这是关于我，有空再加吧</h1>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"这是关于我，有空再加吧\"><a href=\"#这是关于我，有空再加吧\" class=\"headerlink\" title=\"这是关于我，有空再加吧\"></a>这是关于我，有空再加吧</h1>"}],"Post":[{"title":"Python Core Programming Note 1","_content":"\n## Regular Expression\n![常用表达式](./images/1570674939333.png)\n![续](./images/1570674953248.png)\n\n## match() & search()\n\n```python\nimport re\nm = re.match('\\d','a541')\nif m is not None:\n    print(m.group())\nelse:\n    print(\"none found\")\n\t\n## none found\n\nimport re\nm = re.match('\\d','a541')\nif m is not None:\n    print(m.group())\nelse:\n    print(\"none found\")\n\t\n## 5\n```\n```\nimport re\nm = re.search('..[\\d]{1,3}','\\na51')\nif m is not None:\n    print(m.group())\nelse:\n    print(\"none found\")\n# . 匹配除\\n外的任意字符，其他如\\t,\\.都可以\n```\n\n## 分组\n\n```python\nimport re\nm = re.search('\\w+@(\\w+\\.)*(\\w+)*\\.com','aaa@aa.a.com')\nif m is not None:\n    print(m.group())\nelse:\n    print(\"none found\")\n```\n\n## sub() & subn()\n\n```python\n#使用函数作为参数\ndef repl_t(txt):\n    if txt.group(0) == '-':\n        return 'x'\n    elif txt.group(0) == '--':\n        return '-'\n    elif txt.group(0) == '-1':\n        return '\\\"good\\\"'\nm = re.subn('(-{1,2})\\d?',repl_t,\"d----asf-s-a-123\")\nprint(m)\n```\n\n### Regular Expression -> Split()\n\n```python\ndata = (\n 'Mountain View, CA 94040',\n 'Sunnyvale, CA',\n 'Los Altos, 94023',\n 'Cupertino 95014',\n 'Palo Alto CA',\n )\n\nfor d in data:\n     v = re.split(r\", |(?= (?:\\d{5}|[A-Z]{2})) \",d)\n     print(v)\n```\n\n### 扩展表达式\n// 前瞻：\nexp1(?=exp2) 查找exp2前面的exp1\n// 后顾：\n(?<=exp2)exp1 查找exp2后面的exp1\n// 负前瞻：\nexp1(?!exp2) 查找后面不是exp2的exp1\n// 负后顾：\n(?<!exp2)exp1 查找前面不是exp2的exp1\n\n要理解?:则需要理解捕获分组和非捕获分组的概念：\n\n> ()表示捕获分组，()会把每个分组里的匹配的值保存起来，使用$n(n是一个数字，表示第n个捕获组的内容)\n> (?:)表示非捕获分组，和捕获分组唯一的区别在于，非捕获分组匹配的值不会保存起来\n\n\n```python\nm = re.findall(r'(?<!YES)yes','YESyes? YESYes . YESyesYES!! ')\nprint(m)\n\nm = re.sub('\\B(?=(?:\\d{3})+(?!\\d))',',',\"123456789\")\nprint(m)\n```\n\n?i ignorecase\n?m multi-line search\n?s dotall, 点号也可表示\\n\n?x 格式化正则中的空格\n?: 分组查询但不保存在结果中\n\n```python\nm = re.findall(r'(?m)(^th[\\w ]+)', \"\"\"\nThis line is the first,\nanother line,\nthat line, it's the best\n\"\"\")\n\nprint(m)\n```\n\n```python\nm = re.search(r'''(?x)\n \\((\\d{3})\\) # 区号\n [ ] # 空白符\n (\\d{3}) # 前缀\n - # 横线\n (\\d{4}) # 终点数字\n ''', '(800) 555-1212').group()\nprint(m)\n```\n\n```python\nm = re.findall(r'http://(?:\\w+\\.)*(\\w+\\.com)','http://google.com http://www.google.com http://code.google.com')\nprint(m)\n```\n\n### 贪婪与非贪婪\n一个方案是使用“非贪婪”操作符“?”。读者可以在“*”、“+”或者“?”之后使\n用该操作符。该操作符将要求正则表达式引擎匹配尽可能少的字符。\n\n```python\ndata = 'Thu Feb 15 17:46:04 2007::uzifzf@dpyivihw.gov::1171590364-6-8'\npatt = '.+?(\\d+-\\d+-\\d+)'\nm = re.match(patt, data).group(1)\nprint(m)\n```","source":"_posts/Python Core Programming Note 1.md","raw":"---\ntitle: Python Core Programming Note 1\ncategories:\n- Python笔记\ntags: \n- Python\n- Core Programming\n- Note\n---\n\n## Regular Expression\n![常用表达式](./images/1570674939333.png)\n![续](./images/1570674953248.png)\n\n## match() & search()\n\n```python\nimport re\nm = re.match('\\d','a541')\nif m is not None:\n    print(m.group())\nelse:\n    print(\"none found\")\n\t\n## none found\n\nimport re\nm = re.match('\\d','a541')\nif m is not None:\n    print(m.group())\nelse:\n    print(\"none found\")\n\t\n## 5\n```\n```\nimport re\nm = re.search('..[\\d]{1,3}','\\na51')\nif m is not None:\n    print(m.group())\nelse:\n    print(\"none found\")\n# . 匹配除\\n外的任意字符，其他如\\t,\\.都可以\n```\n\n## 分组\n\n```python\nimport re\nm = re.search('\\w+@(\\w+\\.)*(\\w+)*\\.com','aaa@aa.a.com')\nif m is not None:\n    print(m.group())\nelse:\n    print(\"none found\")\n```\n\n## sub() & subn()\n\n```python\n#使用函数作为参数\ndef repl_t(txt):\n    if txt.group(0) == '-':\n        return 'x'\n    elif txt.group(0) == '--':\n        return '-'\n    elif txt.group(0) == '-1':\n        return '\\\"good\\\"'\nm = re.subn('(-{1,2})\\d?',repl_t,\"d----asf-s-a-123\")\nprint(m)\n```\n\n### Regular Expression -> Split()\n\n```python\ndata = (\n 'Mountain View, CA 94040',\n 'Sunnyvale, CA',\n 'Los Altos, 94023',\n 'Cupertino 95014',\n 'Palo Alto CA',\n )\n\nfor d in data:\n     v = re.split(r\", |(?= (?:\\d{5}|[A-Z]{2})) \",d)\n     print(v)\n```\n\n### 扩展表达式\n// 前瞻：\nexp1(?=exp2) 查找exp2前面的exp1\n// 后顾：\n(?<=exp2)exp1 查找exp2后面的exp1\n// 负前瞻：\nexp1(?!exp2) 查找后面不是exp2的exp1\n// 负后顾：\n(?<!exp2)exp1 查找前面不是exp2的exp1\n\n要理解?:则需要理解捕获分组和非捕获分组的概念：\n\n> ()表示捕获分组，()会把每个分组里的匹配的值保存起来，使用$n(n是一个数字，表示第n个捕获组的内容)\n> (?:)表示非捕获分组，和捕获分组唯一的区别在于，非捕获分组匹配的值不会保存起来\n\n\n```python\nm = re.findall(r'(?<!YES)yes','YESyes? YESYes . YESyesYES!! ')\nprint(m)\n\nm = re.sub('\\B(?=(?:\\d{3})+(?!\\d))',',',\"123456789\")\nprint(m)\n```\n\n?i ignorecase\n?m multi-line search\n?s dotall, 点号也可表示\\n\n?x 格式化正则中的空格\n?: 分组查询但不保存在结果中\n\n```python\nm = re.findall(r'(?m)(^th[\\w ]+)', \"\"\"\nThis line is the first,\nanother line,\nthat line, it's the best\n\"\"\")\n\nprint(m)\n```\n\n```python\nm = re.search(r'''(?x)\n \\((\\d{3})\\) # 区号\n [ ] # 空白符\n (\\d{3}) # 前缀\n - # 横线\n (\\d{4}) # 终点数字\n ''', '(800) 555-1212').group()\nprint(m)\n```\n\n```python\nm = re.findall(r'http://(?:\\w+\\.)*(\\w+\\.com)','http://google.com http://www.google.com http://code.google.com')\nprint(m)\n```\n\n### 贪婪与非贪婪\n一个方案是使用“非贪婪”操作符“?”。读者可以在“*”、“+”或者“?”之后使\n用该操作符。该操作符将要求正则表达式引擎匹配尽可能少的字符。\n\n```python\ndata = 'Thu Feb 15 17:46:04 2007::uzifzf@dpyivihw.gov::1171590364-6-8'\npatt = '.+?(\\d+-\\d+-\\d+)'\nm = re.match(patt, data).group(1)\nprint(m)\n```","slug":"Python Core Programming Note 1","published":1,"date":"2019-10-11T10:25:57.893Z","updated":"2019-10-11T10:25:57.893Z","_id":"ck1lykto00000ep11f13e5b1n","comments":1,"layout":"post","photos":[],"link":"","content":"<h2 id=\"Regular-Expression\"><a href=\"#Regular-Expression\" class=\"headerlink\" title=\"Regular Expression\"></a>Regular Expression</h2><p><img src=\"./images/1570674939333.png\" alt=\"常用表达式\"><br><img src=\"./images/1570674953248.png\" alt=\"续\"></p>\n<h2 id=\"match-amp-search\"><a href=\"#match-amp-search\" class=\"headerlink\" title=\"match() &amp; search()\"></a>match() &amp; search()</h2><pre><code class=\"python\">import re\nm = re.match(&#39;\\d&#39;,&#39;a541&#39;)\nif m is not None:\n    print(m.group())\nelse:\n    print(&quot;none found&quot;)\n\n## none found\n\nimport re\nm = re.match(&#39;\\d&#39;,&#39;a541&#39;)\nif m is not None:\n    print(m.group())\nelse:\n    print(&quot;none found&quot;)\n\n## 5</code></pre>\n<pre><code>import re\nm = re.search(&#39;..[\\d]{1,3}&#39;,&#39;\\na51&#39;)\nif m is not None:\n    print(m.group())\nelse:\n    print(&quot;none found&quot;)\n# . 匹配除\\n外的任意字符，其他如\\t,\\.都可以</code></pre><h2 id=\"分组\"><a href=\"#分组\" class=\"headerlink\" title=\"分组\"></a>分组</h2><pre><code class=\"python\">import re\nm = re.search(&#39;\\w+@(\\w+\\.)*(\\w+)*\\.com&#39;,&#39;aaa@aa.a.com&#39;)\nif m is not None:\n    print(m.group())\nelse:\n    print(&quot;none found&quot;)</code></pre>\n<h2 id=\"sub-amp-subn\"><a href=\"#sub-amp-subn\" class=\"headerlink\" title=\"sub() &amp; subn()\"></a>sub() &amp; subn()</h2><pre><code class=\"python\">#使用函数作为参数\ndef repl_t(txt):\n    if txt.group(0) == &#39;-&#39;:\n        return &#39;x&#39;\n    elif txt.group(0) == &#39;--&#39;:\n        return &#39;-&#39;\n    elif txt.group(0) == &#39;-1&#39;:\n        return &#39;\\&quot;good\\&quot;&#39;\nm = re.subn(&#39;(-{1,2})\\d?&#39;,repl_t,&quot;d----asf-s-a-123&quot;)\nprint(m)</code></pre>\n<h3 id=\"Regular-Expression-gt-Split\"><a href=\"#Regular-Expression-gt-Split\" class=\"headerlink\" title=\"Regular Expression -&gt; Split()\"></a>Regular Expression -&gt; Split()</h3><pre><code class=\"python\">data = (\n &#39;Mountain View, CA 94040&#39;,\n &#39;Sunnyvale, CA&#39;,\n &#39;Los Altos, 94023&#39;,\n &#39;Cupertino 95014&#39;,\n &#39;Palo Alto CA&#39;,\n )\n\nfor d in data:\n     v = re.split(r&quot;, |(?= (?:\\d{5}|[A-Z]{2})) &quot;,d)\n     print(v)</code></pre>\n<h3 id=\"扩展表达式\"><a href=\"#扩展表达式\" class=\"headerlink\" title=\"扩展表达式\"></a>扩展表达式</h3><p>// 前瞻：<br>exp1(?=exp2) 查找exp2前面的exp1<br>// 后顾：<br>(?&lt;=exp2)exp1 查找exp2后面的exp1<br>// 负前瞻：<br>exp1(?!exp2) 查找后面不是exp2的exp1<br>// 负后顾：<br>(?&lt;!exp2)exp1 查找前面不是exp2的exp1</p>\n<p>要理解?:则需要理解捕获分组和非捕获分组的概念：</p>\n<blockquote>\n<p>()表示捕获分组，()会把每个分组里的匹配的值保存起来，使用$n(n是一个数字，表示第n个捕获组的内容)<br>(?:)表示非捕获分组，和捕获分组唯一的区别在于，非捕获分组匹配的值不会保存起来</p>\n</blockquote>\n<pre><code class=\"python\">m = re.findall(r&#39;(?&lt;!YES)yes&#39;,&#39;YESyes? YESYes . YESyesYES!! &#39;)\nprint(m)\n\nm = re.sub(&#39;\\B(?=(?:\\d{3})+(?!\\d))&#39;,&#39;,&#39;,&quot;123456789&quot;)\nprint(m)</code></pre>\n<p>?i ignorecase<br>?m multi-line search<br>?s dotall, 点号也可表示\\n<br>?x 格式化正则中的空格<br>?: 分组查询但不保存在结果中</p>\n<pre><code class=\"python\">m = re.findall(r&#39;(?m)(^th[\\w ]+)&#39;, &quot;&quot;&quot;\nThis line is the first,\nanother line,\nthat line, it&#39;s the best\n&quot;&quot;&quot;)\n\nprint(m)</code></pre>\n<pre><code class=\"python\">m = re.search(r&#39;&#39;&#39;(?x)\n \\((\\d{3})\\) # 区号\n [ ] # 空白符\n (\\d{3}) # 前缀\n - # 横线\n (\\d{4}) # 终点数字\n &#39;&#39;&#39;, &#39;(800) 555-1212&#39;).group()\nprint(m)</code></pre>\n<pre><code class=\"python\">m = re.findall(r&#39;http://(?:\\w+\\.)*(\\w+\\.com)&#39;,&#39;http://google.com http://www.google.com http://code.google.com&#39;)\nprint(m)</code></pre>\n<h3 id=\"贪婪与非贪婪\"><a href=\"#贪婪与非贪婪\" class=\"headerlink\" title=\"贪婪与非贪婪\"></a>贪婪与非贪婪</h3><p>一个方案是使用“非贪婪”操作符“?”。读者可以在“*”、“+”或者“?”之后使<br>用该操作符。该操作符将要求正则表达式引擎匹配尽可能少的字符。</p>\n<pre><code class=\"python\">data = &#39;Thu Feb 15 17:46:04 2007::uzifzf@dpyivihw.gov::1171590364-6-8&#39;\npatt = &#39;.+?(\\d+-\\d+-\\d+)&#39;\nm = re.match(patt, data).group(1)\nprint(m)</code></pre>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"Regular-Expression\"><a href=\"#Regular-Expression\" class=\"headerlink\" title=\"Regular Expression\"></a>Regular Expression</h2><p><img src=\"./images/1570674939333.png\" alt=\"常用表达式\"><br><img src=\"./images/1570674953248.png\" alt=\"续\"></p>\n<h2 id=\"match-amp-search\"><a href=\"#match-amp-search\" class=\"headerlink\" title=\"match() &amp; search()\"></a>match() &amp; search()</h2><pre><code class=\"python\">import re\nm = re.match(&#39;\\d&#39;,&#39;a541&#39;)\nif m is not None:\n    print(m.group())\nelse:\n    print(&quot;none found&quot;)\n\n## none found\n\nimport re\nm = re.match(&#39;\\d&#39;,&#39;a541&#39;)\nif m is not None:\n    print(m.group())\nelse:\n    print(&quot;none found&quot;)\n\n## 5</code></pre>\n<pre><code>import re\nm = re.search(&#39;..[\\d]{1,3}&#39;,&#39;\\na51&#39;)\nif m is not None:\n    print(m.group())\nelse:\n    print(&quot;none found&quot;)\n# . 匹配除\\n外的任意字符，其他如\\t,\\.都可以</code></pre><h2 id=\"分组\"><a href=\"#分组\" class=\"headerlink\" title=\"分组\"></a>分组</h2><pre><code class=\"python\">import re\nm = re.search(&#39;\\w+@(\\w+\\.)*(\\w+)*\\.com&#39;,&#39;aaa@aa.a.com&#39;)\nif m is not None:\n    print(m.group())\nelse:\n    print(&quot;none found&quot;)</code></pre>\n<h2 id=\"sub-amp-subn\"><a href=\"#sub-amp-subn\" class=\"headerlink\" title=\"sub() &amp; subn()\"></a>sub() &amp; subn()</h2><pre><code class=\"python\">#使用函数作为参数\ndef repl_t(txt):\n    if txt.group(0) == &#39;-&#39;:\n        return &#39;x&#39;\n    elif txt.group(0) == &#39;--&#39;:\n        return &#39;-&#39;\n    elif txt.group(0) == &#39;-1&#39;:\n        return &#39;\\&quot;good\\&quot;&#39;\nm = re.subn(&#39;(-{1,2})\\d?&#39;,repl_t,&quot;d----asf-s-a-123&quot;)\nprint(m)</code></pre>\n<h3 id=\"Regular-Expression-gt-Split\"><a href=\"#Regular-Expression-gt-Split\" class=\"headerlink\" title=\"Regular Expression -&gt; Split()\"></a>Regular Expression -&gt; Split()</h3><pre><code class=\"python\">data = (\n &#39;Mountain View, CA 94040&#39;,\n &#39;Sunnyvale, CA&#39;,\n &#39;Los Altos, 94023&#39;,\n &#39;Cupertino 95014&#39;,\n &#39;Palo Alto CA&#39;,\n )\n\nfor d in data:\n     v = re.split(r&quot;, |(?= (?:\\d{5}|[A-Z]{2})) &quot;,d)\n     print(v)</code></pre>\n<h3 id=\"扩展表达式\"><a href=\"#扩展表达式\" class=\"headerlink\" title=\"扩展表达式\"></a>扩展表达式</h3><p>// 前瞻：<br>exp1(?=exp2) 查找exp2前面的exp1<br>// 后顾：<br>(?&lt;=exp2)exp1 查找exp2后面的exp1<br>// 负前瞻：<br>exp1(?!exp2) 查找后面不是exp2的exp1<br>// 负后顾：<br>(?&lt;!exp2)exp1 查找前面不是exp2的exp1</p>\n<p>要理解?:则需要理解捕获分组和非捕获分组的概念：</p>\n<blockquote>\n<p>()表示捕获分组，()会把每个分组里的匹配的值保存起来，使用$n(n是一个数字，表示第n个捕获组的内容)<br>(?:)表示非捕获分组，和捕获分组唯一的区别在于，非捕获分组匹配的值不会保存起来</p>\n</blockquote>\n<pre><code class=\"python\">m = re.findall(r&#39;(?&lt;!YES)yes&#39;,&#39;YESyes? YESYes . YESyesYES!! &#39;)\nprint(m)\n\nm = re.sub(&#39;\\B(?=(?:\\d{3})+(?!\\d))&#39;,&#39;,&#39;,&quot;123456789&quot;)\nprint(m)</code></pre>\n<p>?i ignorecase<br>?m multi-line search<br>?s dotall, 点号也可表示\\n<br>?x 格式化正则中的空格<br>?: 分组查询但不保存在结果中</p>\n<pre><code class=\"python\">m = re.findall(r&#39;(?m)(^th[\\w ]+)&#39;, &quot;&quot;&quot;\nThis line is the first,\nanother line,\nthat line, it&#39;s the best\n&quot;&quot;&quot;)\n\nprint(m)</code></pre>\n<pre><code class=\"python\">m = re.search(r&#39;&#39;&#39;(?x)\n \\((\\d{3})\\) # 区号\n [ ] # 空白符\n (\\d{3}) # 前缀\n - # 横线\n (\\d{4}) # 终点数字\n &#39;&#39;&#39;, &#39;(800) 555-1212&#39;).group()\nprint(m)</code></pre>\n<pre><code class=\"python\">m = re.findall(r&#39;http://(?:\\w+\\.)*(\\w+\\.com)&#39;,&#39;http://google.com http://www.google.com http://code.google.com&#39;)\nprint(m)</code></pre>\n<h3 id=\"贪婪与非贪婪\"><a href=\"#贪婪与非贪婪\" class=\"headerlink\" title=\"贪婪与非贪婪\"></a>贪婪与非贪婪</h3><p>一个方案是使用“非贪婪”操作符“?”。读者可以在“*”、“+”或者“?”之后使<br>用该操作符。该操作符将要求正则表达式引擎匹配尽可能少的字符。</p>\n<pre><code class=\"python\">data = &#39;Thu Feb 15 17:46:04 2007::uzifzf@dpyivihw.gov::1171590364-6-8&#39;\npatt = &#39;.+?(\\d+-\\d+-\\d+)&#39;\nm = re.match(patt, data).group(1)\nprint(m)</code></pre>\n"},{"title":"Python Core Programming Note 2","_content":"\n## Net Programming\n\n#### 1. TCP\n+ Server:\n\n```python\nfrom socket import *\nfrom time import ctime\n\nHOST = ''\nPORT = 21111\nBUFSIZ = 1024\nADDR = (HOST, PORT)\n\ntcpSerSocket = socket(AF_INET, SOCK_STREAM)\ntcpSerSocket.bind(ADDR)\ntcpSerSocket.listen(5)\n\ntry:\n    while True:\n        print(\"waiting for connection...\")\n        tcpCliSocket, addr = tcpSerSocket.accept()\n        print(\"connected from :\",addr)\n        while True:\n            data = tcpCliSocket.recv(BUFSIZ)\n            if not data:\n                break\n            print(\"rec:\",data)\n            send_str = '[%s] %s' %(bytes(ctime(), 'utf-8'), 'Oh?')\n            tcpCliSocket.send(send_str.encode('utf-8'))\n        tcpCliSocket.close()\nexcept EOFError:\n    print(\"Error: EOFEError\")\nexcept KeyboardInterrupt:\n    print(\"Error: EOFEError\")\nfinally:\n    tcpSerSocket.close()\n```\n\n+ Client\n\n```python\nfrom socket import *\n\nHOST = '127.0.0.1' \nPORT = 21111\nBUFSIZ = 1024\nADDR = (HOST, PORT)\n\ntcpCliSocket = socket(AF_INET, SOCK_STREAM)\ntcpCliSocket.connect(ADDR)\n\nwhile True:\n    data = input('> ')\n    if not data:\n        break\n\n    tcpCliSocket.send(data.encode('utf-8'))\n    data = tcpCliSocket.recv(BUFSIZ)\n    if not data:\n        break\n    print(data.decode('utf-8'))\n\ntcpCliSocket.close()\n\n```\n\n#### 2. UDP\n\n+ Server\n\n```python\nfrom socket import *\nfrom time import ctime\n\nHOST = ''\nPORT = 21111\nBUFSIZ = 1024\nADDR = (HOST, PORT)\n\nudpSerSocket = socket(AF_INET, SOCK_DGRAM)\nudpSerSocket.bind(ADDR)\n\ntry:\n    while True:\n        print(\"waiting for message...\")\n        msg, addr = udpSerSocket.recvfrom(BUFSIZ)\n        if msg.decode('utf-8') == ' ':\n            break\n        print('Rev client:',msg)\n        send_str = '[%s] %s' %(bytes(ctime(), 'utf-8'), msg)\n        udpSerSocket.sendto(send_str.encode('utf-8'),addr)\n        \nexcept EOFError:\n    print(\"Error: EOFEError\")\nexcept KeyboardInterrupt:\n    print(\"Error: EOFEError\")\nfinally:\n    udpSerSocket.close()\n```\n\n+ Client\n\n```python\nfrom socket import *\n\nHOST = '127.0.0.1' \nPORT = 21111\nBUFSIZ = 1024\nADDR = (HOST, PORT)\n\nudpCliSocket = socket(AF_INET, SOCK_DGRAM)\nwhile True:\n    data = input('> ')\n    if not data:\n        break\n\n    udpCliSocket.sendto(data.encode('utf-8'),ADDR)\n    if data == ' ':\n        break\n    data,ADDR = udpCliSocket.recvfrom(BUFSIZ)\n    if not data:\n        break\n    print(data.decode('utf-8'))\n\nudpCliSocket.close()\n```\n\n### 使用SocketServer\n+ Server\n\n```python\nfrom socketserver import (TCPServer as TCP, StreamRequestHandler as SRH)\nfrom time import ctime\n\n\nHOST = ''\nPORT = 21111\nBUFSIZ = 1024\nADDR = (HOST, PORT)\n\nclass MyRequestHandler(SRH):\n    def handle(self):\n        print(\"connected from..\", self.client_address)\n        send_str = '[%s] %s' %(bytes(ctime(), 'utf-8'), self.rfile.readline())\n        self.wfile.write(send_str.encode('utf-8'))\n\ntcpServ = TCP(ADDR, MyRequestHandler)\nprint(\"waiting for connection...\")\ntcpServ.serve_forever()\n        \n```\n\n+ Client\n不同之处：需要把建立和连接放在每次循环中\n\n```\nfrom socket import *\n\nHOST = '127.0.0.1' \nPORT = 21111\nBUFSIZ = 1024\nADDR = (HOST, PORT)\n\n\n\nwhile True:\n    tcpCliSocket = socket(AF_INET, SOCK_STREAM)\n    tcpCliSocket.connect(ADDR)\n    data = input('> ')\n    if not data:\n        break\n\n    send_data = \"%s\\n\" % data\n    tcpCliSocket.send(send_data.encode('utf-8'))\n    data = tcpCliSocket.recv(BUFSIZ)\n    if not data:\n        break\n    print(data.decode('utf-8'))\n    tcpCliSocket.close()\n\n```\n","source":"_posts/Python Core Programming Note 2.md","raw":"---\ntitle: Python Core Programming Note 2\ncategories:\n- Python笔记\ntags: \n- Python\n- Core Programming\n- Note\n---\n\n## Net Programming\n\n#### 1. TCP\n+ Server:\n\n```python\nfrom socket import *\nfrom time import ctime\n\nHOST = ''\nPORT = 21111\nBUFSIZ = 1024\nADDR = (HOST, PORT)\n\ntcpSerSocket = socket(AF_INET, SOCK_STREAM)\ntcpSerSocket.bind(ADDR)\ntcpSerSocket.listen(5)\n\ntry:\n    while True:\n        print(\"waiting for connection...\")\n        tcpCliSocket, addr = tcpSerSocket.accept()\n        print(\"connected from :\",addr)\n        while True:\n            data = tcpCliSocket.recv(BUFSIZ)\n            if not data:\n                break\n            print(\"rec:\",data)\n            send_str = '[%s] %s' %(bytes(ctime(), 'utf-8'), 'Oh?')\n            tcpCliSocket.send(send_str.encode('utf-8'))\n        tcpCliSocket.close()\nexcept EOFError:\n    print(\"Error: EOFEError\")\nexcept KeyboardInterrupt:\n    print(\"Error: EOFEError\")\nfinally:\n    tcpSerSocket.close()\n```\n\n+ Client\n\n```python\nfrom socket import *\n\nHOST = '127.0.0.1' \nPORT = 21111\nBUFSIZ = 1024\nADDR = (HOST, PORT)\n\ntcpCliSocket = socket(AF_INET, SOCK_STREAM)\ntcpCliSocket.connect(ADDR)\n\nwhile True:\n    data = input('> ')\n    if not data:\n        break\n\n    tcpCliSocket.send(data.encode('utf-8'))\n    data = tcpCliSocket.recv(BUFSIZ)\n    if not data:\n        break\n    print(data.decode('utf-8'))\n\ntcpCliSocket.close()\n\n```\n\n#### 2. UDP\n\n+ Server\n\n```python\nfrom socket import *\nfrom time import ctime\n\nHOST = ''\nPORT = 21111\nBUFSIZ = 1024\nADDR = (HOST, PORT)\n\nudpSerSocket = socket(AF_INET, SOCK_DGRAM)\nudpSerSocket.bind(ADDR)\n\ntry:\n    while True:\n        print(\"waiting for message...\")\n        msg, addr = udpSerSocket.recvfrom(BUFSIZ)\n        if msg.decode('utf-8') == ' ':\n            break\n        print('Rev client:',msg)\n        send_str = '[%s] %s' %(bytes(ctime(), 'utf-8'), msg)\n        udpSerSocket.sendto(send_str.encode('utf-8'),addr)\n        \nexcept EOFError:\n    print(\"Error: EOFEError\")\nexcept KeyboardInterrupt:\n    print(\"Error: EOFEError\")\nfinally:\n    udpSerSocket.close()\n```\n\n+ Client\n\n```python\nfrom socket import *\n\nHOST = '127.0.0.1' \nPORT = 21111\nBUFSIZ = 1024\nADDR = (HOST, PORT)\n\nudpCliSocket = socket(AF_INET, SOCK_DGRAM)\nwhile True:\n    data = input('> ')\n    if not data:\n        break\n\n    udpCliSocket.sendto(data.encode('utf-8'),ADDR)\n    if data == ' ':\n        break\n    data,ADDR = udpCliSocket.recvfrom(BUFSIZ)\n    if not data:\n        break\n    print(data.decode('utf-8'))\n\nudpCliSocket.close()\n```\n\n### 使用SocketServer\n+ Server\n\n```python\nfrom socketserver import (TCPServer as TCP, StreamRequestHandler as SRH)\nfrom time import ctime\n\n\nHOST = ''\nPORT = 21111\nBUFSIZ = 1024\nADDR = (HOST, PORT)\n\nclass MyRequestHandler(SRH):\n    def handle(self):\n        print(\"connected from..\", self.client_address)\n        send_str = '[%s] %s' %(bytes(ctime(), 'utf-8'), self.rfile.readline())\n        self.wfile.write(send_str.encode('utf-8'))\n\ntcpServ = TCP(ADDR, MyRequestHandler)\nprint(\"waiting for connection...\")\ntcpServ.serve_forever()\n        \n```\n\n+ Client\n不同之处：需要把建立和连接放在每次循环中\n\n```\nfrom socket import *\n\nHOST = '127.0.0.1' \nPORT = 21111\nBUFSIZ = 1024\nADDR = (HOST, PORT)\n\n\n\nwhile True:\n    tcpCliSocket = socket(AF_INET, SOCK_STREAM)\n    tcpCliSocket.connect(ADDR)\n    data = input('> ')\n    if not data:\n        break\n\n    send_data = \"%s\\n\" % data\n    tcpCliSocket.send(send_data.encode('utf-8'))\n    data = tcpCliSocket.recv(BUFSIZ)\n    if not data:\n        break\n    print(data.decode('utf-8'))\n    tcpCliSocket.close()\n\n```\n","slug":"Python Core Programming Note 2","published":1,"date":"2019-10-11T09:11:09.466Z","updated":"2019-10-11T10:10:22.421Z","_id":"ck1lykto40002ep114gfhie3f","comments":1,"layout":"post","photos":[],"link":"","content":"<h2 id=\"Net-Programming\"><a href=\"#Net-Programming\" class=\"headerlink\" title=\"Net Programming\"></a>Net Programming</h2><h4 id=\"1-TCP\"><a href=\"#1-TCP\" class=\"headerlink\" title=\"1. TCP\"></a>1. TCP</h4><ul>\n<li>Server:</li>\n</ul>\n<pre><code class=\"python\">from socket import *\nfrom time import ctime\n\nHOST = &#39;&#39;\nPORT = 21111\nBUFSIZ = 1024\nADDR = (HOST, PORT)\n\ntcpSerSocket = socket(AF_INET, SOCK_STREAM)\ntcpSerSocket.bind(ADDR)\ntcpSerSocket.listen(5)\n\ntry:\n    while True:\n        print(&quot;waiting for connection...&quot;)\n        tcpCliSocket, addr = tcpSerSocket.accept()\n        print(&quot;connected from :&quot;,addr)\n        while True:\n            data = tcpCliSocket.recv(BUFSIZ)\n            if not data:\n                break\n            print(&quot;rec:&quot;,data)\n            send_str = &#39;[%s] %s&#39; %(bytes(ctime(), &#39;utf-8&#39;), &#39;Oh?&#39;)\n            tcpCliSocket.send(send_str.encode(&#39;utf-8&#39;))\n        tcpCliSocket.close()\nexcept EOFError:\n    print(&quot;Error: EOFEError&quot;)\nexcept KeyboardInterrupt:\n    print(&quot;Error: EOFEError&quot;)\nfinally:\n    tcpSerSocket.close()</code></pre>\n<ul>\n<li>Client</li>\n</ul>\n<pre><code class=\"python\">from socket import *\n\nHOST = &#39;127.0.0.1&#39; \nPORT = 21111\nBUFSIZ = 1024\nADDR = (HOST, PORT)\n\ntcpCliSocket = socket(AF_INET, SOCK_STREAM)\ntcpCliSocket.connect(ADDR)\n\nwhile True:\n    data = input(&#39;&gt; &#39;)\n    if not data:\n        break\n\n    tcpCliSocket.send(data.encode(&#39;utf-8&#39;))\n    data = tcpCliSocket.recv(BUFSIZ)\n    if not data:\n        break\n    print(data.decode(&#39;utf-8&#39;))\n\ntcpCliSocket.close()\n</code></pre>\n<h4 id=\"2-UDP\"><a href=\"#2-UDP\" class=\"headerlink\" title=\"2. UDP\"></a>2. UDP</h4><ul>\n<li>Server</li>\n</ul>\n<pre><code class=\"python\">from socket import *\nfrom time import ctime\n\nHOST = &#39;&#39;\nPORT = 21111\nBUFSIZ = 1024\nADDR = (HOST, PORT)\n\nudpSerSocket = socket(AF_INET, SOCK_DGRAM)\nudpSerSocket.bind(ADDR)\n\ntry:\n    while True:\n        print(&quot;waiting for message...&quot;)\n        msg, addr = udpSerSocket.recvfrom(BUFSIZ)\n        if msg.decode(&#39;utf-8&#39;) == &#39; &#39;:\n            break\n        print(&#39;Rev client:&#39;,msg)\n        send_str = &#39;[%s] %s&#39; %(bytes(ctime(), &#39;utf-8&#39;), msg)\n        udpSerSocket.sendto(send_str.encode(&#39;utf-8&#39;),addr)\n\nexcept EOFError:\n    print(&quot;Error: EOFEError&quot;)\nexcept KeyboardInterrupt:\n    print(&quot;Error: EOFEError&quot;)\nfinally:\n    udpSerSocket.close()</code></pre>\n<ul>\n<li>Client</li>\n</ul>\n<pre><code class=\"python\">from socket import *\n\nHOST = &#39;127.0.0.1&#39; \nPORT = 21111\nBUFSIZ = 1024\nADDR = (HOST, PORT)\n\nudpCliSocket = socket(AF_INET, SOCK_DGRAM)\nwhile True:\n    data = input(&#39;&gt; &#39;)\n    if not data:\n        break\n\n    udpCliSocket.sendto(data.encode(&#39;utf-8&#39;),ADDR)\n    if data == &#39; &#39;:\n        break\n    data,ADDR = udpCliSocket.recvfrom(BUFSIZ)\n    if not data:\n        break\n    print(data.decode(&#39;utf-8&#39;))\n\nudpCliSocket.close()</code></pre>\n<h3 id=\"使用SocketServer\"><a href=\"#使用SocketServer\" class=\"headerlink\" title=\"使用SocketServer\"></a>使用SocketServer</h3><ul>\n<li>Server</li>\n</ul>\n<pre><code class=\"python\">from socketserver import (TCPServer as TCP, StreamRequestHandler as SRH)\nfrom time import ctime\n\n\nHOST = &#39;&#39;\nPORT = 21111\nBUFSIZ = 1024\nADDR = (HOST, PORT)\n\nclass MyRequestHandler(SRH):\n    def handle(self):\n        print(&quot;connected from..&quot;, self.client_address)\n        send_str = &#39;[%s] %s&#39; %(bytes(ctime(), &#39;utf-8&#39;), self.rfile.readline())\n        self.wfile.write(send_str.encode(&#39;utf-8&#39;))\n\ntcpServ = TCP(ADDR, MyRequestHandler)\nprint(&quot;waiting for connection...&quot;)\ntcpServ.serve_forever()\n</code></pre>\n<ul>\n<li>Client<br>不同之处：需要把建立和连接放在每次循环中</li>\n</ul>\n<pre><code>from socket import *\n\nHOST = &#39;127.0.0.1&#39; \nPORT = 21111\nBUFSIZ = 1024\nADDR = (HOST, PORT)\n\n\n\nwhile True:\n    tcpCliSocket = socket(AF_INET, SOCK_STREAM)\n    tcpCliSocket.connect(ADDR)\n    data = input(&#39;&gt; &#39;)\n    if not data:\n        break\n\n    send_data = &quot;%s\\n&quot; % data\n    tcpCliSocket.send(send_data.encode(&#39;utf-8&#39;))\n    data = tcpCliSocket.recv(BUFSIZ)\n    if not data:\n        break\n    print(data.decode(&#39;utf-8&#39;))\n    tcpCliSocket.close()\n</code></pre>","site":{"data":{}},"excerpt":"","more":"<h2 id=\"Net-Programming\"><a href=\"#Net-Programming\" class=\"headerlink\" title=\"Net Programming\"></a>Net Programming</h2><h4 id=\"1-TCP\"><a href=\"#1-TCP\" class=\"headerlink\" title=\"1. TCP\"></a>1. TCP</h4><ul>\n<li>Server:</li>\n</ul>\n<pre><code class=\"python\">from socket import *\nfrom time import ctime\n\nHOST = &#39;&#39;\nPORT = 21111\nBUFSIZ = 1024\nADDR = (HOST, PORT)\n\ntcpSerSocket = socket(AF_INET, SOCK_STREAM)\ntcpSerSocket.bind(ADDR)\ntcpSerSocket.listen(5)\n\ntry:\n    while True:\n        print(&quot;waiting for connection...&quot;)\n        tcpCliSocket, addr = tcpSerSocket.accept()\n        print(&quot;connected from :&quot;,addr)\n        while True:\n            data = tcpCliSocket.recv(BUFSIZ)\n            if not data:\n                break\n            print(&quot;rec:&quot;,data)\n            send_str = &#39;[%s] %s&#39; %(bytes(ctime(), &#39;utf-8&#39;), &#39;Oh?&#39;)\n            tcpCliSocket.send(send_str.encode(&#39;utf-8&#39;))\n        tcpCliSocket.close()\nexcept EOFError:\n    print(&quot;Error: EOFEError&quot;)\nexcept KeyboardInterrupt:\n    print(&quot;Error: EOFEError&quot;)\nfinally:\n    tcpSerSocket.close()</code></pre>\n<ul>\n<li>Client</li>\n</ul>\n<pre><code class=\"python\">from socket import *\n\nHOST = &#39;127.0.0.1&#39; \nPORT = 21111\nBUFSIZ = 1024\nADDR = (HOST, PORT)\n\ntcpCliSocket = socket(AF_INET, SOCK_STREAM)\ntcpCliSocket.connect(ADDR)\n\nwhile True:\n    data = input(&#39;&gt; &#39;)\n    if not data:\n        break\n\n    tcpCliSocket.send(data.encode(&#39;utf-8&#39;))\n    data = tcpCliSocket.recv(BUFSIZ)\n    if not data:\n        break\n    print(data.decode(&#39;utf-8&#39;))\n\ntcpCliSocket.close()\n</code></pre>\n<h4 id=\"2-UDP\"><a href=\"#2-UDP\" class=\"headerlink\" title=\"2. UDP\"></a>2. UDP</h4><ul>\n<li>Server</li>\n</ul>\n<pre><code class=\"python\">from socket import *\nfrom time import ctime\n\nHOST = &#39;&#39;\nPORT = 21111\nBUFSIZ = 1024\nADDR = (HOST, PORT)\n\nudpSerSocket = socket(AF_INET, SOCK_DGRAM)\nudpSerSocket.bind(ADDR)\n\ntry:\n    while True:\n        print(&quot;waiting for message...&quot;)\n        msg, addr = udpSerSocket.recvfrom(BUFSIZ)\n        if msg.decode(&#39;utf-8&#39;) == &#39; &#39;:\n            break\n        print(&#39;Rev client:&#39;,msg)\n        send_str = &#39;[%s] %s&#39; %(bytes(ctime(), &#39;utf-8&#39;), msg)\n        udpSerSocket.sendto(send_str.encode(&#39;utf-8&#39;),addr)\n\nexcept EOFError:\n    print(&quot;Error: EOFEError&quot;)\nexcept KeyboardInterrupt:\n    print(&quot;Error: EOFEError&quot;)\nfinally:\n    udpSerSocket.close()</code></pre>\n<ul>\n<li>Client</li>\n</ul>\n<pre><code class=\"python\">from socket import *\n\nHOST = &#39;127.0.0.1&#39; \nPORT = 21111\nBUFSIZ = 1024\nADDR = (HOST, PORT)\n\nudpCliSocket = socket(AF_INET, SOCK_DGRAM)\nwhile True:\n    data = input(&#39;&gt; &#39;)\n    if not data:\n        break\n\n    udpCliSocket.sendto(data.encode(&#39;utf-8&#39;),ADDR)\n    if data == &#39; &#39;:\n        break\n    data,ADDR = udpCliSocket.recvfrom(BUFSIZ)\n    if not data:\n        break\n    print(data.decode(&#39;utf-8&#39;))\n\nudpCliSocket.close()</code></pre>\n<h3 id=\"使用SocketServer\"><a href=\"#使用SocketServer\" class=\"headerlink\" title=\"使用SocketServer\"></a>使用SocketServer</h3><ul>\n<li>Server</li>\n</ul>\n<pre><code class=\"python\">from socketserver import (TCPServer as TCP, StreamRequestHandler as SRH)\nfrom time import ctime\n\n\nHOST = &#39;&#39;\nPORT = 21111\nBUFSIZ = 1024\nADDR = (HOST, PORT)\n\nclass MyRequestHandler(SRH):\n    def handle(self):\n        print(&quot;connected from..&quot;, self.client_address)\n        send_str = &#39;[%s] %s&#39; %(bytes(ctime(), &#39;utf-8&#39;), self.rfile.readline())\n        self.wfile.write(send_str.encode(&#39;utf-8&#39;))\n\ntcpServ = TCP(ADDR, MyRequestHandler)\nprint(&quot;waiting for connection...&quot;)\ntcpServ.serve_forever()\n</code></pre>\n<ul>\n<li>Client<br>不同之处：需要把建立和连接放在每次循环中</li>\n</ul>\n<pre><code>from socket import *\n\nHOST = &#39;127.0.0.1&#39; \nPORT = 21111\nBUFSIZ = 1024\nADDR = (HOST, PORT)\n\n\n\nwhile True:\n    tcpCliSocket = socket(AF_INET, SOCK_STREAM)\n    tcpCliSocket.connect(ADDR)\n    data = input(&#39;&gt; &#39;)\n    if not data:\n        break\n\n    send_data = &quot;%s\\n&quot; % data\n    tcpCliSocket.send(send_data.encode(&#39;utf-8&#39;))\n    data = tcpCliSocket.recv(BUFSIZ)\n    if not data:\n        break\n    print(data.decode(&#39;utf-8&#39;))\n    tcpCliSocket.close()\n</code></pre>"},{"title":"Python Note 3","_content":"# Python Note 3\n\n### Classes\n> Use Pacal naming convertion,not like variables/function use lower cases and underscore connection.\n> Basic usage:\n\n```python\nclass Point:\n\tdef draw(self):\n\t\tprint(\"draw\")\n\n\tdef print(self):\n\t\tprint(\"this is point\")\n\n\npoint1 = Point()\npoint1.x = 5\npoint1.draw()\nprint(point1.x)\n```\n\n### Constructor\n\n```python\nclass Point:\n\tdef __init__(self, x, y):\n\t\tself.x = x\n\t\tself.y = y\n\n\tdef draw(self):\n\t\tprint(\"draw\")\n\n\tdef print(self):\n\t\tprint(\"this is point\")\n\n\npoint1 = Point(10, 5)\npoint1.draw()\nprint(point1.x)\n\n#exercise\nclass Person:\n\tdef __init__(self, name):\n\t\tself.name = name\n\n\tdef talk(self):\n\t\tprint(f\"{self.name} is talking..\")\n\n\nwhile True:\n\tperson_name = str(input(\"Please enter person: \"))\n\tif person_name == \"Quit\":\n\t\tbreak\n\telif person_name != \"\":\n\t\tnew_person = Person(person_name)\n\t\tnew_person.talk()\n\telse:\n\t\tprint(\"You enter a empty!\")\n\n```\n\n### inheritance\n> use bracket to inherit parent class\n\n```python\nclass Mammal:\n\tdef walk(self):\n\t\tprint(\"walk\")\n\n\nclass Dog(Mammal):\n\tdef bark(self):\n\t\tprint(\"bark\")\n\n\nclass Cat(Mammal):\n\tpass  # tell python to pass this line\n\n\ndog1 = Dog()\ndog1.walk()\ndog1.bark()\n\n```\n\n### module\n> each file refer a module\n\n```python\nimport converters #to import converters.py\nfrom converters import kg_to_lbs\n\n#exercise\nimport  convertors\nfrom convertors import weight_to_lbs\n\nprint(weight_to_lbs())\nnumbers = [5,1,8,2]\nmaximum = convertors.find_max(numbers)\nprint(max(numbers))\n```\n\n### package\n> a set of modules: directory with \"__init__.py\" file\n\n```python\nfrom ecommerce.shopping import test\nfrom ecommerce import shopping\ntest()\nshopping.test()\n```\n\n### use python build-in module\n> search [python module index](https://docs.python.org/3/py-modindex.html)\n> PEP: python enhancement proposal\n\n```python\nimport  random\nmembers = [\"Jack\", \"Rose\", \"Bob\", \"Avery\", \"Mosh\"]\nm = random.choice(members)\nprint(m)\n\n#exercise\nimport random\nclass Dice: #will get PEP 8 warning\n    def roll(self):\n        r1 = random.randint(0, 5)\n        r2 = random.randint(0, 5)\n        return r1,r2  #Python will auto make it to Tuple\n\n\n\nmydice = Dice()\nprint(mydice.roll())\n```\n\n```python\nfrom pathlib import Path\n\npath = Path(\"pydemo2/ecommerce\")\nfor p in path.glob(\"*.py\"):\n    print(p)\n\n```\n\n","source":"_posts/Python_3.md","raw":"---\ntitle: Python Note 3\ncategories:\n- Python笔记\ntags: \n- Python\n- Note\n---\n# Python Note 3\n\n### Classes\n> Use Pacal naming convertion,not like variables/function use lower cases and underscore connection.\n> Basic usage:\n\n```python\nclass Point:\n\tdef draw(self):\n\t\tprint(\"draw\")\n\n\tdef print(self):\n\t\tprint(\"this is point\")\n\n\npoint1 = Point()\npoint1.x = 5\npoint1.draw()\nprint(point1.x)\n```\n\n### Constructor\n\n```python\nclass Point:\n\tdef __init__(self, x, y):\n\t\tself.x = x\n\t\tself.y = y\n\n\tdef draw(self):\n\t\tprint(\"draw\")\n\n\tdef print(self):\n\t\tprint(\"this is point\")\n\n\npoint1 = Point(10, 5)\npoint1.draw()\nprint(point1.x)\n\n#exercise\nclass Person:\n\tdef __init__(self, name):\n\t\tself.name = name\n\n\tdef talk(self):\n\t\tprint(f\"{self.name} is talking..\")\n\n\nwhile True:\n\tperson_name = str(input(\"Please enter person: \"))\n\tif person_name == \"Quit\":\n\t\tbreak\n\telif person_name != \"\":\n\t\tnew_person = Person(person_name)\n\t\tnew_person.talk()\n\telse:\n\t\tprint(\"You enter a empty!\")\n\n```\n\n### inheritance\n> use bracket to inherit parent class\n\n```python\nclass Mammal:\n\tdef walk(self):\n\t\tprint(\"walk\")\n\n\nclass Dog(Mammal):\n\tdef bark(self):\n\t\tprint(\"bark\")\n\n\nclass Cat(Mammal):\n\tpass  # tell python to pass this line\n\n\ndog1 = Dog()\ndog1.walk()\ndog1.bark()\n\n```\n\n### module\n> each file refer a module\n\n```python\nimport converters #to import converters.py\nfrom converters import kg_to_lbs\n\n#exercise\nimport  convertors\nfrom convertors import weight_to_lbs\n\nprint(weight_to_lbs())\nnumbers = [5,1,8,2]\nmaximum = convertors.find_max(numbers)\nprint(max(numbers))\n```\n\n### package\n> a set of modules: directory with \"__init__.py\" file\n\n```python\nfrom ecommerce.shopping import test\nfrom ecommerce import shopping\ntest()\nshopping.test()\n```\n\n### use python build-in module\n> search [python module index](https://docs.python.org/3/py-modindex.html)\n> PEP: python enhancement proposal\n\n```python\nimport  random\nmembers = [\"Jack\", \"Rose\", \"Bob\", \"Avery\", \"Mosh\"]\nm = random.choice(members)\nprint(m)\n\n#exercise\nimport random\nclass Dice: #will get PEP 8 warning\n    def roll(self):\n        r1 = random.randint(0, 5)\n        r2 = random.randint(0, 5)\n        return r1,r2  #Python will auto make it to Tuple\n\n\n\nmydice = Dice()\nprint(mydice.roll())\n```\n\n```python\nfrom pathlib import Path\n\npath = Path(\"pydemo2/ecommerce\")\nfor p in path.glob(\"*.py\"):\n    print(p)\n\n```\n\n","slug":"Python_3","published":1,"date":"2019-10-11T10:25:57.893Z","updated":"2019-10-11T10:25:57.893Z","_id":"ck1lykto80005ep11soee0bwq","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"Python-Note-3\"><a href=\"#Python-Note-3\" class=\"headerlink\" title=\"Python Note 3\"></a>Python Note 3</h1><h3 id=\"Classes\"><a href=\"#Classes\" class=\"headerlink\" title=\"Classes\"></a>Classes</h3><blockquote>\n<p>Use Pacal naming convertion,not like variables/function use lower cases and underscore connection.<br>Basic usage:</p>\n</blockquote>\n<pre><code class=\"python\">class Point:\n    def draw(self):\n        print(&quot;draw&quot;)\n\n    def print(self):\n        print(&quot;this is point&quot;)\n\n\npoint1 = Point()\npoint1.x = 5\npoint1.draw()\nprint(point1.x)</code></pre>\n<h3 id=\"Constructor\"><a href=\"#Constructor\" class=\"headerlink\" title=\"Constructor\"></a>Constructor</h3><pre><code class=\"python\">class Point:\n    def __init__(self, x, y):\n        self.x = x\n        self.y = y\n\n    def draw(self):\n        print(&quot;draw&quot;)\n\n    def print(self):\n        print(&quot;this is point&quot;)\n\n\npoint1 = Point(10, 5)\npoint1.draw()\nprint(point1.x)\n\n#exercise\nclass Person:\n    def __init__(self, name):\n        self.name = name\n\n    def talk(self):\n        print(f&quot;{self.name} is talking..&quot;)\n\n\nwhile True:\n    person_name = str(input(&quot;Please enter person: &quot;))\n    if person_name == &quot;Quit&quot;:\n        break\n    elif person_name != &quot;&quot;:\n        new_person = Person(person_name)\n        new_person.talk()\n    else:\n        print(&quot;You enter a empty!&quot;)\n</code></pre>\n<h3 id=\"inheritance\"><a href=\"#inheritance\" class=\"headerlink\" title=\"inheritance\"></a>inheritance</h3><blockquote>\n<p>use bracket to inherit parent class</p>\n</blockquote>\n<pre><code class=\"python\">class Mammal:\n    def walk(self):\n        print(&quot;walk&quot;)\n\n\nclass Dog(Mammal):\n    def bark(self):\n        print(&quot;bark&quot;)\n\n\nclass Cat(Mammal):\n    pass  # tell python to pass this line\n\n\ndog1 = Dog()\ndog1.walk()\ndog1.bark()\n</code></pre>\n<h3 id=\"module\"><a href=\"#module\" class=\"headerlink\" title=\"module\"></a>module</h3><blockquote>\n<p>each file refer a module</p>\n</blockquote>\n<pre><code class=\"python\">import converters #to import converters.py\nfrom converters import kg_to_lbs\n\n#exercise\nimport  convertors\nfrom convertors import weight_to_lbs\n\nprint(weight_to_lbs())\nnumbers = [5,1,8,2]\nmaximum = convertors.find_max(numbers)\nprint(max(numbers))</code></pre>\n<h3 id=\"package\"><a href=\"#package\" class=\"headerlink\" title=\"package\"></a>package</h3><blockquote>\n<p>a set of modules: directory with “<strong>init</strong>.py” file</p>\n</blockquote>\n<pre><code class=\"python\">from ecommerce.shopping import test\nfrom ecommerce import shopping\ntest()\nshopping.test()</code></pre>\n<h3 id=\"use-python-build-in-module\"><a href=\"#use-python-build-in-module\" class=\"headerlink\" title=\"use python build-in module\"></a>use python build-in module</h3><blockquote>\n<p>search <a href=\"https://docs.python.org/3/py-modindex.html\" target=\"_blank\" rel=\"noopener\">python module index</a><br>PEP: python enhancement proposal</p>\n</blockquote>\n<pre><code class=\"python\">import  random\nmembers = [&quot;Jack&quot;, &quot;Rose&quot;, &quot;Bob&quot;, &quot;Avery&quot;, &quot;Mosh&quot;]\nm = random.choice(members)\nprint(m)\n\n#exercise\nimport random\nclass Dice: #will get PEP 8 warning\n    def roll(self):\n        r1 = random.randint(0, 5)\n        r2 = random.randint(0, 5)\n        return r1,r2  #Python will auto make it to Tuple\n\n\n\nmydice = Dice()\nprint(mydice.roll())</code></pre>\n<pre><code class=\"python\">from pathlib import Path\n\npath = Path(&quot;pydemo2/ecommerce&quot;)\nfor p in path.glob(&quot;*.py&quot;):\n    print(p)\n</code></pre>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Python-Note-3\"><a href=\"#Python-Note-3\" class=\"headerlink\" title=\"Python Note 3\"></a>Python Note 3</h1><h3 id=\"Classes\"><a href=\"#Classes\" class=\"headerlink\" title=\"Classes\"></a>Classes</h3><blockquote>\n<p>Use Pacal naming convertion,not like variables/function use lower cases and underscore connection.<br>Basic usage:</p>\n</blockquote>\n<pre><code class=\"python\">class Point:\n    def draw(self):\n        print(&quot;draw&quot;)\n\n    def print(self):\n        print(&quot;this is point&quot;)\n\n\npoint1 = Point()\npoint1.x = 5\npoint1.draw()\nprint(point1.x)</code></pre>\n<h3 id=\"Constructor\"><a href=\"#Constructor\" class=\"headerlink\" title=\"Constructor\"></a>Constructor</h3><pre><code class=\"python\">class Point:\n    def __init__(self, x, y):\n        self.x = x\n        self.y = y\n\n    def draw(self):\n        print(&quot;draw&quot;)\n\n    def print(self):\n        print(&quot;this is point&quot;)\n\n\npoint1 = Point(10, 5)\npoint1.draw()\nprint(point1.x)\n\n#exercise\nclass Person:\n    def __init__(self, name):\n        self.name = name\n\n    def talk(self):\n        print(f&quot;{self.name} is talking..&quot;)\n\n\nwhile True:\n    person_name = str(input(&quot;Please enter person: &quot;))\n    if person_name == &quot;Quit&quot;:\n        break\n    elif person_name != &quot;&quot;:\n        new_person = Person(person_name)\n        new_person.talk()\n    else:\n        print(&quot;You enter a empty!&quot;)\n</code></pre>\n<h3 id=\"inheritance\"><a href=\"#inheritance\" class=\"headerlink\" title=\"inheritance\"></a>inheritance</h3><blockquote>\n<p>use bracket to inherit parent class</p>\n</blockquote>\n<pre><code class=\"python\">class Mammal:\n    def walk(self):\n        print(&quot;walk&quot;)\n\n\nclass Dog(Mammal):\n    def bark(self):\n        print(&quot;bark&quot;)\n\n\nclass Cat(Mammal):\n    pass  # tell python to pass this line\n\n\ndog1 = Dog()\ndog1.walk()\ndog1.bark()\n</code></pre>\n<h3 id=\"module\"><a href=\"#module\" class=\"headerlink\" title=\"module\"></a>module</h3><blockquote>\n<p>each file refer a module</p>\n</blockquote>\n<pre><code class=\"python\">import converters #to import converters.py\nfrom converters import kg_to_lbs\n\n#exercise\nimport  convertors\nfrom convertors import weight_to_lbs\n\nprint(weight_to_lbs())\nnumbers = [5,1,8,2]\nmaximum = convertors.find_max(numbers)\nprint(max(numbers))</code></pre>\n<h3 id=\"package\"><a href=\"#package\" class=\"headerlink\" title=\"package\"></a>package</h3><blockquote>\n<p>a set of modules: directory with “<strong>init</strong>.py” file</p>\n</blockquote>\n<pre><code class=\"python\">from ecommerce.shopping import test\nfrom ecommerce import shopping\ntest()\nshopping.test()</code></pre>\n<h3 id=\"use-python-build-in-module\"><a href=\"#use-python-build-in-module\" class=\"headerlink\" title=\"use python build-in module\"></a>use python build-in module</h3><blockquote>\n<p>search <a href=\"https://docs.python.org/3/py-modindex.html\" target=\"_blank\" rel=\"noopener\">python module index</a><br>PEP: python enhancement proposal</p>\n</blockquote>\n<pre><code class=\"python\">import  random\nmembers = [&quot;Jack&quot;, &quot;Rose&quot;, &quot;Bob&quot;, &quot;Avery&quot;, &quot;Mosh&quot;]\nm = random.choice(members)\nprint(m)\n\n#exercise\nimport random\nclass Dice: #will get PEP 8 warning\n    def roll(self):\n        r1 = random.randint(0, 5)\n        r2 = random.randint(0, 5)\n        return r1,r2  #Python will auto make it to Tuple\n\n\n\nmydice = Dice()\nprint(mydice.roll())</code></pre>\n<pre><code class=\"python\">from pathlib import Path\n\npath = Path(&quot;pydemo2/ecommerce&quot;)\nfor p in path.glob(&quot;*.py&quot;):\n    print(p)\n</code></pre>\n"},{"title":"Hello World","_content":"Welcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/deployment.html)\n","source":"_posts/hello-world.md","raw":"---\ntitle: Hello World\n---\nWelcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/deployment.html)\n","slug":"hello-world","published":1,"date":"2019-10-05T09:16:15.524Z","updated":"2019-10-05T09:16:15.524Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck1lyktoa0006ep116az1ifl6","content":"<p>Welcome to <a href=\"https://hexo.io/\" target=\"_blank\" rel=\"noopener\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\" target=\"_blank\" rel=\"noopener\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\" target=\"_blank\" rel=\"noopener\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\" target=\"_blank\" rel=\"noopener\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><pre><code class=\"bash\">$ hexo new &quot;My New Post&quot;</code></pre>\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\" target=\"_blank\" rel=\"noopener\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><pre><code class=\"bash\">$ hexo server</code></pre>\n<p>More info: <a href=\"https://hexo.io/docs/server.html\" target=\"_blank\" rel=\"noopener\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><pre><code class=\"bash\">$ hexo generate</code></pre>\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\" target=\"_blank\" rel=\"noopener\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><pre><code class=\"bash\">$ hexo deploy</code></pre>\n<p>More info: <a href=\"https://hexo.io/docs/deployment.html\" target=\"_blank\" rel=\"noopener\">Deployment</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>Welcome to <a href=\"https://hexo.io/\" target=\"_blank\" rel=\"noopener\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\" target=\"_blank\" rel=\"noopener\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\" target=\"_blank\" rel=\"noopener\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\" target=\"_blank\" rel=\"noopener\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><pre><code class=\"bash\">$ hexo new &quot;My New Post&quot;</code></pre>\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\" target=\"_blank\" rel=\"noopener\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><pre><code class=\"bash\">$ hexo server</code></pre>\n<p>More info: <a href=\"https://hexo.io/docs/server.html\" target=\"_blank\" rel=\"noopener\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><pre><code class=\"bash\">$ hexo generate</code></pre>\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\" target=\"_blank\" rel=\"noopener\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><pre><code class=\"bash\">$ hexo deploy</code></pre>\n<p>More info: <a href=\"https://hexo.io/docs/deployment.html\" target=\"_blank\" rel=\"noopener\">Deployment</a></p>\n"},{"title":"Twisted  介绍","_content":"\n## Twisted\n\n\n### Python Twisted介绍\nTwisted是用Python实现的基于事件驱动的网络引擎框架。Twisted诞生于2000年初，在当时的网络游戏开发者看来，无论他们使用哪种语言，手中都鲜有可兼顾扩展性及跨平台的网络库。Twisted的作者试图在当时现有的环境下开发游戏，这一步走的非常艰难，他们迫切地需要一个可扩展性高、基于事件驱动、跨平台的网络开发框架，为此他们决定自己实现一个，并从那些之前的游戏和网络应用程序的开发者中学习，汲取他们的经验教训。\n\nTwisted支持许多常见的传输及应用层协议，包括TCP、UDP、SSL/TLS、HTTP、IMAP、SSH、IRC以及FTP。就像python一样，Twisted也具有“内置电池”（batteries-included）的特点。Twisted对于其支持的所有协议都带有客户端和服务器实现，同时附带有基于命令行的工具，使得配置和部署产品级的Twisted应用变得非常方便。\n\n### 为什么需要Twisted\n2000年时，Twisted的作者Glyph正在开发一个名为Twisted Reality的基于文本方式的多人在线游戏。这个游戏采用Java开发，里面尽是一堆线程——每个连接就有3个线程处理。处理输入的线程会在读操作上阻塞，处理输出的线程将在一些写操作上阻塞，还有一个“逻辑”线程将在等待定时器超时或者事件入队列时休眠。随着玩家们在虚拟世界中移动并交互时，线程出现死锁，缓存被污染，程序中的加锁逻辑几乎从来就没对过——采用多线程使得整个软件变得复杂、漏洞百出而且极难扩展。\n\n为了寻求其他的解决方案，作者发现了Python，特别是Python中用于对流式对象比如socket和pipe进行多路I/O复用的select模块（UNIX规范第3版（SUSv3）描述了select）。那时，Java并没有提供操作系统的select接口或者任何其他的异步I/O API（针对非阻塞式I/O的包java.nio已经在J2SE 1.4中加入了，2002年发布）。通过用Python中的select模块快速搭建起游戏的原型，这迅速降低了程序的复杂度，并且比多线程版本要更加可靠。\n\nGlyph迅速转向了Python、select以及基于事件驱动的编程。他使用Python的select模块为游戏编写了客户端和服务器。但他想要的还不止于此。从根本上说，他希望能将网络行为转变为对游戏中的对象的方法调用。如果你能在游戏中收取邮件会怎样，就像Nethack mailer这种守护进程一样？如果游戏中的每位玩家都拥有一个主页呢？Glyph发现他需要优秀的IMAP以及HTTP客户端和服务器的Python实现，而这些都要采用select。\n\n他首先转向了Medusa，这是一个在90年代中期开发的平台，在这里可以采用Python中的asyncore模块来编写网络服务。asyncore是一个异步化处理socket的模块，在操作系统的select API之上构建了一个调度器和回调接口。\n\n这对于Glyph来说是个激动人心的发现，但Medusa有两个缺点：\n1. 这个项目到2001年就不再维护了，那正是glyph开发Twisted Reality的时候。\n2. asyncore只是对socket的一个薄封装层，应用程序的编写者仍然需要直接操作socket。这意味着程序可移植性的担子仍然落在程序员自己身上。此外，那时asyncore对Windows的支持还有问题，Glyph希望能在Windows上运行一个带有图形用户界面的客户端。\nGlyph需要自己实现一个网络引擎平台，而且他意识到Twisted Reality已经打开了问题的大门，这和他的游戏一样有趣。\n\n随着时间的推移，Twisted Reality这个游戏就演化成了Twisted网络引擎平台。它可以做到当时Python中已有的网络平台所无法做到的事情：\n+ 使用基于事件驱动的编程模型，而不是多线程模型。\n+ 跨平台：为主流操作系统平台暴露出的事件通知系统提供统一的接口。\n+ “内置电池”的能力：提供流行的应用层协议实现，因此Twisted马上就可为开发人员所用。\n+ 符合RFC规范，已经通过健壮的测试套件证明了其一致性。\n+ 能很容易的配合多个网络协议一起使用。\n+ 可扩展。\n\n### Twisted架构概览\nTwisted是一个事件驱动型的网络引擎。由于事件驱动编程模型在Twisted的设计哲学中占有重要的地位，因此这里有必要花点时间来回顾一下究竟事件驱动意味着什么。\n\n事件驱动编程是一种编程范式，这里程序的执行流由外部事件来决定。它的特点是包含一个事件循环，当外部事件发生时使用回调机制来触发相应的处理。另外两种常见的编程范式是（单线程）同步以及多线程编程。\n\n在单线程同步模型中，任务按照顺序执行。如果某个任务因为I/O而阻塞，其他所有的任务都必须等待，直到它完成之后它们才能依次执行。这种明确的执行顺序和串行化处理的行为是很容易推断得出的。如果任务之间并没有互相依赖的关系，但仍然需要互相等待的话这就使得程序不必要的降低了运行速度。\n\n在多线程版本中，这3个任务分别在独立的线程中执行。这些线程由操作系统来管理，在多处理器系统上可以并行处理，或者在单处理器系统上交错执行。这使得当某个线程阻塞在某个资源的同时其他线程得以继续执行。与完成类似功能的同步程序相比，这种方式更有效率，但程序员必须写代码来保护共享资源，防止其被多个线程同时访问。多线程程序更加难以推断，因为这类程序不得不通过线程同步机制如锁、可重入函数、线程局部存储或者其他机制来处理线程安全问题，如果实现不当就会导致出现微妙且令人痛不欲生的bug。\n\n在事件驱动版本的程序中，3个任务**交错执行**，但仍然在一个单独的线程控制中。当处理I/O或者其他昂贵的操作时，注册一个回调到事件循环中，然后当I/O操作完成时继续执行。回调描述了该如何处理某个事件。事件循环轮询所有的事件，当事件到来时将它们分配给等待处理事件的回调函数。这种方式让程序尽可能的得以执行而不需要用到额外的线程。事件驱动型程序比多线程程序更容易推断出行为，因为程序员不需要关心线程安全问题。\n\n当我们面对如下的环境时，事件驱动模型通常是一个好的选择：\n\n程序中有许多任务，而且…\n1. 任务之间高度独立（因此它们不需要互相通信，或者等待彼此）而且…\n2. 在等待事件到来时，某些任务会阻塞。\n3. 当应用程序需要在任务间共享可变的数据时，这也是一个不错的选择，因为这里不需要采用同步处理。\n\n网络应用程序通常都有上述这些特点，这使得它们能够很好的契合事件驱动编程模型。\n\n###### **重用已有的应用**\n在Twisted创建之前就已经有了许多针对多种流行的网络协议的客户端和服务器实现了。为什么Glyph不直接用Apache、IRCd、BIND、OpenSSH或者任何其他已有的应用，而要为Twisted从头开始重新实现各个协议的客户端和服务器呢？\n\n问题在于所有这些已有的实现都存在有从头写起的网络层代码，通常都是C代码。而应用层代码直接同网络层耦合在一起，这使得它们非常难以以库的形式来复用。当要一起使用这些组件时，如果希望在多个协议中暴露相同的数据，则它们必须以黑盒的形式来看待，这使得开发者根本没机会重用代码。此外，服务器和客户端的实现通常是分离的，彼此之间不共享代码。要扩展这些应用，维护跨平台的客户端-服务器兼容性的难度本不至于这么大。\n\nTwisted中的客户端和服务器是用Python开发的，采用了一致性的接口。这使得开发新的客户端和服务器变得很容易实现，可以在客户端和服务器之间共享代码，在协议之间共享应用逻辑，以及对某个实现的代码做测试。\n\n###### **React模式**\nTwisted实现了设计模式中的反应堆（reactor）模式，这种模式在单线程环境中调度多个事件源产生的事件到它们各自的事件处理例程中去。\n\nTwisted的核心就是reactor事件循环。Reactor可以感知网络、文件系统以及定时器事件。它等待然后处理这些事件，从特定于平台的行为中抽象出来，并提供统一的接口，使得在网络协议栈的任何位置对事件做出响应都变得简单。\n\n基本上reactor完成的任务就是：\n\n```python\nwhile True:\n    timeout = time_until_next_timed_event()\n    events = wait_for_events(timeout)\n    events += timed_events_until(now())\n    for event in events:\n        event.process()\n```\n\nTwisted目前在所有平台上的默认reactor都是基于poll API的（UNIX规范第3版（SUSv3）中描述）。此外，Twisted还支持一些特定于平台的高容量多路复用API。这些reactor包括基于FreeBSD中kqueue机制的KQueue reactor，支持epoll接口的系统（目前是Linux 2.6）中的epoll reactor，以及基于Windows下的输入输出完成端口的IOCP reactor。\n\n在实现轮询的相关细节中，Twisted需要考虑的包括：\n\n+ 网络和文件系统的限制\n+ 缓冲行为\n+ 如何检测连接丢失\n+ 出现错误时的返回值\n\nTwisted的reactor实现同时也考虑了正确使用底层的非阻塞式API，并正确处理各种边界情况。由于Python中没有暴露出IOCP API，因此Twisted需要维护自己的实现。\n\n###### **管理回调链**\n\n回调是事件驱动编程模型中的基础，也是reactor通知应用程序事件已经处理完成的方式。随着程序规模不断扩大，基于事件驱动的程序需要同时处理事件处理成功和出错的情况，这使得程序变得越来越复杂。若没有注册一个合适的回调，程序就会阻塞，因为这个事件处理的过程绝不会发生。出现错误时需要通过应用程序的不同层次从网络栈向上传递回调链。\n\n下面是两段Python伪码，分别是同步和异步模式下获取URL的玩具代码。让我们相互比较一下这两个版本，看看基于事件驱动的程序有什么缺陷：\n\n以同步的方式获取URL：\n\n```python\nimport getPage\n\ndef processPage(page):\n    print page\n\ndef logError(error):\n    print error\n\ndef finishProcessing(value):\n    print \"Shutting down...\"\n    exit(0)\n\nurl = \"http://google.com\"\ntry:\n    page = getPage(url)\n    processPage(page)\nexcept Error, e:\n    logError(error)\nfinally:\n    finishProcessing()\n```\n以异步的方式获取URL：\n\n```python\nfrom twisted.internet import reactor\nimport getPage\n\ndef processPage(page):\n    print page\n    finishProcessing()\n\ndef logError(error):\n    print error\n    finishProcessing()\n\ndef finishProcessing(value):\n    print \"Shutting down...\"\n    reactor.stop()\n\nurl = \"http://google.com\"\n# getPage takes: url, \n# success callback, error callback\ngetPage(url, processPage, logError)\n\nreactor.run()\n```\n\n在异步版的URL获取器中，reactor.run()启动reactor事件循环。在同步和异步版程序中，我们假定getPage函数处理获取页面的工作。如果获取成功就调用processPage，如果尝试获取页面时出现了Exception（异常），logError就得到调用。无论哪种情况，最后都要调用finishProcessing。\n\n异步版中的logError回调正对应于同步版中的try/except块。对processPage的回调对应于else块，无条件回调的finishProcessing就对应于finally块。\n\n在同步版中，代码结构直接显示出有一个try/except块，logError和processPage这两者间只会取其一调用一次，而finishProcessing总是会被调用一次。在异步版中需要由程序员自己负责正确调用成功和失败情况下的回调链。如果由于编程错误，在processPage或者logError的回调链之后没有调用finishProcessing，reactor事件循环将永远不会停止，程序就会卡住。\n\n这个玩具式的例子告诉我们在开发Twisted的头几年里这种复杂性令程序员感到非常沮丧。而Twisted应对这种复杂性的方式是新增一个称为Deferred（延迟）的对象。\n\n###### Deferreds\nDeferred对象以抽象化的方式表达了一种思想，即结果还尚不存在。它同样能够帮助管理产生这个结果所需要的回调链。当从函数中返回时，Deferred对象承诺在某个时刻函数将产生一个结果。返回的Deferred对象中包含所有注册到事件上的回调引用，因此在函数间只需要传递这一个对象即可，跟踪这个对象比单独管理所有的回调要简单的多。\n\nDeferred对象包含一对回调链，一个是针对操作成功的回调，一个是针对操作失败的回调。初始状态下Deferred对象的两条链都为空。在事件处理的过程中，每个阶段都为其添加处理成功的回调和处理失败的回调。当一个异步结果到来时，Deferred对象就被“激活”，那么处理成功的回调和处理失败的回调就可以以合适的方式按照它们添加进来的顺序依次得到调用。\n\n异步版URL获取器采用Deferred对象后的代码如下：\n\n```python\nfrom twisted.internet import reactor\nimport getPage\n\ndef processPage(page):\n    print page\n\ndef logError(error):\n    print error\n\ndef finishProcessing(value):\n    print \"Shutting down...\"\n    reactor.stop()\n\nurl = \"http://google.com\"\ndeferred = getPage(url) # getPage returns a Deferred\ndeferred.addCallbacks(success, failure)\ndeferred.addBoth(stop)\n\nreactor.run()\n```\n\n在这个版本中调用的事件处理函数与之前相同，但它们都注册到了一个单独的Deferred对象上，而不是分散在代码各处再以参数形式传递给getPage。\n\nDeferred对象创建时包含两个添加回调的阶段。第一阶段，addCallbacks将 processPage和logError添加到它们各自归属的回调链中。然后addBoth再将finishProcessing同时添加到这两个回调链上。用图解的方式来看，回调链应该如图所示：\n![Deferred 流程示例](/img/1570783134086.png)\n\nDeferred对象只能被激活一次，如果试图重复激活将引发一个异常。这使得Deferred对象的语义相当接近于同步版中的try/except块。从而让异步事件的处理能更容易推断，避免由于针对单个事件的回调调用多了一个或少了一个而产生微妙的bug。\n\n理解Deferred对象对于理解Twisted程序的执行流是非常重要的。然而当使用Twisted为我们提供的针对网络协议的高层抽象时，通常情况下我们完全不需要直接使用Deferred对象。\n\nDeferred对象所包含的抽象概念是非常强大的，这种思想已经被许多其他的事件驱动平台所借用，包括jQuery、Dojo和Mochikit。\n\n\n###### Transports\nTransports代表网络中两个通信结点之间的连接。Transports负责描述连接的细节，比如连接是面向流式的还是面向数据报的，流控以及可靠性。TCP、UDP和Unix套接字可作为transports的例子。它们被设计为“满足最小功能单元，同时具有最大程度的可复用性”，而且从协议实现中分离出来，这让许多协议可以采用相同类型的传输。Transports实现了ITransports接口，它包含如下的方法：\n\n>write                   以非阻塞的方式按顺序依次将数据写到物理连接上\nwriteSequence           将一个字符串列表写到物理连接上\nloseConnection          将所有挂起的数据写入，然后关闭连接\ngetPeer                 取得连接中对端的地址信息\ngetHost                 取得连接中本端的地址信息\n\n将transports从协议中分离出来也使得对这两个层次的测试变得更加简单。可以通过简单地写入一个字符串来模拟传输，用这种方式来检查。\n\n###### Protocols\n\nProtocols描述了如何以异步的方式处理网络中的事件。HTTP、DNS以及IMAP是应用层协议中的例子。Protocols实现了IProtocol接口，它包含如下的方法：\n>makeConnection               在transport对象和服务器之间建立一条连接\nconnectionMade               连接建立起来后调用\ndataReceived                 接收数据时调用\nconnectionLost               关闭连接时调用\n\n我们最好以一个例子来说明reactor、protocols以及transports这三者之间的关系。以下是完整的echo服务器和客户端的实现，首先来看看服务器部分：\n\n```python\nfrom twisted.internet import protocol, reactor\n\nclass Echo(protocol.Protocol):\n    def dataReceived(self, data):\n        # As soon as any data is received, write it back\n        self.transport.write(data)\n\nclass EchoFactory(protocol.Factory):\n    def buildProtocol(self, addr):\n        return Echo()\n\nreactor.listenTCP(8000, EchoFactory())\nreactor.run()\n```\n接着是客户端部分：\n\n```python\nfrom twisted.internet import reactor, protocol\n\nclass EchoClient(protocol.Protocol):\n    def connectionMade(self):\n        self.transport.write(\"hello, world!\")\n\ndef dataReceived(self, data):\n    print \"Server said:\", data\n        self.transport.loseConnection()\n\ndef connectionLost(self, reason):\n    print \"connection lost\"\n\nclass EchoFactory(protocol.ClientFactory):\n    def buildProtocol(self, addr):\n        return EchoClient()\n\ndef clientConnectionFailed(self, connector, reason):\n    print \"Connection failed - goodbye!\"\n        reactor.stop()\n\ndef clientConnectionLost(self, connector, reason):\n    print \"Connection lost - goodbye!\"\n        reactor.stop()\n\nreactor.connectTCP(\"localhost\", 8000, EchoFactory())\nreactor.run()\n```\n运行服务器端脚本将启动一个TCP服务器，监听端口8000上的连接。服务器采用的是Echo协议，数据经TCP transport对象写出。运行客户端脚本将对服务器发起一个TCP连接，回显服务器端的回应然后终止连接并停止reactor事件循环。这里的Factory用来对连接的双方生成protocol对象实例。两端的通信是异步的，connectTCP负责注册回调函数到reactor事件循环中，当socket上有数据可读时通知回调处理。\n\n###### Applications\nTwisted是用来创建具有可扩展性、跨平台的网络服务器和客户端的引擎。在生产环境中，以标准化的方式简化部署这些应用的过程对于Twisted这种被广泛采用的平台来说是非常重要的一环。为此，Twisted开发了一套应用程序基础组件，采用可重用、可配置的方式来部署Twisted应用。这种方式使程序员避免堆砌千篇一律的代码来将应用程序同已有的工具整合在一起，这包括精灵化进程（daemonization）、日志处理、使用自定义的reactor循环、对代码做性能剖析等。\n\n应用程序基础组件包含4个主要部分：服务（Service）、应用（Application）、配置管理（通过TAC文件和插件）以及twistd命令行程序。为了说明这个基础组件，我们将上一节的Echo服务器转变成一个应用。\n\n+ **Service**\nService就是IService接口下实现的可以启动和停止的组件。Twisted自带有TCP、FTP、HTTP、SSH、DNS等服务以及其他协议的实现。其中许多Service都可以注册到单独的应用中。IService接口的核心是：\n>startService    启动服务。可能包含加载配置数据，设定数据库连接或者监听某个端口\nstopService     关闭服务。可能包含将状态保存到磁盘，关闭数据库连接或者停止监听端口\n\n我们的Echo服务使用TCP协议，因此我们可以使用Twisted中IService接口下默认的TCPServer实现。\n\n+ **Application**\nApplication是处于最顶层的Service，代表了整个Twisted应用程序。Service需要将其自身同Application注册，然后就可以用下面我们将介绍的部署工具twistd搜索并运行应用程序。我们将创建一个可以同Echo Service注册的Echo应用。\n+ **TAC文件**\n当在一个普通的Python文件中管理Twisted应用程序时，需要由开发者负责编写启动和停止reactor事件循环以及配置应用程序的代码。在Twisted的基础组件中，协议的实现都是在一个模块中完成的，需要使用到这些协议的Service可以注册到一个Twisted应用程序配置文件中（TAC文件）去，这样reactor事件循环和程序配置就可以由外部组件来进行管理。\n\n要将我们的Echo服务器转变成一个Echo应用，我们可以按照以下几个简单的步骤来完成：\n\n1. 将Echo服务器的Protocol部分移到它们自己所归属的模块中去。\n\n2. 在TAC文件中：\n\n\t1. 创建一个Echo应用。\n\t2. 创建一个TCPServer的Service实例，它将使用我们的EchoFactory，然后同前面创建的应用完成注册。\n\t\n管理reactor事件循环的代码将由twistd来负责，我们下面会对此进行讨论。这样，应用程序的代码就变成这样了：\necho.py文件：\n\n```python\nfrom twisted.internet import protocol, reactor\n\nclass Echo(protocol.Protocol):\n    def dataReceived(self, data):\n        self.transport.write(data)\n\nclass EchoFactory(protocol.Factory):\n    def buildProtocol(self, addr):\n        return Echo()\n```\n\n+ **twistd**\ntwistd（读作“twist-dee”）是一个跨平台的用来部署Twisted应用程序的工具。它执行TAC文件并负责处理启动和停止应用程序。作为Twisted在网络编程中具有“内置电池”能力的一部分，twistd自带有一些非常有用的配置标志，包括将应用程序转变为守护进程、定义日志文件的路径、设定特权级别、在chroot下运行、使用非默认的reactor，甚至是在profiler下运行应用程序。\n\n我们可以像这样运行这个Echo服务应用：\n\n```python\n$ twistd –y echo_server.tac\n```\n\n在这个简单的例子里，twistd将这个应用程序作为守护进程来启动，日志记录在twistd.log文件中。启动和停止应用后，日志文件内容如下：\n\n```python\n2011-11-19 22:23:07-0500 [-] Log opened.\n2011-11-19 22:23:07-0500 [-] twistd 11.0.0 (/usr/bin/python 2.7.1) starting up.\n2011-11-19 22:23:07-0500 [-] reactor class: twisted.internet.selectreactor.SelectReactor.\n2011-11-19 22:23:07-0500 [-] echo.EchoFactory starting on 8000\n2011-11-19 22:23:07-0500 [-] Starting factory <echo.EchoFactory instance at 0x12d8670>\n2011-11-19 22:23:20-0500 [-] Received SIGTERM, shutting down.\n2011-11-19 22:23:20-0500 [-] (TCP Port 8000 Closed)\n2011-11-19 22:23:20-0500 [-] Stopping factory <echo.EchoFactory instance at 0x12d8670>\n2011-11-19 22:23:20-0500 [-] Main loop terminated.\n2011-11-19 22:23:20-0500 [-] Server Shut Down.\n```\n\n通过使用Twisted框架中的基础组件来运行服务，这么做使得开发人员能够不用再编写类似守护进程和记录日志这样的冗余代码了。这同样也为部署应用程序建立了一个标准的命令行接口。\n\n###### Plugins\n\n对于运行Twisted应用程序的方法，除了基于TAC文件外还有一种可选的方法，这就是插件系统。TAC系统可以很方便的将Twisted预定义的服务同应用程序配置文件注册，而插件系统能够方便的将用户自定义的服务注册为twistd工具的子命令，然后扩展应用程序的命令行接口。\n\n在使用插件系统时：\n\n1. 由于只有plugin API需要保持稳定，这使得第三方开发者能很容易地扩展软件。\n\n2. 插件发现能力已经集成到系统中了。插件可以在程序首次运行时加载并保存，每次程序启动时会重新触发插件发现过程，或者也可以在程序运行期间反复轮询新插件，这使得在程序已经启动后我们还可以判断是否有新的插件安装上了。\n\n当使用Twisted插件系统来扩展软件时，我们要做的就是创建IPlugin接口下实现的对象并将它们放到一个特定的位置中，这里插件系统知道该如何去找到它们。\n\n我们已经将Echo服务转换为一个Twisted应用程序了，而将其转换为一个Twisted插件也是非常简单直接的。在我们之前的Echo模块中，除了包含有Echo协议和EchoFactory的定义之外，现在我们还要添加一个名为twistd的目录，其中还包含着一个名为plugins的子目录，这里正是我们需要定义echo插件的地方。通过这个插件，我们可以启动一个echo服务，并将需要使用的端口号作为参数指定给twistd工具。\n\n```python\nfrom zope.interface import implements\n\nfrom twisted.python import usage\nfrom twisted.plugin import IPlugin\nfrom twisted.application.service import IServiceMaker\nfrom twisted.application import internet\n\nfrom echo import EchoFactory\n\nclass Options(usage.Options):\n    optParameters = [[\"port\", \"p\", 8000, \"The port number to listen on.\"]]\n\nclass EchoServiceMaker(object):\n    implements(IServiceMaker, IPlugin)\n    tapname = \"echo\"\n    description = \"A TCP-based echo server.\"\n    options = Options\n\ndef makeService(self, options):\n    \"\"\"\n    Construct a TCPServer from a factory defined in myproject.\n    \"\"\"\n    return internet.TCPServer(int(options[\"port\"]), EchoFactory())\n\nserviceMaker = EchoServiceMaker()\n```\n\n现在，我们的Echo服务器将作为一个服务选项出现在twistd –help的输出中。运行twistd echo –port=1235将在端口1235上启动一个Echo服务器。\n\nTwisted还带有一个可拔插的针对服务器端认证的模块twisted.cred，插件系统常见的用途就是为应用程序添加一个认证模式。我们可以使用twisted.cred中现成的AuthOptionMixin类来添加针对各种认证的命令行支持，或者是添加新的认证类型。比如，我们可以使用插件系统来添加基于本地Unix密码数据库或者是基于LDAP服务器的认证方式。\n\ntwistd工具中附带有许多Twisted所支持的协议插件，只用一条单独的命令就可以完成启动服务器的工作了。这里有一些通过twistd启动服务器的例子：\n\n```python\ntwistd web –port 8080 –path .\n```\n\n这条命令将在8080端口启动一个HTTP服务器，在当前目录中负责处理静态和动态页面请求。\n\n```python\ntwistd dns –p 5553 –hosts-file=hosts\n```\n\n\n这条命令在端口5553上启动一个DNS服务器，解析指定的文件hosts中的域名，这个文件的内容格式同/etc/hosts一样。\n\n```python\nsudo twistd conch –p tcp:2222\n```\n\n这条命令在端口2222上启动一个SSH服务器。ssh的密钥必须独立设定。\n\n```python\ntwistd mail –E –H localhost –d localhost=emails\n```\n\n这条命令启动一个ESMTP POP3服务器，为本地主机接收邮件并保存到指定的emails目录下。\n\n我们可以方便的通过twistd来搭建一个用于测试客户端功能的服务器，但它同样是可装载的、产品级的服务器实现。\n\n在部署应用程序的方式上，Twisted通过TAC文件、插件以及命令行工具twistd的部署方式已经获得了成功。但是有趣的是，对于大多数大型Twisted应用程序来说，部署它们仍然需要重写一些这类管理和监控组件；Twisted的架构并没有对系统管理员的需求呈现出太多的友好性。这也反映了一个事实，那就是对于系统管理员来说Twisted历来就没有太多架构可言，而这些系统管理员才是部署和维护应用程序的专家。在这方面，Twisted在未来架构设计的决策上需要更积极的征求这类专家级用户的反馈意见。\n\n[本文内容引用自此处](https://www.cnblogs.com/xianguang/p/7027661.html)","source":"_posts/Twisted  介绍.md","raw":"---\ntitle: Twisted  介绍\ncategories:\n- Python笔记\ntags: \n- Python\n- Core Programming\n- Note\n---\n\n## Twisted\n\n\n### Python Twisted介绍\nTwisted是用Python实现的基于事件驱动的网络引擎框架。Twisted诞生于2000年初，在当时的网络游戏开发者看来，无论他们使用哪种语言，手中都鲜有可兼顾扩展性及跨平台的网络库。Twisted的作者试图在当时现有的环境下开发游戏，这一步走的非常艰难，他们迫切地需要一个可扩展性高、基于事件驱动、跨平台的网络开发框架，为此他们决定自己实现一个，并从那些之前的游戏和网络应用程序的开发者中学习，汲取他们的经验教训。\n\nTwisted支持许多常见的传输及应用层协议，包括TCP、UDP、SSL/TLS、HTTP、IMAP、SSH、IRC以及FTP。就像python一样，Twisted也具有“内置电池”（batteries-included）的特点。Twisted对于其支持的所有协议都带有客户端和服务器实现，同时附带有基于命令行的工具，使得配置和部署产品级的Twisted应用变得非常方便。\n\n### 为什么需要Twisted\n2000年时，Twisted的作者Glyph正在开发一个名为Twisted Reality的基于文本方式的多人在线游戏。这个游戏采用Java开发，里面尽是一堆线程——每个连接就有3个线程处理。处理输入的线程会在读操作上阻塞，处理输出的线程将在一些写操作上阻塞，还有一个“逻辑”线程将在等待定时器超时或者事件入队列时休眠。随着玩家们在虚拟世界中移动并交互时，线程出现死锁，缓存被污染，程序中的加锁逻辑几乎从来就没对过——采用多线程使得整个软件变得复杂、漏洞百出而且极难扩展。\n\n为了寻求其他的解决方案，作者发现了Python，特别是Python中用于对流式对象比如socket和pipe进行多路I/O复用的select模块（UNIX规范第3版（SUSv3）描述了select）。那时，Java并没有提供操作系统的select接口或者任何其他的异步I/O API（针对非阻塞式I/O的包java.nio已经在J2SE 1.4中加入了，2002年发布）。通过用Python中的select模块快速搭建起游戏的原型，这迅速降低了程序的复杂度，并且比多线程版本要更加可靠。\n\nGlyph迅速转向了Python、select以及基于事件驱动的编程。他使用Python的select模块为游戏编写了客户端和服务器。但他想要的还不止于此。从根本上说，他希望能将网络行为转变为对游戏中的对象的方法调用。如果你能在游戏中收取邮件会怎样，就像Nethack mailer这种守护进程一样？如果游戏中的每位玩家都拥有一个主页呢？Glyph发现他需要优秀的IMAP以及HTTP客户端和服务器的Python实现，而这些都要采用select。\n\n他首先转向了Medusa，这是一个在90年代中期开发的平台，在这里可以采用Python中的asyncore模块来编写网络服务。asyncore是一个异步化处理socket的模块，在操作系统的select API之上构建了一个调度器和回调接口。\n\n这对于Glyph来说是个激动人心的发现，但Medusa有两个缺点：\n1. 这个项目到2001年就不再维护了，那正是glyph开发Twisted Reality的时候。\n2. asyncore只是对socket的一个薄封装层，应用程序的编写者仍然需要直接操作socket。这意味着程序可移植性的担子仍然落在程序员自己身上。此外，那时asyncore对Windows的支持还有问题，Glyph希望能在Windows上运行一个带有图形用户界面的客户端。\nGlyph需要自己实现一个网络引擎平台，而且他意识到Twisted Reality已经打开了问题的大门，这和他的游戏一样有趣。\n\n随着时间的推移，Twisted Reality这个游戏就演化成了Twisted网络引擎平台。它可以做到当时Python中已有的网络平台所无法做到的事情：\n+ 使用基于事件驱动的编程模型，而不是多线程模型。\n+ 跨平台：为主流操作系统平台暴露出的事件通知系统提供统一的接口。\n+ “内置电池”的能力：提供流行的应用层协议实现，因此Twisted马上就可为开发人员所用。\n+ 符合RFC规范，已经通过健壮的测试套件证明了其一致性。\n+ 能很容易的配合多个网络协议一起使用。\n+ 可扩展。\n\n### Twisted架构概览\nTwisted是一个事件驱动型的网络引擎。由于事件驱动编程模型在Twisted的设计哲学中占有重要的地位，因此这里有必要花点时间来回顾一下究竟事件驱动意味着什么。\n\n事件驱动编程是一种编程范式，这里程序的执行流由外部事件来决定。它的特点是包含一个事件循环，当外部事件发生时使用回调机制来触发相应的处理。另外两种常见的编程范式是（单线程）同步以及多线程编程。\n\n在单线程同步模型中，任务按照顺序执行。如果某个任务因为I/O而阻塞，其他所有的任务都必须等待，直到它完成之后它们才能依次执行。这种明确的执行顺序和串行化处理的行为是很容易推断得出的。如果任务之间并没有互相依赖的关系，但仍然需要互相等待的话这就使得程序不必要的降低了运行速度。\n\n在多线程版本中，这3个任务分别在独立的线程中执行。这些线程由操作系统来管理，在多处理器系统上可以并行处理，或者在单处理器系统上交错执行。这使得当某个线程阻塞在某个资源的同时其他线程得以继续执行。与完成类似功能的同步程序相比，这种方式更有效率，但程序员必须写代码来保护共享资源，防止其被多个线程同时访问。多线程程序更加难以推断，因为这类程序不得不通过线程同步机制如锁、可重入函数、线程局部存储或者其他机制来处理线程安全问题，如果实现不当就会导致出现微妙且令人痛不欲生的bug。\n\n在事件驱动版本的程序中，3个任务**交错执行**，但仍然在一个单独的线程控制中。当处理I/O或者其他昂贵的操作时，注册一个回调到事件循环中，然后当I/O操作完成时继续执行。回调描述了该如何处理某个事件。事件循环轮询所有的事件，当事件到来时将它们分配给等待处理事件的回调函数。这种方式让程序尽可能的得以执行而不需要用到额外的线程。事件驱动型程序比多线程程序更容易推断出行为，因为程序员不需要关心线程安全问题。\n\n当我们面对如下的环境时，事件驱动模型通常是一个好的选择：\n\n程序中有许多任务，而且…\n1. 任务之间高度独立（因此它们不需要互相通信，或者等待彼此）而且…\n2. 在等待事件到来时，某些任务会阻塞。\n3. 当应用程序需要在任务间共享可变的数据时，这也是一个不错的选择，因为这里不需要采用同步处理。\n\n网络应用程序通常都有上述这些特点，这使得它们能够很好的契合事件驱动编程模型。\n\n###### **重用已有的应用**\n在Twisted创建之前就已经有了许多针对多种流行的网络协议的客户端和服务器实现了。为什么Glyph不直接用Apache、IRCd、BIND、OpenSSH或者任何其他已有的应用，而要为Twisted从头开始重新实现各个协议的客户端和服务器呢？\n\n问题在于所有这些已有的实现都存在有从头写起的网络层代码，通常都是C代码。而应用层代码直接同网络层耦合在一起，这使得它们非常难以以库的形式来复用。当要一起使用这些组件时，如果希望在多个协议中暴露相同的数据，则它们必须以黑盒的形式来看待，这使得开发者根本没机会重用代码。此外，服务器和客户端的实现通常是分离的，彼此之间不共享代码。要扩展这些应用，维护跨平台的客户端-服务器兼容性的难度本不至于这么大。\n\nTwisted中的客户端和服务器是用Python开发的，采用了一致性的接口。这使得开发新的客户端和服务器变得很容易实现，可以在客户端和服务器之间共享代码，在协议之间共享应用逻辑，以及对某个实现的代码做测试。\n\n###### **React模式**\nTwisted实现了设计模式中的反应堆（reactor）模式，这种模式在单线程环境中调度多个事件源产生的事件到它们各自的事件处理例程中去。\n\nTwisted的核心就是reactor事件循环。Reactor可以感知网络、文件系统以及定时器事件。它等待然后处理这些事件，从特定于平台的行为中抽象出来，并提供统一的接口，使得在网络协议栈的任何位置对事件做出响应都变得简单。\n\n基本上reactor完成的任务就是：\n\n```python\nwhile True:\n    timeout = time_until_next_timed_event()\n    events = wait_for_events(timeout)\n    events += timed_events_until(now())\n    for event in events:\n        event.process()\n```\n\nTwisted目前在所有平台上的默认reactor都是基于poll API的（UNIX规范第3版（SUSv3）中描述）。此外，Twisted还支持一些特定于平台的高容量多路复用API。这些reactor包括基于FreeBSD中kqueue机制的KQueue reactor，支持epoll接口的系统（目前是Linux 2.6）中的epoll reactor，以及基于Windows下的输入输出完成端口的IOCP reactor。\n\n在实现轮询的相关细节中，Twisted需要考虑的包括：\n\n+ 网络和文件系统的限制\n+ 缓冲行为\n+ 如何检测连接丢失\n+ 出现错误时的返回值\n\nTwisted的reactor实现同时也考虑了正确使用底层的非阻塞式API，并正确处理各种边界情况。由于Python中没有暴露出IOCP API，因此Twisted需要维护自己的实现。\n\n###### **管理回调链**\n\n回调是事件驱动编程模型中的基础，也是reactor通知应用程序事件已经处理完成的方式。随着程序规模不断扩大，基于事件驱动的程序需要同时处理事件处理成功和出错的情况，这使得程序变得越来越复杂。若没有注册一个合适的回调，程序就会阻塞，因为这个事件处理的过程绝不会发生。出现错误时需要通过应用程序的不同层次从网络栈向上传递回调链。\n\n下面是两段Python伪码，分别是同步和异步模式下获取URL的玩具代码。让我们相互比较一下这两个版本，看看基于事件驱动的程序有什么缺陷：\n\n以同步的方式获取URL：\n\n```python\nimport getPage\n\ndef processPage(page):\n    print page\n\ndef logError(error):\n    print error\n\ndef finishProcessing(value):\n    print \"Shutting down...\"\n    exit(0)\n\nurl = \"http://google.com\"\ntry:\n    page = getPage(url)\n    processPage(page)\nexcept Error, e:\n    logError(error)\nfinally:\n    finishProcessing()\n```\n以异步的方式获取URL：\n\n```python\nfrom twisted.internet import reactor\nimport getPage\n\ndef processPage(page):\n    print page\n    finishProcessing()\n\ndef logError(error):\n    print error\n    finishProcessing()\n\ndef finishProcessing(value):\n    print \"Shutting down...\"\n    reactor.stop()\n\nurl = \"http://google.com\"\n# getPage takes: url, \n# success callback, error callback\ngetPage(url, processPage, logError)\n\nreactor.run()\n```\n\n在异步版的URL获取器中，reactor.run()启动reactor事件循环。在同步和异步版程序中，我们假定getPage函数处理获取页面的工作。如果获取成功就调用processPage，如果尝试获取页面时出现了Exception（异常），logError就得到调用。无论哪种情况，最后都要调用finishProcessing。\n\n异步版中的logError回调正对应于同步版中的try/except块。对processPage的回调对应于else块，无条件回调的finishProcessing就对应于finally块。\n\n在同步版中，代码结构直接显示出有一个try/except块，logError和processPage这两者间只会取其一调用一次，而finishProcessing总是会被调用一次。在异步版中需要由程序员自己负责正确调用成功和失败情况下的回调链。如果由于编程错误，在processPage或者logError的回调链之后没有调用finishProcessing，reactor事件循环将永远不会停止，程序就会卡住。\n\n这个玩具式的例子告诉我们在开发Twisted的头几年里这种复杂性令程序员感到非常沮丧。而Twisted应对这种复杂性的方式是新增一个称为Deferred（延迟）的对象。\n\n###### Deferreds\nDeferred对象以抽象化的方式表达了一种思想，即结果还尚不存在。它同样能够帮助管理产生这个结果所需要的回调链。当从函数中返回时，Deferred对象承诺在某个时刻函数将产生一个结果。返回的Deferred对象中包含所有注册到事件上的回调引用，因此在函数间只需要传递这一个对象即可，跟踪这个对象比单独管理所有的回调要简单的多。\n\nDeferred对象包含一对回调链，一个是针对操作成功的回调，一个是针对操作失败的回调。初始状态下Deferred对象的两条链都为空。在事件处理的过程中，每个阶段都为其添加处理成功的回调和处理失败的回调。当一个异步结果到来时，Deferred对象就被“激活”，那么处理成功的回调和处理失败的回调就可以以合适的方式按照它们添加进来的顺序依次得到调用。\n\n异步版URL获取器采用Deferred对象后的代码如下：\n\n```python\nfrom twisted.internet import reactor\nimport getPage\n\ndef processPage(page):\n    print page\n\ndef logError(error):\n    print error\n\ndef finishProcessing(value):\n    print \"Shutting down...\"\n    reactor.stop()\n\nurl = \"http://google.com\"\ndeferred = getPage(url) # getPage returns a Deferred\ndeferred.addCallbacks(success, failure)\ndeferred.addBoth(stop)\n\nreactor.run()\n```\n\n在这个版本中调用的事件处理函数与之前相同，但它们都注册到了一个单独的Deferred对象上，而不是分散在代码各处再以参数形式传递给getPage。\n\nDeferred对象创建时包含两个添加回调的阶段。第一阶段，addCallbacks将 processPage和logError添加到它们各自归属的回调链中。然后addBoth再将finishProcessing同时添加到这两个回调链上。用图解的方式来看，回调链应该如图所示：\n![Deferred 流程示例](/img/1570783134086.png)\n\nDeferred对象只能被激活一次，如果试图重复激活将引发一个异常。这使得Deferred对象的语义相当接近于同步版中的try/except块。从而让异步事件的处理能更容易推断，避免由于针对单个事件的回调调用多了一个或少了一个而产生微妙的bug。\n\n理解Deferred对象对于理解Twisted程序的执行流是非常重要的。然而当使用Twisted为我们提供的针对网络协议的高层抽象时，通常情况下我们完全不需要直接使用Deferred对象。\n\nDeferred对象所包含的抽象概念是非常强大的，这种思想已经被许多其他的事件驱动平台所借用，包括jQuery、Dojo和Mochikit。\n\n\n###### Transports\nTransports代表网络中两个通信结点之间的连接。Transports负责描述连接的细节，比如连接是面向流式的还是面向数据报的，流控以及可靠性。TCP、UDP和Unix套接字可作为transports的例子。它们被设计为“满足最小功能单元，同时具有最大程度的可复用性”，而且从协议实现中分离出来，这让许多协议可以采用相同类型的传输。Transports实现了ITransports接口，它包含如下的方法：\n\n>write                   以非阻塞的方式按顺序依次将数据写到物理连接上\nwriteSequence           将一个字符串列表写到物理连接上\nloseConnection          将所有挂起的数据写入，然后关闭连接\ngetPeer                 取得连接中对端的地址信息\ngetHost                 取得连接中本端的地址信息\n\n将transports从协议中分离出来也使得对这两个层次的测试变得更加简单。可以通过简单地写入一个字符串来模拟传输，用这种方式来检查。\n\n###### Protocols\n\nProtocols描述了如何以异步的方式处理网络中的事件。HTTP、DNS以及IMAP是应用层协议中的例子。Protocols实现了IProtocol接口，它包含如下的方法：\n>makeConnection               在transport对象和服务器之间建立一条连接\nconnectionMade               连接建立起来后调用\ndataReceived                 接收数据时调用\nconnectionLost               关闭连接时调用\n\n我们最好以一个例子来说明reactor、protocols以及transports这三者之间的关系。以下是完整的echo服务器和客户端的实现，首先来看看服务器部分：\n\n```python\nfrom twisted.internet import protocol, reactor\n\nclass Echo(protocol.Protocol):\n    def dataReceived(self, data):\n        # As soon as any data is received, write it back\n        self.transport.write(data)\n\nclass EchoFactory(protocol.Factory):\n    def buildProtocol(self, addr):\n        return Echo()\n\nreactor.listenTCP(8000, EchoFactory())\nreactor.run()\n```\n接着是客户端部分：\n\n```python\nfrom twisted.internet import reactor, protocol\n\nclass EchoClient(protocol.Protocol):\n    def connectionMade(self):\n        self.transport.write(\"hello, world!\")\n\ndef dataReceived(self, data):\n    print \"Server said:\", data\n        self.transport.loseConnection()\n\ndef connectionLost(self, reason):\n    print \"connection lost\"\n\nclass EchoFactory(protocol.ClientFactory):\n    def buildProtocol(self, addr):\n        return EchoClient()\n\ndef clientConnectionFailed(self, connector, reason):\n    print \"Connection failed - goodbye!\"\n        reactor.stop()\n\ndef clientConnectionLost(self, connector, reason):\n    print \"Connection lost - goodbye!\"\n        reactor.stop()\n\nreactor.connectTCP(\"localhost\", 8000, EchoFactory())\nreactor.run()\n```\n运行服务器端脚本将启动一个TCP服务器，监听端口8000上的连接。服务器采用的是Echo协议，数据经TCP transport对象写出。运行客户端脚本将对服务器发起一个TCP连接，回显服务器端的回应然后终止连接并停止reactor事件循环。这里的Factory用来对连接的双方生成protocol对象实例。两端的通信是异步的，connectTCP负责注册回调函数到reactor事件循环中，当socket上有数据可读时通知回调处理。\n\n###### Applications\nTwisted是用来创建具有可扩展性、跨平台的网络服务器和客户端的引擎。在生产环境中，以标准化的方式简化部署这些应用的过程对于Twisted这种被广泛采用的平台来说是非常重要的一环。为此，Twisted开发了一套应用程序基础组件，采用可重用、可配置的方式来部署Twisted应用。这种方式使程序员避免堆砌千篇一律的代码来将应用程序同已有的工具整合在一起，这包括精灵化进程（daemonization）、日志处理、使用自定义的reactor循环、对代码做性能剖析等。\n\n应用程序基础组件包含4个主要部分：服务（Service）、应用（Application）、配置管理（通过TAC文件和插件）以及twistd命令行程序。为了说明这个基础组件，我们将上一节的Echo服务器转变成一个应用。\n\n+ **Service**\nService就是IService接口下实现的可以启动和停止的组件。Twisted自带有TCP、FTP、HTTP、SSH、DNS等服务以及其他协议的实现。其中许多Service都可以注册到单独的应用中。IService接口的核心是：\n>startService    启动服务。可能包含加载配置数据，设定数据库连接或者监听某个端口\nstopService     关闭服务。可能包含将状态保存到磁盘，关闭数据库连接或者停止监听端口\n\n我们的Echo服务使用TCP协议，因此我们可以使用Twisted中IService接口下默认的TCPServer实现。\n\n+ **Application**\nApplication是处于最顶层的Service，代表了整个Twisted应用程序。Service需要将其自身同Application注册，然后就可以用下面我们将介绍的部署工具twistd搜索并运行应用程序。我们将创建一个可以同Echo Service注册的Echo应用。\n+ **TAC文件**\n当在一个普通的Python文件中管理Twisted应用程序时，需要由开发者负责编写启动和停止reactor事件循环以及配置应用程序的代码。在Twisted的基础组件中，协议的实现都是在一个模块中完成的，需要使用到这些协议的Service可以注册到一个Twisted应用程序配置文件中（TAC文件）去，这样reactor事件循环和程序配置就可以由外部组件来进行管理。\n\n要将我们的Echo服务器转变成一个Echo应用，我们可以按照以下几个简单的步骤来完成：\n\n1. 将Echo服务器的Protocol部分移到它们自己所归属的模块中去。\n\n2. 在TAC文件中：\n\n\t1. 创建一个Echo应用。\n\t2. 创建一个TCPServer的Service实例，它将使用我们的EchoFactory，然后同前面创建的应用完成注册。\n\t\n管理reactor事件循环的代码将由twistd来负责，我们下面会对此进行讨论。这样，应用程序的代码就变成这样了：\necho.py文件：\n\n```python\nfrom twisted.internet import protocol, reactor\n\nclass Echo(protocol.Protocol):\n    def dataReceived(self, data):\n        self.transport.write(data)\n\nclass EchoFactory(protocol.Factory):\n    def buildProtocol(self, addr):\n        return Echo()\n```\n\n+ **twistd**\ntwistd（读作“twist-dee”）是一个跨平台的用来部署Twisted应用程序的工具。它执行TAC文件并负责处理启动和停止应用程序。作为Twisted在网络编程中具有“内置电池”能力的一部分，twistd自带有一些非常有用的配置标志，包括将应用程序转变为守护进程、定义日志文件的路径、设定特权级别、在chroot下运行、使用非默认的reactor，甚至是在profiler下运行应用程序。\n\n我们可以像这样运行这个Echo服务应用：\n\n```python\n$ twistd –y echo_server.tac\n```\n\n在这个简单的例子里，twistd将这个应用程序作为守护进程来启动，日志记录在twistd.log文件中。启动和停止应用后，日志文件内容如下：\n\n```python\n2011-11-19 22:23:07-0500 [-] Log opened.\n2011-11-19 22:23:07-0500 [-] twistd 11.0.0 (/usr/bin/python 2.7.1) starting up.\n2011-11-19 22:23:07-0500 [-] reactor class: twisted.internet.selectreactor.SelectReactor.\n2011-11-19 22:23:07-0500 [-] echo.EchoFactory starting on 8000\n2011-11-19 22:23:07-0500 [-] Starting factory <echo.EchoFactory instance at 0x12d8670>\n2011-11-19 22:23:20-0500 [-] Received SIGTERM, shutting down.\n2011-11-19 22:23:20-0500 [-] (TCP Port 8000 Closed)\n2011-11-19 22:23:20-0500 [-] Stopping factory <echo.EchoFactory instance at 0x12d8670>\n2011-11-19 22:23:20-0500 [-] Main loop terminated.\n2011-11-19 22:23:20-0500 [-] Server Shut Down.\n```\n\n通过使用Twisted框架中的基础组件来运行服务，这么做使得开发人员能够不用再编写类似守护进程和记录日志这样的冗余代码了。这同样也为部署应用程序建立了一个标准的命令行接口。\n\n###### Plugins\n\n对于运行Twisted应用程序的方法，除了基于TAC文件外还有一种可选的方法，这就是插件系统。TAC系统可以很方便的将Twisted预定义的服务同应用程序配置文件注册，而插件系统能够方便的将用户自定义的服务注册为twistd工具的子命令，然后扩展应用程序的命令行接口。\n\n在使用插件系统时：\n\n1. 由于只有plugin API需要保持稳定，这使得第三方开发者能很容易地扩展软件。\n\n2. 插件发现能力已经集成到系统中了。插件可以在程序首次运行时加载并保存，每次程序启动时会重新触发插件发现过程，或者也可以在程序运行期间反复轮询新插件，这使得在程序已经启动后我们还可以判断是否有新的插件安装上了。\n\n当使用Twisted插件系统来扩展软件时，我们要做的就是创建IPlugin接口下实现的对象并将它们放到一个特定的位置中，这里插件系统知道该如何去找到它们。\n\n我们已经将Echo服务转换为一个Twisted应用程序了，而将其转换为一个Twisted插件也是非常简单直接的。在我们之前的Echo模块中，除了包含有Echo协议和EchoFactory的定义之外，现在我们还要添加一个名为twistd的目录，其中还包含着一个名为plugins的子目录，这里正是我们需要定义echo插件的地方。通过这个插件，我们可以启动一个echo服务，并将需要使用的端口号作为参数指定给twistd工具。\n\n```python\nfrom zope.interface import implements\n\nfrom twisted.python import usage\nfrom twisted.plugin import IPlugin\nfrom twisted.application.service import IServiceMaker\nfrom twisted.application import internet\n\nfrom echo import EchoFactory\n\nclass Options(usage.Options):\n    optParameters = [[\"port\", \"p\", 8000, \"The port number to listen on.\"]]\n\nclass EchoServiceMaker(object):\n    implements(IServiceMaker, IPlugin)\n    tapname = \"echo\"\n    description = \"A TCP-based echo server.\"\n    options = Options\n\ndef makeService(self, options):\n    \"\"\"\n    Construct a TCPServer from a factory defined in myproject.\n    \"\"\"\n    return internet.TCPServer(int(options[\"port\"]), EchoFactory())\n\nserviceMaker = EchoServiceMaker()\n```\n\n现在，我们的Echo服务器将作为一个服务选项出现在twistd –help的输出中。运行twistd echo –port=1235将在端口1235上启动一个Echo服务器。\n\nTwisted还带有一个可拔插的针对服务器端认证的模块twisted.cred，插件系统常见的用途就是为应用程序添加一个认证模式。我们可以使用twisted.cred中现成的AuthOptionMixin类来添加针对各种认证的命令行支持，或者是添加新的认证类型。比如，我们可以使用插件系统来添加基于本地Unix密码数据库或者是基于LDAP服务器的认证方式。\n\ntwistd工具中附带有许多Twisted所支持的协议插件，只用一条单独的命令就可以完成启动服务器的工作了。这里有一些通过twistd启动服务器的例子：\n\n```python\ntwistd web –port 8080 –path .\n```\n\n这条命令将在8080端口启动一个HTTP服务器，在当前目录中负责处理静态和动态页面请求。\n\n```python\ntwistd dns –p 5553 –hosts-file=hosts\n```\n\n\n这条命令在端口5553上启动一个DNS服务器，解析指定的文件hosts中的域名，这个文件的内容格式同/etc/hosts一样。\n\n```python\nsudo twistd conch –p tcp:2222\n```\n\n这条命令在端口2222上启动一个SSH服务器。ssh的密钥必须独立设定。\n\n```python\ntwistd mail –E –H localhost –d localhost=emails\n```\n\n这条命令启动一个ESMTP POP3服务器，为本地主机接收邮件并保存到指定的emails目录下。\n\n我们可以方便的通过twistd来搭建一个用于测试客户端功能的服务器，但它同样是可装载的、产品级的服务器实现。\n\n在部署应用程序的方式上，Twisted通过TAC文件、插件以及命令行工具twistd的部署方式已经获得了成功。但是有趣的是，对于大多数大型Twisted应用程序来说，部署它们仍然需要重写一些这类管理和监控组件；Twisted的架构并没有对系统管理员的需求呈现出太多的友好性。这也反映了一个事实，那就是对于系统管理员来说Twisted历来就没有太多架构可言，而这些系统管理员才是部署和维护应用程序的专家。在这方面，Twisted在未来架构设计的决策上需要更积极的征求这类专家级用户的反馈意见。\n\n[本文内容引用自此处](https://www.cnblogs.com/xianguang/p/7027661.html)","slug":"Twisted  介绍","published":1,"date":"2019-10-11T10:25:57.894Z","updated":"2019-10-11T10:32:06.454Z","_id":"ck1lyktob0007ep113jccghle","comments":1,"layout":"post","photos":[],"link":"","content":"<h2 id=\"Twisted\"><a href=\"#Twisted\" class=\"headerlink\" title=\"Twisted\"></a>Twisted</h2><h3 id=\"Python-Twisted介绍\"><a href=\"#Python-Twisted介绍\" class=\"headerlink\" title=\"Python Twisted介绍\"></a>Python Twisted介绍</h3><p>Twisted是用Python实现的基于事件驱动的网络引擎框架。Twisted诞生于2000年初，在当时的网络游戏开发者看来，无论他们使用哪种语言，手中都鲜有可兼顾扩展性及跨平台的网络库。Twisted的作者试图在当时现有的环境下开发游戏，这一步走的非常艰难，他们迫切地需要一个可扩展性高、基于事件驱动、跨平台的网络开发框架，为此他们决定自己实现一个，并从那些之前的游戏和网络应用程序的开发者中学习，汲取他们的经验教训。</p>\n<p>Twisted支持许多常见的传输及应用层协议，包括TCP、UDP、SSL/TLS、HTTP、IMAP、SSH、IRC以及FTP。就像python一样，Twisted也具有“内置电池”（batteries-included）的特点。Twisted对于其支持的所有协议都带有客户端和服务器实现，同时附带有基于命令行的工具，使得配置和部署产品级的Twisted应用变得非常方便。</p>\n<h3 id=\"为什么需要Twisted\"><a href=\"#为什么需要Twisted\" class=\"headerlink\" title=\"为什么需要Twisted\"></a>为什么需要Twisted</h3><p>2000年时，Twisted的作者Glyph正在开发一个名为Twisted Reality的基于文本方式的多人在线游戏。这个游戏采用Java开发，里面尽是一堆线程——每个连接就有3个线程处理。处理输入的线程会在读操作上阻塞，处理输出的线程将在一些写操作上阻塞，还有一个“逻辑”线程将在等待定时器超时或者事件入队列时休眠。随着玩家们在虚拟世界中移动并交互时，线程出现死锁，缓存被污染，程序中的加锁逻辑几乎从来就没对过——采用多线程使得整个软件变得复杂、漏洞百出而且极难扩展。</p>\n<p>为了寻求其他的解决方案，作者发现了Python，特别是Python中用于对流式对象比如socket和pipe进行多路I/O复用的select模块（UNIX规范第3版（SUSv3）描述了select）。那时，Java并没有提供操作系统的select接口或者任何其他的异步I/O API（针对非阻塞式I/O的包java.nio已经在J2SE 1.4中加入了，2002年发布）。通过用Python中的select模块快速搭建起游戏的原型，这迅速降低了程序的复杂度，并且比多线程版本要更加可靠。</p>\n<p>Glyph迅速转向了Python、select以及基于事件驱动的编程。他使用Python的select模块为游戏编写了客户端和服务器。但他想要的还不止于此。从根本上说，他希望能将网络行为转变为对游戏中的对象的方法调用。如果你能在游戏中收取邮件会怎样，就像Nethack mailer这种守护进程一样？如果游戏中的每位玩家都拥有一个主页呢？Glyph发现他需要优秀的IMAP以及HTTP客户端和服务器的Python实现，而这些都要采用select。</p>\n<p>他首先转向了Medusa，这是一个在90年代中期开发的平台，在这里可以采用Python中的asyncore模块来编写网络服务。asyncore是一个异步化处理socket的模块，在操作系统的select API之上构建了一个调度器和回调接口。</p>\n<p>这对于Glyph来说是个激动人心的发现，但Medusa有两个缺点：</p>\n<ol>\n<li>这个项目到2001年就不再维护了，那正是glyph开发Twisted Reality的时候。</li>\n<li>asyncore只是对socket的一个薄封装层，应用程序的编写者仍然需要直接操作socket。这意味着程序可移植性的担子仍然落在程序员自己身上。此外，那时asyncore对Windows的支持还有问题，Glyph希望能在Windows上运行一个带有图形用户界面的客户端。<br>Glyph需要自己实现一个网络引擎平台，而且他意识到Twisted Reality已经打开了问题的大门，这和他的游戏一样有趣。</li>\n</ol>\n<p>随着时间的推移，Twisted Reality这个游戏就演化成了Twisted网络引擎平台。它可以做到当时Python中已有的网络平台所无法做到的事情：</p>\n<ul>\n<li>使用基于事件驱动的编程模型，而不是多线程模型。</li>\n<li>跨平台：为主流操作系统平台暴露出的事件通知系统提供统一的接口。</li>\n<li>“内置电池”的能力：提供流行的应用层协议实现，因此Twisted马上就可为开发人员所用。</li>\n<li>符合RFC规范，已经通过健壮的测试套件证明了其一致性。</li>\n<li>能很容易的配合多个网络协议一起使用。</li>\n<li>可扩展。</li>\n</ul>\n<h3 id=\"Twisted架构概览\"><a href=\"#Twisted架构概览\" class=\"headerlink\" title=\"Twisted架构概览\"></a>Twisted架构概览</h3><p>Twisted是一个事件驱动型的网络引擎。由于事件驱动编程模型在Twisted的设计哲学中占有重要的地位，因此这里有必要花点时间来回顾一下究竟事件驱动意味着什么。</p>\n<p>事件驱动编程是一种编程范式，这里程序的执行流由外部事件来决定。它的特点是包含一个事件循环，当外部事件发生时使用回调机制来触发相应的处理。另外两种常见的编程范式是（单线程）同步以及多线程编程。</p>\n<p>在单线程同步模型中，任务按照顺序执行。如果某个任务因为I/O而阻塞，其他所有的任务都必须等待，直到它完成之后它们才能依次执行。这种明确的执行顺序和串行化处理的行为是很容易推断得出的。如果任务之间并没有互相依赖的关系，但仍然需要互相等待的话这就使得程序不必要的降低了运行速度。</p>\n<p>在多线程版本中，这3个任务分别在独立的线程中执行。这些线程由操作系统来管理，在多处理器系统上可以并行处理，或者在单处理器系统上交错执行。这使得当某个线程阻塞在某个资源的同时其他线程得以继续执行。与完成类似功能的同步程序相比，这种方式更有效率，但程序员必须写代码来保护共享资源，防止其被多个线程同时访问。多线程程序更加难以推断，因为这类程序不得不通过线程同步机制如锁、可重入函数、线程局部存储或者其他机制来处理线程安全问题，如果实现不当就会导致出现微妙且令人痛不欲生的bug。</p>\n<p>在事件驱动版本的程序中，3个任务<strong>交错执行</strong>，但仍然在一个单独的线程控制中。当处理I/O或者其他昂贵的操作时，注册一个回调到事件循环中，然后当I/O操作完成时继续执行。回调描述了该如何处理某个事件。事件循环轮询所有的事件，当事件到来时将它们分配给等待处理事件的回调函数。这种方式让程序尽可能的得以执行而不需要用到额外的线程。事件驱动型程序比多线程程序更容易推断出行为，因为程序员不需要关心线程安全问题。</p>\n<p>当我们面对如下的环境时，事件驱动模型通常是一个好的选择：</p>\n<p>程序中有许多任务，而且…</p>\n<ol>\n<li>任务之间高度独立（因此它们不需要互相通信，或者等待彼此）而且…</li>\n<li>在等待事件到来时，某些任务会阻塞。</li>\n<li>当应用程序需要在任务间共享可变的数据时，这也是一个不错的选择，因为这里不需要采用同步处理。</li>\n</ol>\n<p>网络应用程序通常都有上述这些特点，这使得它们能够很好的契合事件驱动编程模型。</p>\n<h6 id=\"重用已有的应用\"><a href=\"#重用已有的应用\" class=\"headerlink\" title=\"重用已有的应用\"></a><strong>重用已有的应用</strong></h6><p>在Twisted创建之前就已经有了许多针对多种流行的网络协议的客户端和服务器实现了。为什么Glyph不直接用Apache、IRCd、BIND、OpenSSH或者任何其他已有的应用，而要为Twisted从头开始重新实现各个协议的客户端和服务器呢？</p>\n<p>问题在于所有这些已有的实现都存在有从头写起的网络层代码，通常都是C代码。而应用层代码直接同网络层耦合在一起，这使得它们非常难以以库的形式来复用。当要一起使用这些组件时，如果希望在多个协议中暴露相同的数据，则它们必须以黑盒的形式来看待，这使得开发者根本没机会重用代码。此外，服务器和客户端的实现通常是分离的，彼此之间不共享代码。要扩展这些应用，维护跨平台的客户端-服务器兼容性的难度本不至于这么大。</p>\n<p>Twisted中的客户端和服务器是用Python开发的，采用了一致性的接口。这使得开发新的客户端和服务器变得很容易实现，可以在客户端和服务器之间共享代码，在协议之间共享应用逻辑，以及对某个实现的代码做测试。</p>\n<h6 id=\"React模式\"><a href=\"#React模式\" class=\"headerlink\" title=\"React模式\"></a><strong>React模式</strong></h6><p>Twisted实现了设计模式中的反应堆（reactor）模式，这种模式在单线程环境中调度多个事件源产生的事件到它们各自的事件处理例程中去。</p>\n<p>Twisted的核心就是reactor事件循环。Reactor可以感知网络、文件系统以及定时器事件。它等待然后处理这些事件，从特定于平台的行为中抽象出来，并提供统一的接口，使得在网络协议栈的任何位置对事件做出响应都变得简单。</p>\n<p>基本上reactor完成的任务就是：</p>\n<pre><code class=\"python\">while True:\n    timeout = time_until_next_timed_event()\n    events = wait_for_events(timeout)\n    events += timed_events_until(now())\n    for event in events:\n        event.process()</code></pre>\n<p>Twisted目前在所有平台上的默认reactor都是基于poll API的（UNIX规范第3版（SUSv3）中描述）。此外，Twisted还支持一些特定于平台的高容量多路复用API。这些reactor包括基于FreeBSD中kqueue机制的KQueue reactor，支持epoll接口的系统（目前是Linux 2.6）中的epoll reactor，以及基于Windows下的输入输出完成端口的IOCP reactor。</p>\n<p>在实现轮询的相关细节中，Twisted需要考虑的包括：</p>\n<ul>\n<li>网络和文件系统的限制</li>\n<li>缓冲行为</li>\n<li>如何检测连接丢失</li>\n<li>出现错误时的返回值</li>\n</ul>\n<p>Twisted的reactor实现同时也考虑了正确使用底层的非阻塞式API，并正确处理各种边界情况。由于Python中没有暴露出IOCP API，因此Twisted需要维护自己的实现。</p>\n<h6 id=\"管理回调链\"><a href=\"#管理回调链\" class=\"headerlink\" title=\"管理回调链\"></a><strong>管理回调链</strong></h6><p>回调是事件驱动编程模型中的基础，也是reactor通知应用程序事件已经处理完成的方式。随着程序规模不断扩大，基于事件驱动的程序需要同时处理事件处理成功和出错的情况，这使得程序变得越来越复杂。若没有注册一个合适的回调，程序就会阻塞，因为这个事件处理的过程绝不会发生。出现错误时需要通过应用程序的不同层次从网络栈向上传递回调链。</p>\n<p>下面是两段Python伪码，分别是同步和异步模式下获取URL的玩具代码。让我们相互比较一下这两个版本，看看基于事件驱动的程序有什么缺陷：</p>\n<p>以同步的方式获取URL：</p>\n<pre><code class=\"python\">import getPage\n\ndef processPage(page):\n    print page\n\ndef logError(error):\n    print error\n\ndef finishProcessing(value):\n    print &quot;Shutting down...&quot;\n    exit(0)\n\nurl = &quot;http://google.com&quot;\ntry:\n    page = getPage(url)\n    processPage(page)\nexcept Error, e:\n    logError(error)\nfinally:\n    finishProcessing()</code></pre>\n<p>以异步的方式获取URL：</p>\n<pre><code class=\"python\">from twisted.internet import reactor\nimport getPage\n\ndef processPage(page):\n    print page\n    finishProcessing()\n\ndef logError(error):\n    print error\n    finishProcessing()\n\ndef finishProcessing(value):\n    print &quot;Shutting down...&quot;\n    reactor.stop()\n\nurl = &quot;http://google.com&quot;\n# getPage takes: url, \n# success callback, error callback\ngetPage(url, processPage, logError)\n\nreactor.run()</code></pre>\n<p>在异步版的URL获取器中，reactor.run()启动reactor事件循环。在同步和异步版程序中，我们假定getPage函数处理获取页面的工作。如果获取成功就调用processPage，如果尝试获取页面时出现了Exception（异常），logError就得到调用。无论哪种情况，最后都要调用finishProcessing。</p>\n<p>异步版中的logError回调正对应于同步版中的try/except块。对processPage的回调对应于else块，无条件回调的finishProcessing就对应于finally块。</p>\n<p>在同步版中，代码结构直接显示出有一个try/except块，logError和processPage这两者间只会取其一调用一次，而finishProcessing总是会被调用一次。在异步版中需要由程序员自己负责正确调用成功和失败情况下的回调链。如果由于编程错误，在processPage或者logError的回调链之后没有调用finishProcessing，reactor事件循环将永远不会停止，程序就会卡住。</p>\n<p>这个玩具式的例子告诉我们在开发Twisted的头几年里这种复杂性令程序员感到非常沮丧。而Twisted应对这种复杂性的方式是新增一个称为Deferred（延迟）的对象。</p>\n<h6 id=\"Deferreds\"><a href=\"#Deferreds\" class=\"headerlink\" title=\"Deferreds\"></a>Deferreds</h6><p>Deferred对象以抽象化的方式表达了一种思想，即结果还尚不存在。它同样能够帮助管理产生这个结果所需要的回调链。当从函数中返回时，Deferred对象承诺在某个时刻函数将产生一个结果。返回的Deferred对象中包含所有注册到事件上的回调引用，因此在函数间只需要传递这一个对象即可，跟踪这个对象比单独管理所有的回调要简单的多。</p>\n<p>Deferred对象包含一对回调链，一个是针对操作成功的回调，一个是针对操作失败的回调。初始状态下Deferred对象的两条链都为空。在事件处理的过程中，每个阶段都为其添加处理成功的回调和处理失败的回调。当一个异步结果到来时，Deferred对象就被“激活”，那么处理成功的回调和处理失败的回调就可以以合适的方式按照它们添加进来的顺序依次得到调用。</p>\n<p>异步版URL获取器采用Deferred对象后的代码如下：</p>\n<pre><code class=\"python\">from twisted.internet import reactor\nimport getPage\n\ndef processPage(page):\n    print page\n\ndef logError(error):\n    print error\n\ndef finishProcessing(value):\n    print &quot;Shutting down...&quot;\n    reactor.stop()\n\nurl = &quot;http://google.com&quot;\ndeferred = getPage(url) # getPage returns a Deferred\ndeferred.addCallbacks(success, failure)\ndeferred.addBoth(stop)\n\nreactor.run()</code></pre>\n<p>在这个版本中调用的事件处理函数与之前相同，但它们都注册到了一个单独的Deferred对象上，而不是分散在代码各处再以参数形式传递给getPage。</p>\n<p>Deferred对象创建时包含两个添加回调的阶段。第一阶段，addCallbacks将 processPage和logError添加到它们各自归属的回调链中。然后addBoth再将finishProcessing同时添加到这两个回调链上。用图解的方式来看，回调链应该如图所示：<br><img src=\"/img/1570783134086.png\" alt=\"Deferred 流程示例\"></p>\n<p>Deferred对象只能被激活一次，如果试图重复激活将引发一个异常。这使得Deferred对象的语义相当接近于同步版中的try/except块。从而让异步事件的处理能更容易推断，避免由于针对单个事件的回调调用多了一个或少了一个而产生微妙的bug。</p>\n<p>理解Deferred对象对于理解Twisted程序的执行流是非常重要的。然而当使用Twisted为我们提供的针对网络协议的高层抽象时，通常情况下我们完全不需要直接使用Deferred对象。</p>\n<p>Deferred对象所包含的抽象概念是非常强大的，这种思想已经被许多其他的事件驱动平台所借用，包括jQuery、Dojo和Mochikit。</p>\n<h6 id=\"Transports\"><a href=\"#Transports\" class=\"headerlink\" title=\"Transports\"></a>Transports</h6><p>Transports代表网络中两个通信结点之间的连接。Transports负责描述连接的细节，比如连接是面向流式的还是面向数据报的，流控以及可靠性。TCP、UDP和Unix套接字可作为transports的例子。它们被设计为“满足最小功能单元，同时具有最大程度的可复用性”，而且从协议实现中分离出来，这让许多协议可以采用相同类型的传输。Transports实现了ITransports接口，它包含如下的方法：</p>\n<blockquote>\n<p>write                   以非阻塞的方式按顺序依次将数据写到物理连接上<br>writeSequence           将一个字符串列表写到物理连接上<br>loseConnection          将所有挂起的数据写入，然后关闭连接<br>getPeer                 取得连接中对端的地址信息<br>getHost                 取得连接中本端的地址信息</p>\n</blockquote>\n<p>将transports从协议中分离出来也使得对这两个层次的测试变得更加简单。可以通过简单地写入一个字符串来模拟传输，用这种方式来检查。</p>\n<h6 id=\"Protocols\"><a href=\"#Protocols\" class=\"headerlink\" title=\"Protocols\"></a>Protocols</h6><p>Protocols描述了如何以异步的方式处理网络中的事件。HTTP、DNS以及IMAP是应用层协议中的例子。Protocols实现了IProtocol接口，它包含如下的方法：</p>\n<blockquote>\n<p>makeConnection               在transport对象和服务器之间建立一条连接<br>connectionMade               连接建立起来后调用<br>dataReceived                 接收数据时调用<br>connectionLost               关闭连接时调用</p>\n</blockquote>\n<p>我们最好以一个例子来说明reactor、protocols以及transports这三者之间的关系。以下是完整的echo服务器和客户端的实现，首先来看看服务器部分：</p>\n<pre><code class=\"python\">from twisted.internet import protocol, reactor\n\nclass Echo(protocol.Protocol):\n    def dataReceived(self, data):\n        # As soon as any data is received, write it back\n        self.transport.write(data)\n\nclass EchoFactory(protocol.Factory):\n    def buildProtocol(self, addr):\n        return Echo()\n\nreactor.listenTCP(8000, EchoFactory())\nreactor.run()</code></pre>\n<p>接着是客户端部分：</p>\n<pre><code class=\"python\">from twisted.internet import reactor, protocol\n\nclass EchoClient(protocol.Protocol):\n    def connectionMade(self):\n        self.transport.write(&quot;hello, world!&quot;)\n\ndef dataReceived(self, data):\n    print &quot;Server said:&quot;, data\n        self.transport.loseConnection()\n\ndef connectionLost(self, reason):\n    print &quot;connection lost&quot;\n\nclass EchoFactory(protocol.ClientFactory):\n    def buildProtocol(self, addr):\n        return EchoClient()\n\ndef clientConnectionFailed(self, connector, reason):\n    print &quot;Connection failed - goodbye!&quot;\n        reactor.stop()\n\ndef clientConnectionLost(self, connector, reason):\n    print &quot;Connection lost - goodbye!&quot;\n        reactor.stop()\n\nreactor.connectTCP(&quot;localhost&quot;, 8000, EchoFactory())\nreactor.run()</code></pre>\n<p>运行服务器端脚本将启动一个TCP服务器，监听端口8000上的连接。服务器采用的是Echo协议，数据经TCP transport对象写出。运行客户端脚本将对服务器发起一个TCP连接，回显服务器端的回应然后终止连接并停止reactor事件循环。这里的Factory用来对连接的双方生成protocol对象实例。两端的通信是异步的，connectTCP负责注册回调函数到reactor事件循环中，当socket上有数据可读时通知回调处理。</p>\n<h6 id=\"Applications\"><a href=\"#Applications\" class=\"headerlink\" title=\"Applications\"></a>Applications</h6><p>Twisted是用来创建具有可扩展性、跨平台的网络服务器和客户端的引擎。在生产环境中，以标准化的方式简化部署这些应用的过程对于Twisted这种被广泛采用的平台来说是非常重要的一环。为此，Twisted开发了一套应用程序基础组件，采用可重用、可配置的方式来部署Twisted应用。这种方式使程序员避免堆砌千篇一律的代码来将应用程序同已有的工具整合在一起，这包括精灵化进程（daemonization）、日志处理、使用自定义的reactor循环、对代码做性能剖析等。</p>\n<p>应用程序基础组件包含4个主要部分：服务（Service）、应用（Application）、配置管理（通过TAC文件和插件）以及twistd命令行程序。为了说明这个基础组件，我们将上一节的Echo服务器转变成一个应用。</p>\n<ul>\n<li><strong>Service</strong><br>Service就是IService接口下实现的可以启动和停止的组件。Twisted自带有TCP、FTP、HTTP、SSH、DNS等服务以及其他协议的实现。其中许多Service都可以注册到单独的应用中。IService接口的核心是：<blockquote>\n<p>startService    启动服务。可能包含加载配置数据，设定数据库连接或者监听某个端口<br>stopService     关闭服务。可能包含将状态保存到磁盘，关闭数据库连接或者停止监听端口</p>\n</blockquote>\n</li>\n</ul>\n<p>我们的Echo服务使用TCP协议，因此我们可以使用Twisted中IService接口下默认的TCPServer实现。</p>\n<ul>\n<li><strong>Application</strong><br>Application是处于最顶层的Service，代表了整个Twisted应用程序。Service需要将其自身同Application注册，然后就可以用下面我们将介绍的部署工具twistd搜索并运行应用程序。我们将创建一个可以同Echo Service注册的Echo应用。</li>\n<li><strong>TAC文件</strong><br>当在一个普通的Python文件中管理Twisted应用程序时，需要由开发者负责编写启动和停止reactor事件循环以及配置应用程序的代码。在Twisted的基础组件中，协议的实现都是在一个模块中完成的，需要使用到这些协议的Service可以注册到一个Twisted应用程序配置文件中（TAC文件）去，这样reactor事件循环和程序配置就可以由外部组件来进行管理。</li>\n</ul>\n<p>要将我们的Echo服务器转变成一个Echo应用，我们可以按照以下几个简单的步骤来完成：</p>\n<ol>\n<li><p>将Echo服务器的Protocol部分移到它们自己所归属的模块中去。</p>\n</li>\n<li><p>在TAC文件中：</p>\n<ol>\n<li>创建一个Echo应用。</li>\n<li>创建一个TCPServer的Service实例，它将使用我们的EchoFactory，然后同前面创建的应用完成注册。</li>\n</ol>\n</li>\n</ol>\n<p>管理reactor事件循环的代码将由twistd来负责，我们下面会对此进行讨论。这样，应用程序的代码就变成这样了：<br>echo.py文件：</p>\n<pre><code class=\"python\">from twisted.internet import protocol, reactor\n\nclass Echo(protocol.Protocol):\n    def dataReceived(self, data):\n        self.transport.write(data)\n\nclass EchoFactory(protocol.Factory):\n    def buildProtocol(self, addr):\n        return Echo()</code></pre>\n<ul>\n<li><strong>twistd</strong><br>twistd（读作“twist-dee”）是一个跨平台的用来部署Twisted应用程序的工具。它执行TAC文件并负责处理启动和停止应用程序。作为Twisted在网络编程中具有“内置电池”能力的一部分，twistd自带有一些非常有用的配置标志，包括将应用程序转变为守护进程、定义日志文件的路径、设定特权级别、在chroot下运行、使用非默认的reactor，甚至是在profiler下运行应用程序。</li>\n</ul>\n<p>我们可以像这样运行这个Echo服务应用：</p>\n<pre><code class=\"python\">$ twistd –y echo_server.tac</code></pre>\n<p>在这个简单的例子里，twistd将这个应用程序作为守护进程来启动，日志记录在twistd.log文件中。启动和停止应用后，日志文件内容如下：</p>\n<pre><code class=\"python\">2011-11-19 22:23:07-0500 [-] Log opened.\n2011-11-19 22:23:07-0500 [-] twistd 11.0.0 (/usr/bin/python 2.7.1) starting up.\n2011-11-19 22:23:07-0500 [-] reactor class: twisted.internet.selectreactor.SelectReactor.\n2011-11-19 22:23:07-0500 [-] echo.EchoFactory starting on 8000\n2011-11-19 22:23:07-0500 [-] Starting factory &lt;echo.EchoFactory instance at 0x12d8670&gt;\n2011-11-19 22:23:20-0500 [-] Received SIGTERM, shutting down.\n2011-11-19 22:23:20-0500 [-] (TCP Port 8000 Closed)\n2011-11-19 22:23:20-0500 [-] Stopping factory &lt;echo.EchoFactory instance at 0x12d8670&gt;\n2011-11-19 22:23:20-0500 [-] Main loop terminated.\n2011-11-19 22:23:20-0500 [-] Server Shut Down.</code></pre>\n<p>通过使用Twisted框架中的基础组件来运行服务，这么做使得开发人员能够不用再编写类似守护进程和记录日志这样的冗余代码了。这同样也为部署应用程序建立了一个标准的命令行接口。</p>\n<h6 id=\"Plugins\"><a href=\"#Plugins\" class=\"headerlink\" title=\"Plugins\"></a>Plugins</h6><p>对于运行Twisted应用程序的方法，除了基于TAC文件外还有一种可选的方法，这就是插件系统。TAC系统可以很方便的将Twisted预定义的服务同应用程序配置文件注册，而插件系统能够方便的将用户自定义的服务注册为twistd工具的子命令，然后扩展应用程序的命令行接口。</p>\n<p>在使用插件系统时：</p>\n<ol>\n<li><p>由于只有plugin API需要保持稳定，这使得第三方开发者能很容易地扩展软件。</p>\n</li>\n<li><p>插件发现能力已经集成到系统中了。插件可以在程序首次运行时加载并保存，每次程序启动时会重新触发插件发现过程，或者也可以在程序运行期间反复轮询新插件，这使得在程序已经启动后我们还可以判断是否有新的插件安装上了。</p>\n</li>\n</ol>\n<p>当使用Twisted插件系统来扩展软件时，我们要做的就是创建IPlugin接口下实现的对象并将它们放到一个特定的位置中，这里插件系统知道该如何去找到它们。</p>\n<p>我们已经将Echo服务转换为一个Twisted应用程序了，而将其转换为一个Twisted插件也是非常简单直接的。在我们之前的Echo模块中，除了包含有Echo协议和EchoFactory的定义之外，现在我们还要添加一个名为twistd的目录，其中还包含着一个名为plugins的子目录，这里正是我们需要定义echo插件的地方。通过这个插件，我们可以启动一个echo服务，并将需要使用的端口号作为参数指定给twistd工具。</p>\n<pre><code class=\"python\">from zope.interface import implements\n\nfrom twisted.python import usage\nfrom twisted.plugin import IPlugin\nfrom twisted.application.service import IServiceMaker\nfrom twisted.application import internet\n\nfrom echo import EchoFactory\n\nclass Options(usage.Options):\n    optParameters = [[&quot;port&quot;, &quot;p&quot;, 8000, &quot;The port number to listen on.&quot;]]\n\nclass EchoServiceMaker(object):\n    implements(IServiceMaker, IPlugin)\n    tapname = &quot;echo&quot;\n    description = &quot;A TCP-based echo server.&quot;\n    options = Options\n\ndef makeService(self, options):\n    &quot;&quot;&quot;\n    Construct a TCPServer from a factory defined in myproject.\n    &quot;&quot;&quot;\n    return internet.TCPServer(int(options[&quot;port&quot;]), EchoFactory())\n\nserviceMaker = EchoServiceMaker()</code></pre>\n<p>现在，我们的Echo服务器将作为一个服务选项出现在twistd –help的输出中。运行twistd echo –port=1235将在端口1235上启动一个Echo服务器。</p>\n<p>Twisted还带有一个可拔插的针对服务器端认证的模块twisted.cred，插件系统常见的用途就是为应用程序添加一个认证模式。我们可以使用twisted.cred中现成的AuthOptionMixin类来添加针对各种认证的命令行支持，或者是添加新的认证类型。比如，我们可以使用插件系统来添加基于本地Unix密码数据库或者是基于LDAP服务器的认证方式。</p>\n<p>twistd工具中附带有许多Twisted所支持的协议插件，只用一条单独的命令就可以完成启动服务器的工作了。这里有一些通过twistd启动服务器的例子：</p>\n<pre><code class=\"python\">twistd web –port 8080 –path .</code></pre>\n<p>这条命令将在8080端口启动一个HTTP服务器，在当前目录中负责处理静态和动态页面请求。</p>\n<pre><code class=\"python\">twistd dns –p 5553 –hosts-file=hosts</code></pre>\n<p>这条命令在端口5553上启动一个DNS服务器，解析指定的文件hosts中的域名，这个文件的内容格式同/etc/hosts一样。</p>\n<pre><code class=\"python\">sudo twistd conch –p tcp:2222</code></pre>\n<p>这条命令在端口2222上启动一个SSH服务器。ssh的密钥必须独立设定。</p>\n<pre><code class=\"python\">twistd mail –E –H localhost –d localhost=emails</code></pre>\n<p>这条命令启动一个ESMTP POP3服务器，为本地主机接收邮件并保存到指定的emails目录下。</p>\n<p>我们可以方便的通过twistd来搭建一个用于测试客户端功能的服务器，但它同样是可装载的、产品级的服务器实现。</p>\n<p>在部署应用程序的方式上，Twisted通过TAC文件、插件以及命令行工具twistd的部署方式已经获得了成功。但是有趣的是，对于大多数大型Twisted应用程序来说，部署它们仍然需要重写一些这类管理和监控组件；Twisted的架构并没有对系统管理员的需求呈现出太多的友好性。这也反映了一个事实，那就是对于系统管理员来说Twisted历来就没有太多架构可言，而这些系统管理员才是部署和维护应用程序的专家。在这方面，Twisted在未来架构设计的决策上需要更积极的征求这类专家级用户的反馈意见。</p>\n<p><a href=\"https://www.cnblogs.com/xianguang/p/7027661.html\" target=\"_blank\" rel=\"noopener\">本文内容引用自此处</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"Twisted\"><a href=\"#Twisted\" class=\"headerlink\" title=\"Twisted\"></a>Twisted</h2><h3 id=\"Python-Twisted介绍\"><a href=\"#Python-Twisted介绍\" class=\"headerlink\" title=\"Python Twisted介绍\"></a>Python Twisted介绍</h3><p>Twisted是用Python实现的基于事件驱动的网络引擎框架。Twisted诞生于2000年初，在当时的网络游戏开发者看来，无论他们使用哪种语言，手中都鲜有可兼顾扩展性及跨平台的网络库。Twisted的作者试图在当时现有的环境下开发游戏，这一步走的非常艰难，他们迫切地需要一个可扩展性高、基于事件驱动、跨平台的网络开发框架，为此他们决定自己实现一个，并从那些之前的游戏和网络应用程序的开发者中学习，汲取他们的经验教训。</p>\n<p>Twisted支持许多常见的传输及应用层协议，包括TCP、UDP、SSL/TLS、HTTP、IMAP、SSH、IRC以及FTP。就像python一样，Twisted也具有“内置电池”（batteries-included）的特点。Twisted对于其支持的所有协议都带有客户端和服务器实现，同时附带有基于命令行的工具，使得配置和部署产品级的Twisted应用变得非常方便。</p>\n<h3 id=\"为什么需要Twisted\"><a href=\"#为什么需要Twisted\" class=\"headerlink\" title=\"为什么需要Twisted\"></a>为什么需要Twisted</h3><p>2000年时，Twisted的作者Glyph正在开发一个名为Twisted Reality的基于文本方式的多人在线游戏。这个游戏采用Java开发，里面尽是一堆线程——每个连接就有3个线程处理。处理输入的线程会在读操作上阻塞，处理输出的线程将在一些写操作上阻塞，还有一个“逻辑”线程将在等待定时器超时或者事件入队列时休眠。随着玩家们在虚拟世界中移动并交互时，线程出现死锁，缓存被污染，程序中的加锁逻辑几乎从来就没对过——采用多线程使得整个软件变得复杂、漏洞百出而且极难扩展。</p>\n<p>为了寻求其他的解决方案，作者发现了Python，特别是Python中用于对流式对象比如socket和pipe进行多路I/O复用的select模块（UNIX规范第3版（SUSv3）描述了select）。那时，Java并没有提供操作系统的select接口或者任何其他的异步I/O API（针对非阻塞式I/O的包java.nio已经在J2SE 1.4中加入了，2002年发布）。通过用Python中的select模块快速搭建起游戏的原型，这迅速降低了程序的复杂度，并且比多线程版本要更加可靠。</p>\n<p>Glyph迅速转向了Python、select以及基于事件驱动的编程。他使用Python的select模块为游戏编写了客户端和服务器。但他想要的还不止于此。从根本上说，他希望能将网络行为转变为对游戏中的对象的方法调用。如果你能在游戏中收取邮件会怎样，就像Nethack mailer这种守护进程一样？如果游戏中的每位玩家都拥有一个主页呢？Glyph发现他需要优秀的IMAP以及HTTP客户端和服务器的Python实现，而这些都要采用select。</p>\n<p>他首先转向了Medusa，这是一个在90年代中期开发的平台，在这里可以采用Python中的asyncore模块来编写网络服务。asyncore是一个异步化处理socket的模块，在操作系统的select API之上构建了一个调度器和回调接口。</p>\n<p>这对于Glyph来说是个激动人心的发现，但Medusa有两个缺点：</p>\n<ol>\n<li>这个项目到2001年就不再维护了，那正是glyph开发Twisted Reality的时候。</li>\n<li>asyncore只是对socket的一个薄封装层，应用程序的编写者仍然需要直接操作socket。这意味着程序可移植性的担子仍然落在程序员自己身上。此外，那时asyncore对Windows的支持还有问题，Glyph希望能在Windows上运行一个带有图形用户界面的客户端。<br>Glyph需要自己实现一个网络引擎平台，而且他意识到Twisted Reality已经打开了问题的大门，这和他的游戏一样有趣。</li>\n</ol>\n<p>随着时间的推移，Twisted Reality这个游戏就演化成了Twisted网络引擎平台。它可以做到当时Python中已有的网络平台所无法做到的事情：</p>\n<ul>\n<li>使用基于事件驱动的编程模型，而不是多线程模型。</li>\n<li>跨平台：为主流操作系统平台暴露出的事件通知系统提供统一的接口。</li>\n<li>“内置电池”的能力：提供流行的应用层协议实现，因此Twisted马上就可为开发人员所用。</li>\n<li>符合RFC规范，已经通过健壮的测试套件证明了其一致性。</li>\n<li>能很容易的配合多个网络协议一起使用。</li>\n<li>可扩展。</li>\n</ul>\n<h3 id=\"Twisted架构概览\"><a href=\"#Twisted架构概览\" class=\"headerlink\" title=\"Twisted架构概览\"></a>Twisted架构概览</h3><p>Twisted是一个事件驱动型的网络引擎。由于事件驱动编程模型在Twisted的设计哲学中占有重要的地位，因此这里有必要花点时间来回顾一下究竟事件驱动意味着什么。</p>\n<p>事件驱动编程是一种编程范式，这里程序的执行流由外部事件来决定。它的特点是包含一个事件循环，当外部事件发生时使用回调机制来触发相应的处理。另外两种常见的编程范式是（单线程）同步以及多线程编程。</p>\n<p>在单线程同步模型中，任务按照顺序执行。如果某个任务因为I/O而阻塞，其他所有的任务都必须等待，直到它完成之后它们才能依次执行。这种明确的执行顺序和串行化处理的行为是很容易推断得出的。如果任务之间并没有互相依赖的关系，但仍然需要互相等待的话这就使得程序不必要的降低了运行速度。</p>\n<p>在多线程版本中，这3个任务分别在独立的线程中执行。这些线程由操作系统来管理，在多处理器系统上可以并行处理，或者在单处理器系统上交错执行。这使得当某个线程阻塞在某个资源的同时其他线程得以继续执行。与完成类似功能的同步程序相比，这种方式更有效率，但程序员必须写代码来保护共享资源，防止其被多个线程同时访问。多线程程序更加难以推断，因为这类程序不得不通过线程同步机制如锁、可重入函数、线程局部存储或者其他机制来处理线程安全问题，如果实现不当就会导致出现微妙且令人痛不欲生的bug。</p>\n<p>在事件驱动版本的程序中，3个任务<strong>交错执行</strong>，但仍然在一个单独的线程控制中。当处理I/O或者其他昂贵的操作时，注册一个回调到事件循环中，然后当I/O操作完成时继续执行。回调描述了该如何处理某个事件。事件循环轮询所有的事件，当事件到来时将它们分配给等待处理事件的回调函数。这种方式让程序尽可能的得以执行而不需要用到额外的线程。事件驱动型程序比多线程程序更容易推断出行为，因为程序员不需要关心线程安全问题。</p>\n<p>当我们面对如下的环境时，事件驱动模型通常是一个好的选择：</p>\n<p>程序中有许多任务，而且…</p>\n<ol>\n<li>任务之间高度独立（因此它们不需要互相通信，或者等待彼此）而且…</li>\n<li>在等待事件到来时，某些任务会阻塞。</li>\n<li>当应用程序需要在任务间共享可变的数据时，这也是一个不错的选择，因为这里不需要采用同步处理。</li>\n</ol>\n<p>网络应用程序通常都有上述这些特点，这使得它们能够很好的契合事件驱动编程模型。</p>\n<h6 id=\"重用已有的应用\"><a href=\"#重用已有的应用\" class=\"headerlink\" title=\"重用已有的应用\"></a><strong>重用已有的应用</strong></h6><p>在Twisted创建之前就已经有了许多针对多种流行的网络协议的客户端和服务器实现了。为什么Glyph不直接用Apache、IRCd、BIND、OpenSSH或者任何其他已有的应用，而要为Twisted从头开始重新实现各个协议的客户端和服务器呢？</p>\n<p>问题在于所有这些已有的实现都存在有从头写起的网络层代码，通常都是C代码。而应用层代码直接同网络层耦合在一起，这使得它们非常难以以库的形式来复用。当要一起使用这些组件时，如果希望在多个协议中暴露相同的数据，则它们必须以黑盒的形式来看待，这使得开发者根本没机会重用代码。此外，服务器和客户端的实现通常是分离的，彼此之间不共享代码。要扩展这些应用，维护跨平台的客户端-服务器兼容性的难度本不至于这么大。</p>\n<p>Twisted中的客户端和服务器是用Python开发的，采用了一致性的接口。这使得开发新的客户端和服务器变得很容易实现，可以在客户端和服务器之间共享代码，在协议之间共享应用逻辑，以及对某个实现的代码做测试。</p>\n<h6 id=\"React模式\"><a href=\"#React模式\" class=\"headerlink\" title=\"React模式\"></a><strong>React模式</strong></h6><p>Twisted实现了设计模式中的反应堆（reactor）模式，这种模式在单线程环境中调度多个事件源产生的事件到它们各自的事件处理例程中去。</p>\n<p>Twisted的核心就是reactor事件循环。Reactor可以感知网络、文件系统以及定时器事件。它等待然后处理这些事件，从特定于平台的行为中抽象出来，并提供统一的接口，使得在网络协议栈的任何位置对事件做出响应都变得简单。</p>\n<p>基本上reactor完成的任务就是：</p>\n<pre><code class=\"python\">while True:\n    timeout = time_until_next_timed_event()\n    events = wait_for_events(timeout)\n    events += timed_events_until(now())\n    for event in events:\n        event.process()</code></pre>\n<p>Twisted目前在所有平台上的默认reactor都是基于poll API的（UNIX规范第3版（SUSv3）中描述）。此外，Twisted还支持一些特定于平台的高容量多路复用API。这些reactor包括基于FreeBSD中kqueue机制的KQueue reactor，支持epoll接口的系统（目前是Linux 2.6）中的epoll reactor，以及基于Windows下的输入输出完成端口的IOCP reactor。</p>\n<p>在实现轮询的相关细节中，Twisted需要考虑的包括：</p>\n<ul>\n<li>网络和文件系统的限制</li>\n<li>缓冲行为</li>\n<li>如何检测连接丢失</li>\n<li>出现错误时的返回值</li>\n</ul>\n<p>Twisted的reactor实现同时也考虑了正确使用底层的非阻塞式API，并正确处理各种边界情况。由于Python中没有暴露出IOCP API，因此Twisted需要维护自己的实现。</p>\n<h6 id=\"管理回调链\"><a href=\"#管理回调链\" class=\"headerlink\" title=\"管理回调链\"></a><strong>管理回调链</strong></h6><p>回调是事件驱动编程模型中的基础，也是reactor通知应用程序事件已经处理完成的方式。随着程序规模不断扩大，基于事件驱动的程序需要同时处理事件处理成功和出错的情况，这使得程序变得越来越复杂。若没有注册一个合适的回调，程序就会阻塞，因为这个事件处理的过程绝不会发生。出现错误时需要通过应用程序的不同层次从网络栈向上传递回调链。</p>\n<p>下面是两段Python伪码，分别是同步和异步模式下获取URL的玩具代码。让我们相互比较一下这两个版本，看看基于事件驱动的程序有什么缺陷：</p>\n<p>以同步的方式获取URL：</p>\n<pre><code class=\"python\">import getPage\n\ndef processPage(page):\n    print page\n\ndef logError(error):\n    print error\n\ndef finishProcessing(value):\n    print &quot;Shutting down...&quot;\n    exit(0)\n\nurl = &quot;http://google.com&quot;\ntry:\n    page = getPage(url)\n    processPage(page)\nexcept Error, e:\n    logError(error)\nfinally:\n    finishProcessing()</code></pre>\n<p>以异步的方式获取URL：</p>\n<pre><code class=\"python\">from twisted.internet import reactor\nimport getPage\n\ndef processPage(page):\n    print page\n    finishProcessing()\n\ndef logError(error):\n    print error\n    finishProcessing()\n\ndef finishProcessing(value):\n    print &quot;Shutting down...&quot;\n    reactor.stop()\n\nurl = &quot;http://google.com&quot;\n# getPage takes: url, \n# success callback, error callback\ngetPage(url, processPage, logError)\n\nreactor.run()</code></pre>\n<p>在异步版的URL获取器中，reactor.run()启动reactor事件循环。在同步和异步版程序中，我们假定getPage函数处理获取页面的工作。如果获取成功就调用processPage，如果尝试获取页面时出现了Exception（异常），logError就得到调用。无论哪种情况，最后都要调用finishProcessing。</p>\n<p>异步版中的logError回调正对应于同步版中的try/except块。对processPage的回调对应于else块，无条件回调的finishProcessing就对应于finally块。</p>\n<p>在同步版中，代码结构直接显示出有一个try/except块，logError和processPage这两者间只会取其一调用一次，而finishProcessing总是会被调用一次。在异步版中需要由程序员自己负责正确调用成功和失败情况下的回调链。如果由于编程错误，在processPage或者logError的回调链之后没有调用finishProcessing，reactor事件循环将永远不会停止，程序就会卡住。</p>\n<p>这个玩具式的例子告诉我们在开发Twisted的头几年里这种复杂性令程序员感到非常沮丧。而Twisted应对这种复杂性的方式是新增一个称为Deferred（延迟）的对象。</p>\n<h6 id=\"Deferreds\"><a href=\"#Deferreds\" class=\"headerlink\" title=\"Deferreds\"></a>Deferreds</h6><p>Deferred对象以抽象化的方式表达了一种思想，即结果还尚不存在。它同样能够帮助管理产生这个结果所需要的回调链。当从函数中返回时，Deferred对象承诺在某个时刻函数将产生一个结果。返回的Deferred对象中包含所有注册到事件上的回调引用，因此在函数间只需要传递这一个对象即可，跟踪这个对象比单独管理所有的回调要简单的多。</p>\n<p>Deferred对象包含一对回调链，一个是针对操作成功的回调，一个是针对操作失败的回调。初始状态下Deferred对象的两条链都为空。在事件处理的过程中，每个阶段都为其添加处理成功的回调和处理失败的回调。当一个异步结果到来时，Deferred对象就被“激活”，那么处理成功的回调和处理失败的回调就可以以合适的方式按照它们添加进来的顺序依次得到调用。</p>\n<p>异步版URL获取器采用Deferred对象后的代码如下：</p>\n<pre><code class=\"python\">from twisted.internet import reactor\nimport getPage\n\ndef processPage(page):\n    print page\n\ndef logError(error):\n    print error\n\ndef finishProcessing(value):\n    print &quot;Shutting down...&quot;\n    reactor.stop()\n\nurl = &quot;http://google.com&quot;\ndeferred = getPage(url) # getPage returns a Deferred\ndeferred.addCallbacks(success, failure)\ndeferred.addBoth(stop)\n\nreactor.run()</code></pre>\n<p>在这个版本中调用的事件处理函数与之前相同，但它们都注册到了一个单独的Deferred对象上，而不是分散在代码各处再以参数形式传递给getPage。</p>\n<p>Deferred对象创建时包含两个添加回调的阶段。第一阶段，addCallbacks将 processPage和logError添加到它们各自归属的回调链中。然后addBoth再将finishProcessing同时添加到这两个回调链上。用图解的方式来看，回调链应该如图所示：<br><img src=\"/img/1570783134086.png\" alt=\"Deferred 流程示例\"></p>\n<p>Deferred对象只能被激活一次，如果试图重复激活将引发一个异常。这使得Deferred对象的语义相当接近于同步版中的try/except块。从而让异步事件的处理能更容易推断，避免由于针对单个事件的回调调用多了一个或少了一个而产生微妙的bug。</p>\n<p>理解Deferred对象对于理解Twisted程序的执行流是非常重要的。然而当使用Twisted为我们提供的针对网络协议的高层抽象时，通常情况下我们完全不需要直接使用Deferred对象。</p>\n<p>Deferred对象所包含的抽象概念是非常强大的，这种思想已经被许多其他的事件驱动平台所借用，包括jQuery、Dojo和Mochikit。</p>\n<h6 id=\"Transports\"><a href=\"#Transports\" class=\"headerlink\" title=\"Transports\"></a>Transports</h6><p>Transports代表网络中两个通信结点之间的连接。Transports负责描述连接的细节，比如连接是面向流式的还是面向数据报的，流控以及可靠性。TCP、UDP和Unix套接字可作为transports的例子。它们被设计为“满足最小功能单元，同时具有最大程度的可复用性”，而且从协议实现中分离出来，这让许多协议可以采用相同类型的传输。Transports实现了ITransports接口，它包含如下的方法：</p>\n<blockquote>\n<p>write                   以非阻塞的方式按顺序依次将数据写到物理连接上<br>writeSequence           将一个字符串列表写到物理连接上<br>loseConnection          将所有挂起的数据写入，然后关闭连接<br>getPeer                 取得连接中对端的地址信息<br>getHost                 取得连接中本端的地址信息</p>\n</blockquote>\n<p>将transports从协议中分离出来也使得对这两个层次的测试变得更加简单。可以通过简单地写入一个字符串来模拟传输，用这种方式来检查。</p>\n<h6 id=\"Protocols\"><a href=\"#Protocols\" class=\"headerlink\" title=\"Protocols\"></a>Protocols</h6><p>Protocols描述了如何以异步的方式处理网络中的事件。HTTP、DNS以及IMAP是应用层协议中的例子。Protocols实现了IProtocol接口，它包含如下的方法：</p>\n<blockquote>\n<p>makeConnection               在transport对象和服务器之间建立一条连接<br>connectionMade               连接建立起来后调用<br>dataReceived                 接收数据时调用<br>connectionLost               关闭连接时调用</p>\n</blockquote>\n<p>我们最好以一个例子来说明reactor、protocols以及transports这三者之间的关系。以下是完整的echo服务器和客户端的实现，首先来看看服务器部分：</p>\n<pre><code class=\"python\">from twisted.internet import protocol, reactor\n\nclass Echo(protocol.Protocol):\n    def dataReceived(self, data):\n        # As soon as any data is received, write it back\n        self.transport.write(data)\n\nclass EchoFactory(protocol.Factory):\n    def buildProtocol(self, addr):\n        return Echo()\n\nreactor.listenTCP(8000, EchoFactory())\nreactor.run()</code></pre>\n<p>接着是客户端部分：</p>\n<pre><code class=\"python\">from twisted.internet import reactor, protocol\n\nclass EchoClient(protocol.Protocol):\n    def connectionMade(self):\n        self.transport.write(&quot;hello, world!&quot;)\n\ndef dataReceived(self, data):\n    print &quot;Server said:&quot;, data\n        self.transport.loseConnection()\n\ndef connectionLost(self, reason):\n    print &quot;connection lost&quot;\n\nclass EchoFactory(protocol.ClientFactory):\n    def buildProtocol(self, addr):\n        return EchoClient()\n\ndef clientConnectionFailed(self, connector, reason):\n    print &quot;Connection failed - goodbye!&quot;\n        reactor.stop()\n\ndef clientConnectionLost(self, connector, reason):\n    print &quot;Connection lost - goodbye!&quot;\n        reactor.stop()\n\nreactor.connectTCP(&quot;localhost&quot;, 8000, EchoFactory())\nreactor.run()</code></pre>\n<p>运行服务器端脚本将启动一个TCP服务器，监听端口8000上的连接。服务器采用的是Echo协议，数据经TCP transport对象写出。运行客户端脚本将对服务器发起一个TCP连接，回显服务器端的回应然后终止连接并停止reactor事件循环。这里的Factory用来对连接的双方生成protocol对象实例。两端的通信是异步的，connectTCP负责注册回调函数到reactor事件循环中，当socket上有数据可读时通知回调处理。</p>\n<h6 id=\"Applications\"><a href=\"#Applications\" class=\"headerlink\" title=\"Applications\"></a>Applications</h6><p>Twisted是用来创建具有可扩展性、跨平台的网络服务器和客户端的引擎。在生产环境中，以标准化的方式简化部署这些应用的过程对于Twisted这种被广泛采用的平台来说是非常重要的一环。为此，Twisted开发了一套应用程序基础组件，采用可重用、可配置的方式来部署Twisted应用。这种方式使程序员避免堆砌千篇一律的代码来将应用程序同已有的工具整合在一起，这包括精灵化进程（daemonization）、日志处理、使用自定义的reactor循环、对代码做性能剖析等。</p>\n<p>应用程序基础组件包含4个主要部分：服务（Service）、应用（Application）、配置管理（通过TAC文件和插件）以及twistd命令行程序。为了说明这个基础组件，我们将上一节的Echo服务器转变成一个应用。</p>\n<ul>\n<li><strong>Service</strong><br>Service就是IService接口下实现的可以启动和停止的组件。Twisted自带有TCP、FTP、HTTP、SSH、DNS等服务以及其他协议的实现。其中许多Service都可以注册到单独的应用中。IService接口的核心是：<blockquote>\n<p>startService    启动服务。可能包含加载配置数据，设定数据库连接或者监听某个端口<br>stopService     关闭服务。可能包含将状态保存到磁盘，关闭数据库连接或者停止监听端口</p>\n</blockquote>\n</li>\n</ul>\n<p>我们的Echo服务使用TCP协议，因此我们可以使用Twisted中IService接口下默认的TCPServer实现。</p>\n<ul>\n<li><strong>Application</strong><br>Application是处于最顶层的Service，代表了整个Twisted应用程序。Service需要将其自身同Application注册，然后就可以用下面我们将介绍的部署工具twistd搜索并运行应用程序。我们将创建一个可以同Echo Service注册的Echo应用。</li>\n<li><strong>TAC文件</strong><br>当在一个普通的Python文件中管理Twisted应用程序时，需要由开发者负责编写启动和停止reactor事件循环以及配置应用程序的代码。在Twisted的基础组件中，协议的实现都是在一个模块中完成的，需要使用到这些协议的Service可以注册到一个Twisted应用程序配置文件中（TAC文件）去，这样reactor事件循环和程序配置就可以由外部组件来进行管理。</li>\n</ul>\n<p>要将我们的Echo服务器转变成一个Echo应用，我们可以按照以下几个简单的步骤来完成：</p>\n<ol>\n<li><p>将Echo服务器的Protocol部分移到它们自己所归属的模块中去。</p>\n</li>\n<li><p>在TAC文件中：</p>\n<ol>\n<li>创建一个Echo应用。</li>\n<li>创建一个TCPServer的Service实例，它将使用我们的EchoFactory，然后同前面创建的应用完成注册。</li>\n</ol>\n</li>\n</ol>\n<p>管理reactor事件循环的代码将由twistd来负责，我们下面会对此进行讨论。这样，应用程序的代码就变成这样了：<br>echo.py文件：</p>\n<pre><code class=\"python\">from twisted.internet import protocol, reactor\n\nclass Echo(protocol.Protocol):\n    def dataReceived(self, data):\n        self.transport.write(data)\n\nclass EchoFactory(protocol.Factory):\n    def buildProtocol(self, addr):\n        return Echo()</code></pre>\n<ul>\n<li><strong>twistd</strong><br>twistd（读作“twist-dee”）是一个跨平台的用来部署Twisted应用程序的工具。它执行TAC文件并负责处理启动和停止应用程序。作为Twisted在网络编程中具有“内置电池”能力的一部分，twistd自带有一些非常有用的配置标志，包括将应用程序转变为守护进程、定义日志文件的路径、设定特权级别、在chroot下运行、使用非默认的reactor，甚至是在profiler下运行应用程序。</li>\n</ul>\n<p>我们可以像这样运行这个Echo服务应用：</p>\n<pre><code class=\"python\">$ twistd –y echo_server.tac</code></pre>\n<p>在这个简单的例子里，twistd将这个应用程序作为守护进程来启动，日志记录在twistd.log文件中。启动和停止应用后，日志文件内容如下：</p>\n<pre><code class=\"python\">2011-11-19 22:23:07-0500 [-] Log opened.\n2011-11-19 22:23:07-0500 [-] twistd 11.0.0 (/usr/bin/python 2.7.1) starting up.\n2011-11-19 22:23:07-0500 [-] reactor class: twisted.internet.selectreactor.SelectReactor.\n2011-11-19 22:23:07-0500 [-] echo.EchoFactory starting on 8000\n2011-11-19 22:23:07-0500 [-] Starting factory &lt;echo.EchoFactory instance at 0x12d8670&gt;\n2011-11-19 22:23:20-0500 [-] Received SIGTERM, shutting down.\n2011-11-19 22:23:20-0500 [-] (TCP Port 8000 Closed)\n2011-11-19 22:23:20-0500 [-] Stopping factory &lt;echo.EchoFactory instance at 0x12d8670&gt;\n2011-11-19 22:23:20-0500 [-] Main loop terminated.\n2011-11-19 22:23:20-0500 [-] Server Shut Down.</code></pre>\n<p>通过使用Twisted框架中的基础组件来运行服务，这么做使得开发人员能够不用再编写类似守护进程和记录日志这样的冗余代码了。这同样也为部署应用程序建立了一个标准的命令行接口。</p>\n<h6 id=\"Plugins\"><a href=\"#Plugins\" class=\"headerlink\" title=\"Plugins\"></a>Plugins</h6><p>对于运行Twisted应用程序的方法，除了基于TAC文件外还有一种可选的方法，这就是插件系统。TAC系统可以很方便的将Twisted预定义的服务同应用程序配置文件注册，而插件系统能够方便的将用户自定义的服务注册为twistd工具的子命令，然后扩展应用程序的命令行接口。</p>\n<p>在使用插件系统时：</p>\n<ol>\n<li><p>由于只有plugin API需要保持稳定，这使得第三方开发者能很容易地扩展软件。</p>\n</li>\n<li><p>插件发现能力已经集成到系统中了。插件可以在程序首次运行时加载并保存，每次程序启动时会重新触发插件发现过程，或者也可以在程序运行期间反复轮询新插件，这使得在程序已经启动后我们还可以判断是否有新的插件安装上了。</p>\n</li>\n</ol>\n<p>当使用Twisted插件系统来扩展软件时，我们要做的就是创建IPlugin接口下实现的对象并将它们放到一个特定的位置中，这里插件系统知道该如何去找到它们。</p>\n<p>我们已经将Echo服务转换为一个Twisted应用程序了，而将其转换为一个Twisted插件也是非常简单直接的。在我们之前的Echo模块中，除了包含有Echo协议和EchoFactory的定义之外，现在我们还要添加一个名为twistd的目录，其中还包含着一个名为plugins的子目录，这里正是我们需要定义echo插件的地方。通过这个插件，我们可以启动一个echo服务，并将需要使用的端口号作为参数指定给twistd工具。</p>\n<pre><code class=\"python\">from zope.interface import implements\n\nfrom twisted.python import usage\nfrom twisted.plugin import IPlugin\nfrom twisted.application.service import IServiceMaker\nfrom twisted.application import internet\n\nfrom echo import EchoFactory\n\nclass Options(usage.Options):\n    optParameters = [[&quot;port&quot;, &quot;p&quot;, 8000, &quot;The port number to listen on.&quot;]]\n\nclass EchoServiceMaker(object):\n    implements(IServiceMaker, IPlugin)\n    tapname = &quot;echo&quot;\n    description = &quot;A TCP-based echo server.&quot;\n    options = Options\n\ndef makeService(self, options):\n    &quot;&quot;&quot;\n    Construct a TCPServer from a factory defined in myproject.\n    &quot;&quot;&quot;\n    return internet.TCPServer(int(options[&quot;port&quot;]), EchoFactory())\n\nserviceMaker = EchoServiceMaker()</code></pre>\n<p>现在，我们的Echo服务器将作为一个服务选项出现在twistd –help的输出中。运行twistd echo –port=1235将在端口1235上启动一个Echo服务器。</p>\n<p>Twisted还带有一个可拔插的针对服务器端认证的模块twisted.cred，插件系统常见的用途就是为应用程序添加一个认证模式。我们可以使用twisted.cred中现成的AuthOptionMixin类来添加针对各种认证的命令行支持，或者是添加新的认证类型。比如，我们可以使用插件系统来添加基于本地Unix密码数据库或者是基于LDAP服务器的认证方式。</p>\n<p>twistd工具中附带有许多Twisted所支持的协议插件，只用一条单独的命令就可以完成启动服务器的工作了。这里有一些通过twistd启动服务器的例子：</p>\n<pre><code class=\"python\">twistd web –port 8080 –path .</code></pre>\n<p>这条命令将在8080端口启动一个HTTP服务器，在当前目录中负责处理静态和动态页面请求。</p>\n<pre><code class=\"python\">twistd dns –p 5553 –hosts-file=hosts</code></pre>\n<p>这条命令在端口5553上启动一个DNS服务器，解析指定的文件hosts中的域名，这个文件的内容格式同/etc/hosts一样。</p>\n<pre><code class=\"python\">sudo twistd conch –p tcp:2222</code></pre>\n<p>这条命令在端口2222上启动一个SSH服务器。ssh的密钥必须独立设定。</p>\n<pre><code class=\"python\">twistd mail –E –H localhost –d localhost=emails</code></pre>\n<p>这条命令启动一个ESMTP POP3服务器，为本地主机接收邮件并保存到指定的emails目录下。</p>\n<p>我们可以方便的通过twistd来搭建一个用于测试客户端功能的服务器，但它同样是可装载的、产品级的服务器实现。</p>\n<p>在部署应用程序的方式上，Twisted通过TAC文件、插件以及命令行工具twistd的部署方式已经获得了成功。但是有趣的是，对于大多数大型Twisted应用程序来说，部署它们仍然需要重写一些这类管理和监控组件；Twisted的架构并没有对系统管理员的需求呈现出太多的友好性。这也反映了一个事实，那就是对于系统管理员来说Twisted历来就没有太多架构可言，而这些系统管理员才是部署和维护应用程序的专家。在这方面，Twisted在未来架构设计的决策上需要更积极的征求这类专家级用户的反馈意见。</p>\n<p><a href=\"https://www.cnblogs.com/xianguang/p/7027661.html\" target=\"_blank\" rel=\"noopener\">本文内容引用自此处</a></p>\n"},{"title":"Python Note 1","_content":"# Python Note 1\n\n+ ### while结构\n 注： \"\"\"  多行string\n \n```python\nn = 0\nwhile n < 5:\n\tprint(\"\"\"\nThis is test!\nThis is test2!\nThis is test3!\n\t\"\"\")\n\tn = n + 1\n```\n\n+ ### For结构\n * 普通使用\n \n ```python\n for i in range(5):\n \tprint()\n ```\n * Use curly braces, 显示变量\n\n```python\n for i in range(5):\n \tprint(f\"i:{i}\")\n ```\n * 使用重复*个数输出字符\n\n```python\n for i in range(5):\n \tprint(f\"i:{i}\"*4)\n ```\n\n+ ### List\n* 普遍用法\n\n```python\nnames = ['John', 'Bob', 'Mosh', 'Sarah', 'Mary']\nprint(names[2:])  #Print will start from 'Mosh'''\nprint(names[:])  #Print all'\nnames[0] = 'Joh' #Change item\nprint(names)  #output\n# 2d list\nmatrix = [\n   [1, 2, 3],\n    [4, 5, 6],\n    [7, 8, 9]\n]\nmatrix[0][-3] = 20\nprint(matrix)\n```\n\n* 编辑类\n\n```python\nnumbers = [5,2,1,7]\nnumbers.insert(-2,20)\nnumbers.remove(2)\nnumbers.append(45)\nnumbers.pop() #remove the last and return it\nprint(numbers.index(5))\nnumbers.sort()\nnumbers.reverse() #get deasc order\nif 5 in numbers:\n    print(numbers.index(5))\nnumbers2 = numbers.copy()\nnumbers.append(45)\nprint(numbers)\nprint(numbers2)\n\n#去重复\nnumbers = [5,20,1,5,7,5,6,4,5]\nuniques = []\nfor i in numbers:\n    if i not in uniques:\n        uniques.append(i)\nprint(uniques)\n```\n\n+ ### Tuple\n+ 类似于List，但不可修改\n\n```python\nnumbers = (5,20,1,5,7,5,6,4,5)\nnumbers[0] = 1 #TypeError: 'tuple' object does not support item assignment\n```\n\n+ ### Unpacking\n+ 映射数组成员\n\n```python\ncoordinates = (1,2,3)\na = coordinates[0]\nb = coordinates[1]\nc = coordinates[2]\n\n# use Unpacking feature, unpacking the tuple/list to three variable\nx, y, z = coordinates\nprint(f\"{a},{b},{c} <=> {x}, {y}, {z}\")\n```\n\n+ ### Dictionary\n\n```python\ncustomer = {\n    \"name\": \"John\",\n    \"age\": 30,\n    \"is_verified\": True\n}\nprint(customer[\"name\"])\n# print(customer[\"Name\"]) #KeyError,don't contain\n# print(customer[\"birthdate\"])#KeyError,don't contain\nprint(customer.get(\"name\"))\nprint(customer.get(\"Name\",\"Hey\")) #Print,with default value:'Hey'\ncustomer[\"name\"] = \"AA\"\nprint(customer.get(\"name\"))\n\n#Exercise\ninput_str = str(input(\"Phone:\"))\ndigits_map = {\n    \"1\":\"One\",\n    \"2\":\"Two\",\n    \"3\":\"Three\",\n    \"4\":\"Four\",\n}\noutput = ''\nfor s in input_str:\n    output += digits_map.get(s,\"\") + \" \"\n\nprint(output)\n```\n+ [mac]ctrl+cmd+space>> to show emojis","source":"_posts/python_1.md","raw":"---\ntitle: Python Note 1\ncategories:\n- Python笔记\ntags: \n- Python\n- Note\n---\n# Python Note 1\n\n+ ### while结构\n 注： \"\"\"  多行string\n \n```python\nn = 0\nwhile n < 5:\n\tprint(\"\"\"\nThis is test!\nThis is test2!\nThis is test3!\n\t\"\"\")\n\tn = n + 1\n```\n\n+ ### For结构\n * 普通使用\n \n ```python\n for i in range(5):\n \tprint()\n ```\n * Use curly braces, 显示变量\n\n```python\n for i in range(5):\n \tprint(f\"i:{i}\")\n ```\n * 使用重复*个数输出字符\n\n```python\n for i in range(5):\n \tprint(f\"i:{i}\"*4)\n ```\n\n+ ### List\n* 普遍用法\n\n```python\nnames = ['John', 'Bob', 'Mosh', 'Sarah', 'Mary']\nprint(names[2:])  #Print will start from 'Mosh'''\nprint(names[:])  #Print all'\nnames[0] = 'Joh' #Change item\nprint(names)  #output\n# 2d list\nmatrix = [\n   [1, 2, 3],\n    [4, 5, 6],\n    [7, 8, 9]\n]\nmatrix[0][-3] = 20\nprint(matrix)\n```\n\n* 编辑类\n\n```python\nnumbers = [5,2,1,7]\nnumbers.insert(-2,20)\nnumbers.remove(2)\nnumbers.append(45)\nnumbers.pop() #remove the last and return it\nprint(numbers.index(5))\nnumbers.sort()\nnumbers.reverse() #get deasc order\nif 5 in numbers:\n    print(numbers.index(5))\nnumbers2 = numbers.copy()\nnumbers.append(45)\nprint(numbers)\nprint(numbers2)\n\n#去重复\nnumbers = [5,20,1,5,7,5,6,4,5]\nuniques = []\nfor i in numbers:\n    if i not in uniques:\n        uniques.append(i)\nprint(uniques)\n```\n\n+ ### Tuple\n+ 类似于List，但不可修改\n\n```python\nnumbers = (5,20,1,5,7,5,6,4,5)\nnumbers[0] = 1 #TypeError: 'tuple' object does not support item assignment\n```\n\n+ ### Unpacking\n+ 映射数组成员\n\n```python\ncoordinates = (1,2,3)\na = coordinates[0]\nb = coordinates[1]\nc = coordinates[2]\n\n# use Unpacking feature, unpacking the tuple/list to three variable\nx, y, z = coordinates\nprint(f\"{a},{b},{c} <=> {x}, {y}, {z}\")\n```\n\n+ ### Dictionary\n\n```python\ncustomer = {\n    \"name\": \"John\",\n    \"age\": 30,\n    \"is_verified\": True\n}\nprint(customer[\"name\"])\n# print(customer[\"Name\"]) #KeyError,don't contain\n# print(customer[\"birthdate\"])#KeyError,don't contain\nprint(customer.get(\"name\"))\nprint(customer.get(\"Name\",\"Hey\")) #Print,with default value:'Hey'\ncustomer[\"name\"] = \"AA\"\nprint(customer.get(\"name\"))\n\n#Exercise\ninput_str = str(input(\"Phone:\"))\ndigits_map = {\n    \"1\":\"One\",\n    \"2\":\"Two\",\n    \"3\":\"Three\",\n    \"4\":\"Four\",\n}\noutput = ''\nfor s in input_str:\n    output += digits_map.get(s,\"\") + \" \"\n\nprint(output)\n```\n+ [mac]ctrl+cmd+space>> to show emojis","slug":"python_1","published":1,"date":"2019-10-11T10:25:57.894Z","updated":"2019-10-11T10:25:57.894Z","_id":"ck1lyktof000aep116huni2uo","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"Python-Note-1\"><a href=\"#Python-Note-1\" class=\"headerlink\" title=\"Python Note 1\"></a>Python Note 1</h1><ul>\n<li><h3 id=\"while结构\"><a href=\"#while结构\" class=\"headerlink\" title=\"while结构\"></a>while结构</h3>注： “””  多行string</li>\n</ul>\n<pre><code class=\"python\">n = 0\nwhile n &lt; 5:\n    print(&quot;&quot;&quot;\nThis is test!\nThis is test2!\nThis is test3!\n    &quot;&quot;&quot;)\n    n = n + 1</code></pre>\n<ul>\n<li><h3 id=\"For结构\"><a href=\"#For结构\" class=\"headerlink\" title=\"For结构\"></a>For结构</h3><ul>\n<li>普通使用</li>\n</ul>\n<pre><code class=\"python\">for i in range(5):\n   print()</code></pre>\n<ul>\n<li>Use curly braces, 显示变量</li>\n</ul>\n</li>\n</ul>\n<pre><code class=\"python\"> for i in range(5):\n     print(f&quot;i:{i}&quot;)</code></pre>\n<ul>\n<li>使用重复*个数输出字符</li>\n</ul>\n<pre><code class=\"python\"> for i in range(5):\n     print(f&quot;i:{i}&quot;*4)</code></pre>\n<ul>\n<li><h3 id=\"List\"><a href=\"#List\" class=\"headerlink\" title=\"List\"></a>List</h3></li>\n</ul>\n<ul>\n<li>普遍用法</li>\n</ul>\n<pre><code class=\"python\">names = [&#39;John&#39;, &#39;Bob&#39;, &#39;Mosh&#39;, &#39;Sarah&#39;, &#39;Mary&#39;]\nprint(names[2:])  #Print will start from &#39;Mosh&#39;&#39;&#39;\nprint(names[:])  #Print all&#39;\nnames[0] = &#39;Joh&#39; #Change item\nprint(names)  #output\n# 2d list\nmatrix = [\n   [1, 2, 3],\n    [4, 5, 6],\n    [7, 8, 9]\n]\nmatrix[0][-3] = 20\nprint(matrix)</code></pre>\n<ul>\n<li>编辑类</li>\n</ul>\n<pre><code class=\"python\">numbers = [5,2,1,7]\nnumbers.insert(-2,20)\nnumbers.remove(2)\nnumbers.append(45)\nnumbers.pop() #remove the last and return it\nprint(numbers.index(5))\nnumbers.sort()\nnumbers.reverse() #get deasc order\nif 5 in numbers:\n    print(numbers.index(5))\nnumbers2 = numbers.copy()\nnumbers.append(45)\nprint(numbers)\nprint(numbers2)\n\n#去重复\nnumbers = [5,20,1,5,7,5,6,4,5]\nuniques = []\nfor i in numbers:\n    if i not in uniques:\n        uniques.append(i)\nprint(uniques)</code></pre>\n<ul>\n<li><h3 id=\"Tuple\"><a href=\"#Tuple\" class=\"headerlink\" title=\"Tuple\"></a>Tuple</h3></li>\n<li>类似于List，但不可修改</li>\n</ul>\n<pre><code class=\"python\">numbers = (5,20,1,5,7,5,6,4,5)\nnumbers[0] = 1 #TypeError: &#39;tuple&#39; object does not support item assignment</code></pre>\n<ul>\n<li><h3 id=\"Unpacking\"><a href=\"#Unpacking\" class=\"headerlink\" title=\"Unpacking\"></a>Unpacking</h3></li>\n<li>映射数组成员</li>\n</ul>\n<pre><code class=\"python\">coordinates = (1,2,3)\na = coordinates[0]\nb = coordinates[1]\nc = coordinates[2]\n\n# use Unpacking feature, unpacking the tuple/list to three variable\nx, y, z = coordinates\nprint(f&quot;{a},{b},{c} &lt;=&gt; {x}, {y}, {z}&quot;)</code></pre>\n<ul>\n<li><h3 id=\"Dictionary\"><a href=\"#Dictionary\" class=\"headerlink\" title=\"Dictionary\"></a>Dictionary</h3></li>\n</ul>\n<pre><code class=\"python\">customer = {\n    &quot;name&quot;: &quot;John&quot;,\n    &quot;age&quot;: 30,\n    &quot;is_verified&quot;: True\n}\nprint(customer[&quot;name&quot;])\n# print(customer[&quot;Name&quot;]) #KeyError,don&#39;t contain\n# print(customer[&quot;birthdate&quot;])#KeyError,don&#39;t contain\nprint(customer.get(&quot;name&quot;))\nprint(customer.get(&quot;Name&quot;,&quot;Hey&quot;)) #Print,with default value:&#39;Hey&#39;\ncustomer[&quot;name&quot;] = &quot;AA&quot;\nprint(customer.get(&quot;name&quot;))\n\n#Exercise\ninput_str = str(input(&quot;Phone:&quot;))\ndigits_map = {\n    &quot;1&quot;:&quot;One&quot;,\n    &quot;2&quot;:&quot;Two&quot;,\n    &quot;3&quot;:&quot;Three&quot;,\n    &quot;4&quot;:&quot;Four&quot;,\n}\noutput = &#39;&#39;\nfor s in input_str:\n    output += digits_map.get(s,&quot;&quot;) + &quot; &quot;\n\nprint(output)</code></pre>\n<ul>\n<li>[mac]ctrl+cmd+space&gt;&gt; to show emojis</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Python-Note-1\"><a href=\"#Python-Note-1\" class=\"headerlink\" title=\"Python Note 1\"></a>Python Note 1</h1><ul>\n<li><h3 id=\"while结构\"><a href=\"#while结构\" class=\"headerlink\" title=\"while结构\"></a>while结构</h3>注： “””  多行string</li>\n</ul>\n<pre><code class=\"python\">n = 0\nwhile n &lt; 5:\n    print(&quot;&quot;&quot;\nThis is test!\nThis is test2!\nThis is test3!\n    &quot;&quot;&quot;)\n    n = n + 1</code></pre>\n<ul>\n<li><h3 id=\"For结构\"><a href=\"#For结构\" class=\"headerlink\" title=\"For结构\"></a>For结构</h3><ul>\n<li>普通使用</li>\n</ul>\n<pre><code class=\"python\">for i in range(5):\n   print()</code></pre>\n<ul>\n<li>Use curly braces, 显示变量</li>\n</ul>\n</li>\n</ul>\n<pre><code class=\"python\"> for i in range(5):\n     print(f&quot;i:{i}&quot;)</code></pre>\n<ul>\n<li>使用重复*个数输出字符</li>\n</ul>\n<pre><code class=\"python\"> for i in range(5):\n     print(f&quot;i:{i}&quot;*4)</code></pre>\n<ul>\n<li><h3 id=\"List\"><a href=\"#List\" class=\"headerlink\" title=\"List\"></a>List</h3></li>\n</ul>\n<ul>\n<li>普遍用法</li>\n</ul>\n<pre><code class=\"python\">names = [&#39;John&#39;, &#39;Bob&#39;, &#39;Mosh&#39;, &#39;Sarah&#39;, &#39;Mary&#39;]\nprint(names[2:])  #Print will start from &#39;Mosh&#39;&#39;&#39;\nprint(names[:])  #Print all&#39;\nnames[0] = &#39;Joh&#39; #Change item\nprint(names)  #output\n# 2d list\nmatrix = [\n   [1, 2, 3],\n    [4, 5, 6],\n    [7, 8, 9]\n]\nmatrix[0][-3] = 20\nprint(matrix)</code></pre>\n<ul>\n<li>编辑类</li>\n</ul>\n<pre><code class=\"python\">numbers = [5,2,1,7]\nnumbers.insert(-2,20)\nnumbers.remove(2)\nnumbers.append(45)\nnumbers.pop() #remove the last and return it\nprint(numbers.index(5))\nnumbers.sort()\nnumbers.reverse() #get deasc order\nif 5 in numbers:\n    print(numbers.index(5))\nnumbers2 = numbers.copy()\nnumbers.append(45)\nprint(numbers)\nprint(numbers2)\n\n#去重复\nnumbers = [5,20,1,5,7,5,6,4,5]\nuniques = []\nfor i in numbers:\n    if i not in uniques:\n        uniques.append(i)\nprint(uniques)</code></pre>\n<ul>\n<li><h3 id=\"Tuple\"><a href=\"#Tuple\" class=\"headerlink\" title=\"Tuple\"></a>Tuple</h3></li>\n<li>类似于List，但不可修改</li>\n</ul>\n<pre><code class=\"python\">numbers = (5,20,1,5,7,5,6,4,5)\nnumbers[0] = 1 #TypeError: &#39;tuple&#39; object does not support item assignment</code></pre>\n<ul>\n<li><h3 id=\"Unpacking\"><a href=\"#Unpacking\" class=\"headerlink\" title=\"Unpacking\"></a>Unpacking</h3></li>\n<li>映射数组成员</li>\n</ul>\n<pre><code class=\"python\">coordinates = (1,2,3)\na = coordinates[0]\nb = coordinates[1]\nc = coordinates[2]\n\n# use Unpacking feature, unpacking the tuple/list to three variable\nx, y, z = coordinates\nprint(f&quot;{a},{b},{c} &lt;=&gt; {x}, {y}, {z}&quot;)</code></pre>\n<ul>\n<li><h3 id=\"Dictionary\"><a href=\"#Dictionary\" class=\"headerlink\" title=\"Dictionary\"></a>Dictionary</h3></li>\n</ul>\n<pre><code class=\"python\">customer = {\n    &quot;name&quot;: &quot;John&quot;,\n    &quot;age&quot;: 30,\n    &quot;is_verified&quot;: True\n}\nprint(customer[&quot;name&quot;])\n# print(customer[&quot;Name&quot;]) #KeyError,don&#39;t contain\n# print(customer[&quot;birthdate&quot;])#KeyError,don&#39;t contain\nprint(customer.get(&quot;name&quot;))\nprint(customer.get(&quot;Name&quot;,&quot;Hey&quot;)) #Print,with default value:&#39;Hey&#39;\ncustomer[&quot;name&quot;] = &quot;AA&quot;\nprint(customer.get(&quot;name&quot;))\n\n#Exercise\ninput_str = str(input(&quot;Phone:&quot;))\ndigits_map = {\n    &quot;1&quot;:&quot;One&quot;,\n    &quot;2&quot;:&quot;Two&quot;,\n    &quot;3&quot;:&quot;Three&quot;,\n    &quot;4&quot;:&quot;Four&quot;,\n}\noutput = &#39;&#39;\nfor s in input_str:\n    output += digits_map.get(s,&quot;&quot;) + &quot; &quot;\n\nprint(output)</code></pre>\n<ul>\n<li>[mac]ctrl+cmd+space&gt;&gt; to show emojis</li>\n</ul>\n"},{"title":"Python Note 2","_content":"# Python Note 2\n\n+ ### Function definition\n+ As python recommended, left two blank lines after function\n\n```python\ndef greet_user():\n    print(\"GO\")\n    print(\"Hi THERE!\")\n\n\ngreet_user()\n```\n\n+ ### Function parameters\n\n```python\ndef greet_user(name):\n    print(f\"GO:{name}\")\n    print(\"Hi THERE!\")\n\n\ngreet_user(\"John\")\ngreet_user() #Error, no parameter\n\ndef greet_user2(first_name,second_name):\n    print(f\"GO:{first_name} {second_name}\")\n    print(\"Hi THERE!\")\n\n\ngreet_user2(\"John\",\"Smith\")\ngreet_user2(second_name=\"John\",first_name=\"Smith\") #使用keyword形式作为参数，\ngreet_user2(second_name=\"John\",\"Smith\") #错误，混合情况必须先用position形式再用keyword形式\n```\n\n+ ### Funtion Returns\n+ By default, python return none.\n\n```python\ndef square(number):\n\treturn number * number\n\n\nresult = square(3)\nprint(result)\n```\n\n+ ### Error Handling\n+ try except\n\n```python\ntry:\n\tday = int(input(\"input day:\"))\n\tincome = 2000 / day\n\tprint(day)\nexcept ZeroDivisionError:\n\tprint(\"day can't be zero\")\nexcept ValueError:\n\tprint(\"Invalid input\")\n```\n\n+ ### Comments\n+ User comment to explain why and how, not what!","source":"_posts/python_2.md","raw":"---\ntitle: Python Note 2\ncategories:\n- Python笔记\ntags: \n- Python\n- Note\n---\n# Python Note 2\n\n+ ### Function definition\n+ As python recommended, left two blank lines after function\n\n```python\ndef greet_user():\n    print(\"GO\")\n    print(\"Hi THERE!\")\n\n\ngreet_user()\n```\n\n+ ### Function parameters\n\n```python\ndef greet_user(name):\n    print(f\"GO:{name}\")\n    print(\"Hi THERE!\")\n\n\ngreet_user(\"John\")\ngreet_user() #Error, no parameter\n\ndef greet_user2(first_name,second_name):\n    print(f\"GO:{first_name} {second_name}\")\n    print(\"Hi THERE!\")\n\n\ngreet_user2(\"John\",\"Smith\")\ngreet_user2(second_name=\"John\",first_name=\"Smith\") #使用keyword形式作为参数，\ngreet_user2(second_name=\"John\",\"Smith\") #错误，混合情况必须先用position形式再用keyword形式\n```\n\n+ ### Funtion Returns\n+ By default, python return none.\n\n```python\ndef square(number):\n\treturn number * number\n\n\nresult = square(3)\nprint(result)\n```\n\n+ ### Error Handling\n+ try except\n\n```python\ntry:\n\tday = int(input(\"input day:\"))\n\tincome = 2000 / day\n\tprint(day)\nexcept ZeroDivisionError:\n\tprint(\"day can't be zero\")\nexcept ValueError:\n\tprint(\"Invalid input\")\n```\n\n+ ### Comments\n+ User comment to explain why and how, not what!","slug":"python_2","published":1,"date":"2019-10-11T10:25:57.894Z","updated":"2019-10-11T10:25:57.894Z","_id":"ck1lyktog000bep11hglm1k2i","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"Python-Note-2\"><a href=\"#Python-Note-2\" class=\"headerlink\" title=\"Python Note 2\"></a>Python Note 2</h1><ul>\n<li><h3 id=\"Function-definition\"><a href=\"#Function-definition\" class=\"headerlink\" title=\"Function definition\"></a>Function definition</h3></li>\n<li>As python recommended, left two blank lines after function</li>\n</ul>\n<pre><code class=\"python\">def greet_user():\n    print(&quot;GO&quot;)\n    print(&quot;Hi THERE!&quot;)\n\n\ngreet_user()</code></pre>\n<ul>\n<li><h3 id=\"Function-parameters\"><a href=\"#Function-parameters\" class=\"headerlink\" title=\"Function parameters\"></a>Function parameters</h3></li>\n</ul>\n<pre><code class=\"python\">def greet_user(name):\n    print(f&quot;GO:{name}&quot;)\n    print(&quot;Hi THERE!&quot;)\n\n\ngreet_user(&quot;John&quot;)\ngreet_user() #Error, no parameter\n\ndef greet_user2(first_name,second_name):\n    print(f&quot;GO:{first_name} {second_name}&quot;)\n    print(&quot;Hi THERE!&quot;)\n\n\ngreet_user2(&quot;John&quot;,&quot;Smith&quot;)\ngreet_user2(second_name=&quot;John&quot;,first_name=&quot;Smith&quot;) #使用keyword形式作为参数，\ngreet_user2(second_name=&quot;John&quot;,&quot;Smith&quot;) #错误，混合情况必须先用position形式再用keyword形式</code></pre>\n<ul>\n<li><h3 id=\"Funtion-Returns\"><a href=\"#Funtion-Returns\" class=\"headerlink\" title=\"Funtion Returns\"></a>Funtion Returns</h3></li>\n<li>By default, python return none.</li>\n</ul>\n<pre><code class=\"python\">def square(number):\n    return number * number\n\n\nresult = square(3)\nprint(result)</code></pre>\n<ul>\n<li><h3 id=\"Error-Handling\"><a href=\"#Error-Handling\" class=\"headerlink\" title=\"Error Handling\"></a>Error Handling</h3></li>\n<li>try except</li>\n</ul>\n<pre><code class=\"python\">try:\n    day = int(input(&quot;input day:&quot;))\n    income = 2000 / day\n    print(day)\nexcept ZeroDivisionError:\n    print(&quot;day can&#39;t be zero&quot;)\nexcept ValueError:\n    print(&quot;Invalid input&quot;)</code></pre>\n<ul>\n<li><h3 id=\"Comments\"><a href=\"#Comments\" class=\"headerlink\" title=\"Comments\"></a>Comments</h3></li>\n<li>User comment to explain why and how, not what!</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Python-Note-2\"><a href=\"#Python-Note-2\" class=\"headerlink\" title=\"Python Note 2\"></a>Python Note 2</h1><ul>\n<li><h3 id=\"Function-definition\"><a href=\"#Function-definition\" class=\"headerlink\" title=\"Function definition\"></a>Function definition</h3></li>\n<li>As python recommended, left two blank lines after function</li>\n</ul>\n<pre><code class=\"python\">def greet_user():\n    print(&quot;GO&quot;)\n    print(&quot;Hi THERE!&quot;)\n\n\ngreet_user()</code></pre>\n<ul>\n<li><h3 id=\"Function-parameters\"><a href=\"#Function-parameters\" class=\"headerlink\" title=\"Function parameters\"></a>Function parameters</h3></li>\n</ul>\n<pre><code class=\"python\">def greet_user(name):\n    print(f&quot;GO:{name}&quot;)\n    print(&quot;Hi THERE!&quot;)\n\n\ngreet_user(&quot;John&quot;)\ngreet_user() #Error, no parameter\n\ndef greet_user2(first_name,second_name):\n    print(f&quot;GO:{first_name} {second_name}&quot;)\n    print(&quot;Hi THERE!&quot;)\n\n\ngreet_user2(&quot;John&quot;,&quot;Smith&quot;)\ngreet_user2(second_name=&quot;John&quot;,first_name=&quot;Smith&quot;) #使用keyword形式作为参数，\ngreet_user2(second_name=&quot;John&quot;,&quot;Smith&quot;) #错误，混合情况必须先用position形式再用keyword形式</code></pre>\n<ul>\n<li><h3 id=\"Funtion-Returns\"><a href=\"#Funtion-Returns\" class=\"headerlink\" title=\"Funtion Returns\"></a>Funtion Returns</h3></li>\n<li>By default, python return none.</li>\n</ul>\n<pre><code class=\"python\">def square(number):\n    return number * number\n\n\nresult = square(3)\nprint(result)</code></pre>\n<ul>\n<li><h3 id=\"Error-Handling\"><a href=\"#Error-Handling\" class=\"headerlink\" title=\"Error Handling\"></a>Error Handling</h3></li>\n<li>try except</li>\n</ul>\n<pre><code class=\"python\">try:\n    day = int(input(&quot;input day:&quot;))\n    income = 2000 / day\n    print(day)\nexcept ZeroDivisionError:\n    print(&quot;day can&#39;t be zero&quot;)\nexcept ValueError:\n    print(&quot;Invalid input&quot;)</code></pre>\n<ul>\n<li><h3 id=\"Comments\"><a href=\"#Comments\" class=\"headerlink\" title=\"Comments\"></a>Comments</h3></li>\n<li>User comment to explain why and how, not what!</li>\n</ul>\n"},{"title":"常用单词学习","_content":"\n## colon\n<audio id=\"audio\" controls=\"\" preload=\"none\">\n      <source id=\"mp3\" src=\"http://audio.dict.cn/fuTd30Anbf371a598eda69b4ccf46d35c7add5fc.mp3?t=colon\">\n      </audio>\n      \n+ 英 /ˈkəʊlən; ˈkəʊlɒn/  美 /ˈkoʊlən/  全球(美国)\nn. [解剖] 结肠；**冒号**（用于引语、说明、例证等之前）；科郎（哥斯达黎加货币单位）\n\n## quote\n+ 英 /kwəʊt/  美 /kwoʊt/  全球(加拿大)  \nvt. 引述；引用；举例说明；报价；以……为证；为（企业的股份）上市\nvi. 引述；引用\nn. 引文；语录；开价；（股票）牌价；**引号**；（建筑或维修的）报价单\nn. (Quote) （美、俄、澳、马、荷）克奥特（人名）\n\n## apostrophe\n+ 英 /əˈpɒstrəfi/  美 /əˈpɑːstrəfi/  全球(英国)  \nn. 省略符号，撇号；呼语，顿呼\n\n## curly braces\n花括号\n\n## forward slash\n斜杠（分隔号“/”）\n\n## back slash\n正斜杠（分隔“\\”）\n\n## modulis\n+ /'mɑdʒə,lai/ \nn. 模数；模（modulus 的复数）\n\n## asterisks\n+ 英 /ˈæstərɪsk/  美 /ˈæstərɪsk/  全球(美国)  \nn. 星号；星号键\nvt. 注上星号；用星号标出\n\n## exponentiation\n+ 英 /,ekspənenʃɪ'eɪʃ(ə)n/  美 /,ɛkspo,nɛnʃɪ'eʃən/  全球(美国)  \nn. [数] 取幂，求幂；乘方\n\n## multiplication\n+ 英 /ˌmʌltɪplɪˈkeɪʃn/  美 /ˌmʌltɪplɪˈkeɪʃn/  全球(美国)  \nn. [数] 乘法；增加\n\n## parenthesis\n+ 英 /pəˈrenθəsɪs/  美 /pəˈrenθəsɪs/  全球(美国)  \nn. 插入语,插入成分\nn. **圆括号**\nn. 间歇，插曲\n\n## mammal\n+ 英 /ˈmæml/  美 /ˈmæml/  全球(美国)  \nn. [脊椎] 哺乳动物","source":"_posts/常用单词学习.md","raw":"---\ntitle: 常用单词学习\ncategories:\n- 英语学习\ntags: \n- English\n- Note\n---\n\n## colon\n<audio id=\"audio\" controls=\"\" preload=\"none\">\n      <source id=\"mp3\" src=\"http://audio.dict.cn/fuTd30Anbf371a598eda69b4ccf46d35c7add5fc.mp3?t=colon\">\n      </audio>\n      \n+ 英 /ˈkəʊlən; ˈkəʊlɒn/  美 /ˈkoʊlən/  全球(美国)\nn. [解剖] 结肠；**冒号**（用于引语、说明、例证等之前）；科郎（哥斯达黎加货币单位）\n\n## quote\n+ 英 /kwəʊt/  美 /kwoʊt/  全球(加拿大)  \nvt. 引述；引用；举例说明；报价；以……为证；为（企业的股份）上市\nvi. 引述；引用\nn. 引文；语录；开价；（股票）牌价；**引号**；（建筑或维修的）报价单\nn. (Quote) （美、俄、澳、马、荷）克奥特（人名）\n\n## apostrophe\n+ 英 /əˈpɒstrəfi/  美 /əˈpɑːstrəfi/  全球(英国)  \nn. 省略符号，撇号；呼语，顿呼\n\n## curly braces\n花括号\n\n## forward slash\n斜杠（分隔号“/”）\n\n## back slash\n正斜杠（分隔“\\”）\n\n## modulis\n+ /'mɑdʒə,lai/ \nn. 模数；模（modulus 的复数）\n\n## asterisks\n+ 英 /ˈæstərɪsk/  美 /ˈæstərɪsk/  全球(美国)  \nn. 星号；星号键\nvt. 注上星号；用星号标出\n\n## exponentiation\n+ 英 /,ekspənenʃɪ'eɪʃ(ə)n/  美 /,ɛkspo,nɛnʃɪ'eʃən/  全球(美国)  \nn. [数] 取幂，求幂；乘方\n\n## multiplication\n+ 英 /ˌmʌltɪplɪˈkeɪʃn/  美 /ˌmʌltɪplɪˈkeɪʃn/  全球(美国)  \nn. [数] 乘法；增加\n\n## parenthesis\n+ 英 /pəˈrenθəsɪs/  美 /pəˈrenθəsɪs/  全球(美国)  \nn. 插入语,插入成分\nn. **圆括号**\nn. 间歇，插曲\n\n## mammal\n+ 英 /ˈmæml/  美 /ˈmæml/  全球(美国)  \nn. [脊椎] 哺乳动物","slug":"常用单词学习","published":1,"date":"2019-10-11T09:11:09.468Z","updated":"2019-10-11T16:11:49.976Z","_id":"ck1lyktoj000fep116ovcyc9z","comments":1,"layout":"post","photos":[],"link":"","content":"<h2 id=\"colon\"><a href=\"#colon\" class=\"headerlink\" title=\"colon\"></a>colon</h2><audio id=\"audio\" controls preload=\"none\">\n      <source id=\"mp3\" src=\"http://audio.dict.cn/fuTd30Anbf371a598eda69b4ccf46d35c7add5fc.mp3?t=colon\">\n      </audio>\n\n<ul>\n<li>英 /ˈkəʊlən; ˈkəʊlɒn/  美 /ˈkoʊlən/  全球(美国)<br>n. [解剖] 结肠；<strong>冒号</strong>（用于引语、说明、例证等之前）；科郎（哥斯达黎加货币单位）</li>\n</ul>\n<h2 id=\"quote\"><a href=\"#quote\" class=\"headerlink\" title=\"quote\"></a>quote</h2><ul>\n<li>英 /kwəʊt/  美 /kwoʊt/  全球(加拿大)<br>vt. 引述；引用；举例说明；报价；以……为证；为（企业的股份）上市<br>vi. 引述；引用<br>n. 引文；语录；开价；（股票）牌价；<strong>引号</strong>；（建筑或维修的）报价单<br>n. (Quote) （美、俄、澳、马、荷）克奥特（人名）</li>\n</ul>\n<h2 id=\"apostrophe\"><a href=\"#apostrophe\" class=\"headerlink\" title=\"apostrophe\"></a>apostrophe</h2><ul>\n<li>英 /əˈpɒstrəfi/  美 /əˈpɑːstrəfi/  全球(英国)<br>n. 省略符号，撇号；呼语，顿呼</li>\n</ul>\n<h2 id=\"curly-braces\"><a href=\"#curly-braces\" class=\"headerlink\" title=\"curly braces\"></a>curly braces</h2><p>花括号</p>\n<h2 id=\"forward-slash\"><a href=\"#forward-slash\" class=\"headerlink\" title=\"forward slash\"></a>forward slash</h2><p>斜杠（分隔号“/”）</p>\n<h2 id=\"back-slash\"><a href=\"#back-slash\" class=\"headerlink\" title=\"back slash\"></a>back slash</h2><p>正斜杠（分隔“\\”）</p>\n<h2 id=\"modulis\"><a href=\"#modulis\" class=\"headerlink\" title=\"modulis\"></a>modulis</h2><ul>\n<li>/‘mɑdʒə,lai/<br>n. 模数；模（modulus 的复数）</li>\n</ul>\n<h2 id=\"asterisks\"><a href=\"#asterisks\" class=\"headerlink\" title=\"asterisks\"></a>asterisks</h2><ul>\n<li>英 /ˈæstərɪsk/  美 /ˈæstərɪsk/  全球(美国)<br>n. 星号；星号键<br>vt. 注上星号；用星号标出</li>\n</ul>\n<h2 id=\"exponentiation\"><a href=\"#exponentiation\" class=\"headerlink\" title=\"exponentiation\"></a>exponentiation</h2><ul>\n<li>英 /,ekspənenʃɪ’eɪʃ(ə)n/  美 /,ɛkspo,nɛnʃɪ’eʃən/  全球(美国)<br>n. [数] 取幂，求幂；乘方</li>\n</ul>\n<h2 id=\"multiplication\"><a href=\"#multiplication\" class=\"headerlink\" title=\"multiplication\"></a>multiplication</h2><ul>\n<li>英 /ˌmʌltɪplɪˈkeɪʃn/  美 /ˌmʌltɪplɪˈkeɪʃn/  全球(美国)<br>n. [数] 乘法；增加</li>\n</ul>\n<h2 id=\"parenthesis\"><a href=\"#parenthesis\" class=\"headerlink\" title=\"parenthesis\"></a>parenthesis</h2><ul>\n<li>英 /pəˈrenθəsɪs/  美 /pəˈrenθəsɪs/  全球(美国)<br>n. 插入语,插入成分<br>n. <strong>圆括号</strong><br>n. 间歇，插曲</li>\n</ul>\n<h2 id=\"mammal\"><a href=\"#mammal\" class=\"headerlink\" title=\"mammal\"></a>mammal</h2><ul>\n<li>英 /ˈmæml/  美 /ˈmæml/  全球(美国)<br>n. [脊椎] 哺乳动物</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"colon\"><a href=\"#colon\" class=\"headerlink\" title=\"colon\"></a>colon</h2><audio id=\"audio\" controls preload=\"none\">\n      <source id=\"mp3\" src=\"http://audio.dict.cn/fuTd30Anbf371a598eda69b4ccf46d35c7add5fc.mp3?t=colon\">\n      </audio>\n\n<ul>\n<li>英 /ˈkəʊlən; ˈkəʊlɒn/  美 /ˈkoʊlən/  全球(美国)<br>n. [解剖] 结肠；<strong>冒号</strong>（用于引语、说明、例证等之前）；科郎（哥斯达黎加货币单位）</li>\n</ul>\n<h2 id=\"quote\"><a href=\"#quote\" class=\"headerlink\" title=\"quote\"></a>quote</h2><ul>\n<li>英 /kwəʊt/  美 /kwoʊt/  全球(加拿大)<br>vt. 引述；引用；举例说明；报价；以……为证；为（企业的股份）上市<br>vi. 引述；引用<br>n. 引文；语录；开价；（股票）牌价；<strong>引号</strong>；（建筑或维修的）报价单<br>n. (Quote) （美、俄、澳、马、荷）克奥特（人名）</li>\n</ul>\n<h2 id=\"apostrophe\"><a href=\"#apostrophe\" class=\"headerlink\" title=\"apostrophe\"></a>apostrophe</h2><ul>\n<li>英 /əˈpɒstrəfi/  美 /əˈpɑːstrəfi/  全球(英国)<br>n. 省略符号，撇号；呼语，顿呼</li>\n</ul>\n<h2 id=\"curly-braces\"><a href=\"#curly-braces\" class=\"headerlink\" title=\"curly braces\"></a>curly braces</h2><p>花括号</p>\n<h2 id=\"forward-slash\"><a href=\"#forward-slash\" class=\"headerlink\" title=\"forward slash\"></a>forward slash</h2><p>斜杠（分隔号“/”）</p>\n<h2 id=\"back-slash\"><a href=\"#back-slash\" class=\"headerlink\" title=\"back slash\"></a>back slash</h2><p>正斜杠（分隔“\\”）</p>\n<h2 id=\"modulis\"><a href=\"#modulis\" class=\"headerlink\" title=\"modulis\"></a>modulis</h2><ul>\n<li>/‘mɑdʒə,lai/<br>n. 模数；模（modulus 的复数）</li>\n</ul>\n<h2 id=\"asterisks\"><a href=\"#asterisks\" class=\"headerlink\" title=\"asterisks\"></a>asterisks</h2><ul>\n<li>英 /ˈæstərɪsk/  美 /ˈæstərɪsk/  全球(美国)<br>n. 星号；星号键<br>vt. 注上星号；用星号标出</li>\n</ul>\n<h2 id=\"exponentiation\"><a href=\"#exponentiation\" class=\"headerlink\" title=\"exponentiation\"></a>exponentiation</h2><ul>\n<li>英 /,ekspənenʃɪ’eɪʃ(ə)n/  美 /,ɛkspo,nɛnʃɪ’eʃən/  全球(美国)<br>n. [数] 取幂，求幂；乘方</li>\n</ul>\n<h2 id=\"multiplication\"><a href=\"#multiplication\" class=\"headerlink\" title=\"multiplication\"></a>multiplication</h2><ul>\n<li>英 /ˌmʌltɪplɪˈkeɪʃn/  美 /ˌmʌltɪplɪˈkeɪʃn/  全球(美国)<br>n. [数] 乘法；增加</li>\n</ul>\n<h2 id=\"parenthesis\"><a href=\"#parenthesis\" class=\"headerlink\" title=\"parenthesis\"></a>parenthesis</h2><ul>\n<li>英 /pəˈrenθəsɪs/  美 /pəˈrenθəsɪs/  全球(美国)<br>n. 插入语,插入成分<br>n. <strong>圆括号</strong><br>n. 间歇，插曲</li>\n</ul>\n<h2 id=\"mammal\"><a href=\"#mammal\" class=\"headerlink\" title=\"mammal\"></a>mammal</h2><ul>\n<li>英 /ˈmæml/  美 /ˈmæml/  全球(美国)<br>n. [脊椎] 哺乳动物</li>\n</ul>\n"},{"title":"Python Note 4","_content":"# Python Note 4\n\n### Pypi & Pip\n+ [pypi](https://pypi.org/)\n+ use as : pip install openpyxl  to install \n\n### Use openpyxl\n\n```python\nimport openpyxl as xl\nfrom openpyxl.chart import BarChart, Reference\nwb = xl.load_workbook(\"pydemo2/transactions.xlsx\")\nsheet = wb[\"Sheet1\"]\nfor row in range(2, sheet.max_row + 1):\n    cell = sheet.cell(row, 3)\n    real_val = cell.value * 0.9\n    real_val_cell = sheet.cell(row, 4)\n    real_val_cell.value = real_val\n\nvalues = Reference(sheet, min_row=2, max_row=sheet.max_row, min_col=4, max_col=4)\nchart = BarChart()\nchart.add_data(values)\nsheet.add_chart(chart, 'e2')\nwb.save('pydemo2/transactions_n2.xlsx')\n```\n\n### Machine learning\n\n+ Self-driving Cars\n+ Robotics\n+ Language Processing\n+ Vision Processing\n+ Forecasting Stock Market Trends","source":"_posts/python_4.md","raw":"---\ntitle: Python Note 4\ncategories:\n- Python笔记\ntags: \n- Python\n- Note\n---\n# Python Note 4\n\n### Pypi & Pip\n+ [pypi](https://pypi.org/)\n+ use as : pip install openpyxl  to install \n\n### Use openpyxl\n\n```python\nimport openpyxl as xl\nfrom openpyxl.chart import BarChart, Reference\nwb = xl.load_workbook(\"pydemo2/transactions.xlsx\")\nsheet = wb[\"Sheet1\"]\nfor row in range(2, sheet.max_row + 1):\n    cell = sheet.cell(row, 3)\n    real_val = cell.value * 0.9\n    real_val_cell = sheet.cell(row, 4)\n    real_val_cell.value = real_val\n\nvalues = Reference(sheet, min_row=2, max_row=sheet.max_row, min_col=4, max_col=4)\nchart = BarChart()\nchart.add_data(values)\nsheet.add_chart(chart, 'e2')\nwb.save('pydemo2/transactions_n2.xlsx')\n```\n\n### Machine learning\n\n+ Self-driving Cars\n+ Robotics\n+ Language Processing\n+ Vision Processing\n+ Forecasting Stock Market Trends","slug":"python_4","published":1,"date":"2019-10-11T10:25:57.895Z","updated":"2019-10-11T10:25:57.895Z","_id":"ck1lyktoo000lep110jb8sxbp","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"Python-Note-4\"><a href=\"#Python-Note-4\" class=\"headerlink\" title=\"Python Note 4\"></a>Python Note 4</h1><h3 id=\"Pypi-amp-Pip\"><a href=\"#Pypi-amp-Pip\" class=\"headerlink\" title=\"Pypi &amp; Pip\"></a>Pypi &amp; Pip</h3><ul>\n<li><a href=\"https://pypi.org/\" target=\"_blank\" rel=\"noopener\">pypi</a></li>\n<li>use as : pip install openpyxl  to install </li>\n</ul>\n<h3 id=\"Use-openpyxl\"><a href=\"#Use-openpyxl\" class=\"headerlink\" title=\"Use openpyxl\"></a>Use openpyxl</h3><pre><code class=\"python\">import openpyxl as xl\nfrom openpyxl.chart import BarChart, Reference\nwb = xl.load_workbook(&quot;pydemo2/transactions.xlsx&quot;)\nsheet = wb[&quot;Sheet1&quot;]\nfor row in range(2, sheet.max_row + 1):\n    cell = sheet.cell(row, 3)\n    real_val = cell.value * 0.9\n    real_val_cell = sheet.cell(row, 4)\n    real_val_cell.value = real_val\n\nvalues = Reference(sheet, min_row=2, max_row=sheet.max_row, min_col=4, max_col=4)\nchart = BarChart()\nchart.add_data(values)\nsheet.add_chart(chart, &#39;e2&#39;)\nwb.save(&#39;pydemo2/transactions_n2.xlsx&#39;)</code></pre>\n<h3 id=\"Machine-learning\"><a href=\"#Machine-learning\" class=\"headerlink\" title=\"Machine learning\"></a>Machine learning</h3><ul>\n<li>Self-driving Cars</li>\n<li>Robotics</li>\n<li>Language Processing</li>\n<li>Vision Processing</li>\n<li>Forecasting Stock Market Trends</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Python-Note-4\"><a href=\"#Python-Note-4\" class=\"headerlink\" title=\"Python Note 4\"></a>Python Note 4</h1><h3 id=\"Pypi-amp-Pip\"><a href=\"#Pypi-amp-Pip\" class=\"headerlink\" title=\"Pypi &amp; Pip\"></a>Pypi &amp; Pip</h3><ul>\n<li><a href=\"https://pypi.org/\" target=\"_blank\" rel=\"noopener\">pypi</a></li>\n<li>use as : pip install openpyxl  to install </li>\n</ul>\n<h3 id=\"Use-openpyxl\"><a href=\"#Use-openpyxl\" class=\"headerlink\" title=\"Use openpyxl\"></a>Use openpyxl</h3><pre><code class=\"python\">import openpyxl as xl\nfrom openpyxl.chart import BarChart, Reference\nwb = xl.load_workbook(&quot;pydemo2/transactions.xlsx&quot;)\nsheet = wb[&quot;Sheet1&quot;]\nfor row in range(2, sheet.max_row + 1):\n    cell = sheet.cell(row, 3)\n    real_val = cell.value * 0.9\n    real_val_cell = sheet.cell(row, 4)\n    real_val_cell.value = real_val\n\nvalues = Reference(sheet, min_row=2, max_row=sheet.max_row, min_col=4, max_col=4)\nchart = BarChart()\nchart.add_data(values)\nsheet.add_chart(chart, &#39;e2&#39;)\nwb.save(&#39;pydemo2/transactions_n2.xlsx&#39;)</code></pre>\n<h3 id=\"Machine-learning\"><a href=\"#Machine-learning\" class=\"headerlink\" title=\"Machine learning\"></a>Machine learning</h3><ul>\n<li>Self-driving Cars</li>\n<li>Robotics</li>\n<li>Language Processing</li>\n<li>Vision Processing</li>\n<li>Forecasting Stock Market Trends</li>\n</ul>\n"}],"PostAsset":[],"PostCategory":[{"post_id":"ck1lykto00000ep11f13e5b1n","category_id":"ck1lykto60003ep11hjqc2vva","_id":"ck1lyktoi000dep11lhi8zcoz"},{"post_id":"ck1lyktob0007ep113jccghle","category_id":"ck1lykto60003ep11hjqc2vva","_id":"ck1lyktok000gep11e0cuz2th"},{"post_id":"ck1lyktof000aep116huni2uo","category_id":"ck1lykto60003ep11hjqc2vva","_id":"ck1lyktom000iep113yet8qpc"},{"post_id":"ck1lykto40002ep114gfhie3f","category_id":"ck1lykto60003ep11hjqc2vva","_id":"ck1lyktoo000mep114zyb91ic"},{"post_id":"ck1lyktog000bep11hglm1k2i","category_id":"ck1lykto60003ep11hjqc2vva","_id":"ck1lyktop000oep11c53ng7u8"},{"post_id":"ck1lykto80005ep11soee0bwq","category_id":"ck1lykto60003ep11hjqc2vva","_id":"ck1lyktoq000rep11n8ykjj0e"},{"post_id":"ck1lyktoo000lep110jb8sxbp","category_id":"ck1lykto60003ep11hjqc2vva","_id":"ck1lyktoq000tep118rp00z44"},{"post_id":"ck1lyktoj000fep116ovcyc9z","category_id":"ck1lykton000kep11i6npcctg","_id":"ck1lyktor000wep1161kh4tfr"}],"PostTag":[{"post_id":"ck1lykto00000ep11f13e5b1n","tag_id":"ck1lykto80004ep111qx3yhp5","_id":"ck1lyktoo000nep11mwqikrcu"},{"post_id":"ck1lykto00000ep11f13e5b1n","tag_id":"ck1lyktoc0009ep110g8oktea","_id":"ck1lyktop000pep11dpgto460"},{"post_id":"ck1lykto00000ep11f13e5b1n","tag_id":"ck1lyktoi000eep11arcu19we","_id":"ck1lyktoq000sep117w37oyuw"},{"post_id":"ck1lyktoo000lep110jb8sxbp","tag_id":"ck1lykto80004ep111qx3yhp5","_id":"ck1lyktor000uep11get8nfsn"},{"post_id":"ck1lyktoo000lep110jb8sxbp","tag_id":"ck1lyktoi000eep11arcu19we","_id":"ck1lyktor000xep11fksy6eei"},{"post_id":"ck1lykto40002ep114gfhie3f","tag_id":"ck1lykto80004ep111qx3yhp5","_id":"ck1lyktot000zep110zch8e6n"},{"post_id":"ck1lykto40002ep114gfhie3f","tag_id":"ck1lyktoc0009ep110g8oktea","_id":"ck1lyktot0010ep11fsz0g1vv"},{"post_id":"ck1lykto40002ep114gfhie3f","tag_id":"ck1lyktoi000eep11arcu19we","_id":"ck1lyktou0012ep11iffjysr2"},{"post_id":"ck1lykto80005ep11soee0bwq","tag_id":"ck1lykto80004ep111qx3yhp5","_id":"ck1lyktov0014ep11ch4wvabh"},{"post_id":"ck1lykto80005ep11soee0bwq","tag_id":"ck1lyktoi000eep11arcu19we","_id":"ck1lyktov0015ep11j7z7nqtj"},{"post_id":"ck1lyktob0007ep113jccghle","tag_id":"ck1lykto80004ep111qx3yhp5","_id":"ck1lyktoy0018ep11czlu8x7q"},{"post_id":"ck1lyktob0007ep113jccghle","tag_id":"ck1lyktoc0009ep110g8oktea","_id":"ck1lyktoy0019ep11gze6bici"},{"post_id":"ck1lyktob0007ep113jccghle","tag_id":"ck1lyktoi000eep11arcu19we","_id":"ck1lyktoz001bep11oxp6ikoz"},{"post_id":"ck1lyktof000aep116huni2uo","tag_id":"ck1lykto80004ep111qx3yhp5","_id":"ck1lyktp0001cep11qkqaf8qq"},{"post_id":"ck1lyktof000aep116huni2uo","tag_id":"ck1lyktoi000eep11arcu19we","_id":"ck1lyktp1001eep11lt0383il"},{"post_id":"ck1lyktog000bep11hglm1k2i","tag_id":"ck1lykto80004ep111qx3yhp5","_id":"ck1lyktp1001fep11ek1wpu4m"},{"post_id":"ck1lyktog000bep11hglm1k2i","tag_id":"ck1lyktoi000eep11arcu19we","_id":"ck1lyktp1001gep118viqxemo"},{"post_id":"ck1lyktoj000fep116ovcyc9z","tag_id":"ck1lyktp0001dep1165enxpvn","_id":"ck1lyktp2001hep110dbrs5gj"},{"post_id":"ck1lyktoj000fep116ovcyc9z","tag_id":"ck1lyktoi000eep11arcu19we","_id":"ck1lyktp2001iep11n2nimj3o"}],"Tag":[{"name":"Python","_id":"ck1lykto80004ep111qx3yhp5"},{"name":"Core Programming","_id":"ck1lyktoc0009ep110g8oktea"},{"name":"Note","_id":"ck1lyktoi000eep11arcu19we"},{"name":"English","_id":"ck1lyktp0001dep1165enxpvn"}]}}